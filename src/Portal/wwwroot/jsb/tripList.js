var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Views;!function(e){var t=function(e){function t(){var t=this;e.call(this),this.registerUploads(),$(".menuClose").click(function(e){e.preventDefault(),$(".trip-menu").hide()}),this.registerTripDeletion(),$("#newTrip").keypress(function(e){13===e.which&&(e.preventDefault(),t.createNewTrip())}),this.regSettings()}return __extends(t,e),t.prototype.regSettings=function(){$(".setting").click(function(e){e.preventDefault();var t=$(e.target);t.closest(".trip-holder").find(".trip-menu").slideToggle()})},t.prototype.registerTripDeletion=function(){var e=this;$(".deleteTrip").click(function(t){t.preventDefault();var i=$(t.target),r=i.closest(".trip-menu").data("tid"),o=new Common.ConfirmDialog;o.create(e.t("TripDelTitle","jsTrip"),e.t("TripDelMessage","jsTrip"),e.t("Cancel","jsLayout"),e.t("Ok","jsLayout"),function(){e.apiDelete("Trip",[["id",r]],function(e){$("#popup-delete").hide(),$("#"+r).remove()})})})},t.prototype.registerUploads=function(){var e=this,t=$(".photo-link input"),i=t.toArray();i.forEach(function(t){var i=$(t);e.registerPhotoUpload(i.data("tid"),i.attr("id"))})},t.prototype.createNewTrip=function(){var e=$("#newTrip").val();""!==e&&(window.location.href="/Trip/CreateNewTrip/"+e)},t.prototype.registerPhotoUpload=function(e,t){var i=this,r=new Common.FileUploadConfig;r.inputId=t,r.endpoint="TripPhotoSmall",r.maxFileSize=55e5,r.useMaxSizeValidation=!1;var o=new Common.FileUpload(r);o.customId=e,o.onProgressChanged=function(e){var t=$("#progressBar");t.show();var i=e+"%";$(".progress").css("width",i),t.find("span").text(i)},o.onUploadFinished=function(t,r){$(".trip-menu").hide(),$("#tripImg_"+e).attr("src","/Trip/TripPictureSmall_s/"+e+"?d="+i.makeRandomString(10));var o=$("#progressBar");o.hide()}},t}(e.ViewBase);e.TripListView=t}(Views||(Views={}));