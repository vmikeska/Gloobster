var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Views;!function(t){var e=function(t){function e(){var e=this;t.call(this);var i=-1!==window.location.href.indexOf("grid");this.registerUploads(i),$(".menuClose").click(function(t){t.preventDefault(),$(".trip-menu").hide()}),this.registerTripDeletion(),$("#newTrip").keypress(function(t){13===t.which&&(t.preventDefault(),e.createNewTrip())}),this.regSettings()}return __extends(e,t),e.prototype.regSettings=function(){$(".setting").click(function(t){t.preventDefault();var e=$(t.target);e.closest(".trip-holder").find(".trip-menu").slideToggle()})},e.prototype.registerTripDeletion=function(){var t=this;$(".deleteTrip").click(function(e){e.preventDefault();var i=$(e.target),r=i.closest(".trip-menu").data("tid"),n=new Common.ConfirmDialog;n.create(t.t("TripDelTitle","jsTrip"),t.t("TripDelMessage","jsTrip"),t.t("Cancel","jsLayout"),t.t("Ok","jsLayout"),function(){t.apiDelete("Trip",[["id",r]],function(t){$("#popup-delete").hide(),$("#"+r).remove()})})})},e.prototype.registerUploads=function(t){var e=this,i=$(".photo-link input"),r=i.toArray();r.forEach(function(i){var r=$(i);e.registerPhotoUpload(r.data("tid"),r.attr("id"),t)})},e.prototype.createNewTrip=function(){var t=$("#newTrip").val();""!==t&&(window.location.href="/Trip/CreateNewTrip/"+t)},e.prototype.registerPhotoUpload=function(t,e,i){var r=this,n=new Common.FileUploadConfig;n.inputId=e,n.endpoint="TripPhotoSmall",n.maxFileSize=55e5,n.useMaxSizeValidation=!1;var o=new Common.FileUpload(n);o.customId=t;var a=null;o.onProgressChanged=function(t){null===a&&(a=new Common.UploadDialog,a.create()),a.update(t)},o.onUploadFinished=function(e,n){$(".trip-menu").hide(),i?$("#tripImg_"+t).attr("src","/Trip/TripPictureSmall_s/"+t+"?d="+r.makeRandomString(10)):$("#tripImg_"+t).attr("src","/Trip/TripPictureSmall_xs/"+t+"?d="+r.makeRandomString(10)),a.destroy()}},e}(t.ViewBase);t.TripListView=e}(Views||(Views={}));