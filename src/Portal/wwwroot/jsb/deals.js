!function(t,e,i){function n(){var e=t.L;o.noConflict=function(){return t.L=e,this},t.L=o}var o={version:"1.0.1"};"object"==typeof module&&"object"==typeof module.exports?module.exports=o:"function"==typeof define&&define.amd&&define(o),"undefined"!=typeof t&&n(),o.Util={extend:function(t){var e,i,n,o;for(i=1,n=arguments.length;n>i;i++){o=arguments[i];for(e in o)t[e]=o[e]}return t},create:Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}(),bind:function(t,e){var i=Array.prototype.slice;if(t.bind)return t.bind.apply(t,i.call(arguments,1));var n=i.call(arguments,2);return function(){return t.apply(e,n.length?n.concat(i.call(arguments)):arguments)}},stamp:function(t){return t._leaflet_id=t._leaflet_id||++o.Util.lastId,t._leaflet_id},lastId:0,throttle:function(t,e,i){var n,o,a,r;return r=function(){n=!1,o&&(a.apply(i,o),o=!1)},a=function(){n?o=arguments:(t.apply(i,arguments),setTimeout(r,e),n=!0)}},wrapNum:function(t,e,i){var n=e[1],o=e[0],a=n-o;return t===n&&i?t:((t-o)%a+a)%a+o},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return o.Util.trim(t).split(/\s+/)},setOptions:function(t,e){t.hasOwnProperty("options")||(t.options=t.options?o.Util.create(t.options):{});for(var i in e)t.options[i]=e[i];return t.options},getParamString:function(t,e,i){var n=[];for(var o in t)n.push(encodeURIComponent(i?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(o.Util.templateRe,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},templateRe:/\{ *([\w_\-]+) *\}/g,isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},indexOf:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){return t["webkit"+e]||t["moz"+e]||t["ms"+e]}function i(e){var i=+new Date,o=Math.max(0,16-(i-n));return n=i+o,t.setTimeout(e,o)}var n=0,a=t.requestAnimationFrame||e("RequestAnimationFrame")||i,r=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};o.Util.requestAnimFrame=function(e,n,r){return r&&a===i?void e.call(n):a.call(t,o.bind(e,n))},o.Util.cancelAnimFrame=function(e){e&&r.call(t,e)}}(),o.extend=o.Util.extend,o.bind=o.Util.bind,o.stamp=o.Util.stamp,o.setOptions=o.Util.setOptions,o.Class=function(){},o.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},i=e.__super__=this.prototype,n=o.Util.create(i);n.constructor=e,e.prototype=n;for(var a in this)this.hasOwnProperty(a)&&"prototype"!==a&&(e[a]=this[a]);return t.statics&&(o.extend(e,t.statics),delete t.statics),t.includes&&(o.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),n.options&&(t.options=o.Util.extend(o.Util.create(n.options),t.options)),o.extend(n,t),n._initHooks=[],n.callInitHooks=function(){if(!this._initHooksCalled){i.callInitHooks&&i.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},o.Class.include=function(t){return o.extend(this.prototype,t),this},o.Class.mergeOptions=function(t){return o.extend(this.prototype.options,t),this},o.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i),this},o.Evented=o.Class.extend({on:function(t,e,i){if("object"==typeof t)for(var n in t)this._on(n,t[n],e);else{t=o.Util.splitWords(t);for(var a=0,r=t.length;r>a;a++)this._on(t[a],e,i)}return this},off:function(t,e,i){if(t)if("object"==typeof t)for(var n in t)this._off(n,t[n],e);else{t=o.Util.splitWords(t);for(var a=0,r=t.length;r>a;a++)this._off(t[a],e,i)}else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var o=this._events[t];o||(o=[],this._events[t]=o),n===this&&(n=i);for(var a={fn:e,ctx:n},r=o,s=0,c=r.length;c>s;s++)if(r[s].fn===e&&r[s].ctx===n)return;r.push(a),o.count++},_off:function(t,e,n){var a,r,s;if(this._events&&(a=this._events[t])){if(!e){for(r=0,s=a.length;s>r;r++)a[r].fn=o.Util.falseFn;return void delete this._events[t]}if(n===this&&(n=i),a)for(r=0,s=a.length;s>r;r++){var c=a[r];if(c.ctx===n&&c.fn===e)return c.fn=o.Util.falseFn,this._firingCount&&(this._events[t]=a=a.slice()),void a.splice(r,1)}}},fire:function(t,e,i){if(!this.listens(t,i))return this;var n=o.Util.extend({},e,{type:t,target:this});if(this._events){var a=this._events[t];if(a){this._firingCount=this._firingCount+1||1;for(var r=0,s=a.length;s>r;r++){var c=a[r];c.fn.call(c.ctx||this,n)}this._firingCount--}}return i&&this._propagateEvent(n),this},listens:function(t,e){var i=this._events&&this._events[t];if(i&&i.length)return!0;if(e)for(var n in this._eventParents)if(this._eventParents[n].listens(t,e))return!0;return!1},once:function(t,e,i){if("object"==typeof t){for(var n in t)this.once(n,t[n],e);return this}var a=o.bind(function(){this.off(t,e,i).off(t,a,i)},this);return this.on(t,e,i).on(t,a,i)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[o.stamp(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[o.stamp(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,o.extend({layer:t.target},t),!0)}});var a=o.Evented.prototype;a.addEventListener=a.on,a.removeEventListener=a.clearAllEventListeners=a.off,a.addOneTimeEventListener=a.once,a.fireEvent=a.fire,a.hasEventListeners=a.listens,o.Mixin={Events:a},function(){var i=navigator.userAgent.toLowerCase(),n=e.documentElement,a="ActiveXObject"in t,r=-1!==i.indexOf("webkit"),s=-1!==i.indexOf("phantom"),c=-1!==i.search("android [23]"),l=-1!==i.indexOf("chrome"),h=-1!==i.indexOf("gecko")&&!r&&!t.opera&&!a,d=0===navigator.platform.indexOf("Win"),u="undefined"!=typeof orientation||-1!==i.indexOf("mobile"),m=!t.PointerEvent&&t.MSPointerEvent,p=t.PointerEvent||m,f=a&&"transition"in n.style,g="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!c,_="MozPerspective"in n.style,v="OTransition"in n.style,y=!t.L_NO_TOUCH&&(p||"ontouchstart"in t||t.DocumentTouch&&e instanceof t.DocumentTouch);o.Browser={ie:a,ielt9:a&&!e.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in e),webkit:r,gecko:h,android:-1!==i.indexOf("android"),android23:c,chrome:l,safari:!l&&-1!==i.indexOf("safari"),win:d,ie3d:f,webkit3d:g,gecko3d:_,opera12:v,any3d:!t.L_DISABLE_3D&&(f||g||_)&&!v&&!s,mobile:u,mobileWebkit:u&&r,mobileWebkit3d:u&&g,mobileOpera:u&&t.opera,mobileGecko:u&&h,touch:!!y,msPointer:!!m,pointer:!!p,retina:(t.devicePixelRatio||t.screen.deviceXDPI/t.screen.logicalXDPI)>1}}(),o.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},o.Point.prototype={clone:function(){return new o.Point(this.x,this.y)},add:function(t){return this.clone()._add(o.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(o.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new o.Point(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new o.Point(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},distanceTo:function(t){t=o.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=o.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=o.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+o.Util.formatNum(this.x)+", "+o.Util.formatNum(this.y)+")"}},o.point=function(t,e,n){return t instanceof o.Point?t:o.Util.isArray(t)?new o.Point(t[0],t[1]):t===i||null===t?t:"object"==typeof t&&"x"in t&&"y"in t?new o.Point(t.x,t.y):new o.Point(t,e,n)},o.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},o.Bounds.prototype={extend:function(t){return t=o.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new o.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new o.Point(this.min.x,this.max.y)},getTopRight:function(){return new o.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof o.Point?o.point(t):o.bounds(t),t instanceof o.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,a=t.max,r=a.x>=e.x&&n.x<=i.x,s=a.y>=e.y&&n.y<=i.y;return r&&s},overlaps:function(t){t=o.bounds(t);var e=this.min,i=this.max,n=t.min,a=t.max,r=a.x>e.x&&n.x<i.x,s=a.y>e.y&&n.y<i.y;return r&&s},isValid:function(){return!(!this.min||!this.max)}},o.bounds=function(t,e){return!t||t instanceof o.Bounds?t:new o.Bounds(t,e)},o.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},o.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new o.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},o.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i]||t.currentStyle&&t.currentStyle[i];if((!n||"auto"===n)&&e.defaultView){var o=e.defaultView.getComputedStyle(t,null);n=o?o[i]:null}return"auto"===n?null:n},create:function(t,i,n){var o=e.createElement(t);return o.className=i||"",n&&n.appendChild(o),o},remove:function(t){var e=t.parentNode;e&&e.removeChild(t)},empty:function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},toFront:function(t){t.parentNode.appendChild(t)},toBack:function(t){var e=t.parentNode;e.insertBefore(t,e.firstChild)},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=o.DomUtil.getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=o.Util.splitWords(e),a=0,r=n.length;r>a;a++)t.classList.add(n[a]);else if(!o.DomUtil.hasClass(t,e)){var s=o.DomUtil.getClass(t);o.DomUtil.setClass(t,(s?s+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):o.DomUtil.setClass(t,o.Util.trim((" "+o.DomUtil.getClass(t)+" ").replace(" "+e+" "," ")))},setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&o.DomUtil._setOpacityIE(t,e)},_setOpacityIE:function(t,e){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(o){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},setTransform:function(t,e,i){var n=e||new o.Point(0,0);t.style[o.DomUtil.TRANSFORM]=(o.Browser.ie3d?"translate("+n.x+"px,"+n.y+"px)":"translate3d("+n.x+"px,"+n.y+"px,0)")+(i?" scale("+i+")":"")},setPosition:function(t,e){t._leaflet_pos=e,o.Browser.any3d?o.DomUtil.setTransform(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos||new o.Point(0,0)}},function(){o.DomUtil.TRANSFORM=o.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]);var i=o.DomUtil.TRANSITION=o.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);if(o.DomUtil.TRANSITION_END="webkitTransition"===i||"OTransition"===i?i+"End":"transitionend","onselectstart"in e)o.DomUtil.disableTextSelection=function(){o.DomEvent.on(t,"selectstart",o.DomEvent.preventDefault)},o.DomUtil.enableTextSelection=function(){o.DomEvent.off(t,"selectstart",o.DomEvent.preventDefault)};else{var n=o.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);o.DomUtil.disableTextSelection=function(){if(n){var t=e.documentElement.style;this._userSelect=t[n],t[n]="none"}},o.DomUtil.enableTextSelection=function(){n&&(e.documentElement.style[n]=this._userSelect,delete this._userSelect)}}o.DomUtil.disableImageDrag=function(){o.DomEvent.on(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.enableImageDrag=function(){o.DomEvent.off(t,"dragstart",o.DomEvent.preventDefault)},o.DomUtil.preventOutline=function(e){for(;-1===e.tabIndex;)e=e.parentNode;e&&e.style&&(o.DomUtil.restoreOutline(),this._outlineElement=e,this._outlineStyle=e.style.outline,e.style.outline="none",o.DomEvent.on(t,"keydown",o.DomUtil.restoreOutline,this))},o.DomUtil.restoreOutline=function(){this._outlineElement&&(this._outlineElement.style.outline=this._outlineStyle,delete this._outlineElement,delete this._outlineStyle,o.DomEvent.off(t,"keydown",o.DomUtil.restoreOutline,this))}}(),o.LatLng=function(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,n!==i&&(this.alt=+n)},o.LatLng.prototype={equals:function(t,e){if(!t)return!1;t=o.latLng(t);var n=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return(e===i?1e-9:e)>=n},toString:function(t){return"LatLng("+o.Util.formatNum(this.lat,t)+", "+o.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){return o.CRS.Earth.distance(this,o.latLng(t))},wrap:function(){return o.CRS.Earth.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return o.latLngBounds([this.lat-e,this.lng-i],[this.lat+e,this.lng+i])},clone:function(){return new o.LatLng(this.lat,this.lng,this.alt)}},o.latLng=function(t,e,n){return t instanceof o.LatLng?t:o.Util.isArray(t)&&"object"!=typeof t[0]?3===t.length?new o.LatLng(t[0],t[1],t[2]):2===t.length?new o.LatLng(t[0],t[1]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new o.LatLng(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===i?null:new o.LatLng(t,e,n)},o.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,o=i.length;o>n;n++)this.extend(i[n])},o.LatLngBounds.prototype={extend:function(t){var e,i,n=this._southWest,a=this._northEast;if(t instanceof o.LatLng)e=t,i=t;else{if(!(t instanceof o.LatLngBounds))return t?this.extend(o.latLng(t)||o.latLngBounds(t)):this;if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||a?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),a.lat=Math.max(i.lat,a.lat),a.lng=Math.max(i.lng,a.lng)):(this._southWest=new o.LatLng(e.lat,e.lng),this._northEast=new o.LatLng(i.lat,i.lng)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,a=Math.abs(e.lng-i.lng)*t;return new o.LatLngBounds(new o.LatLng(e.lat-n,e.lng-a),new o.LatLng(i.lat+n,i.lng+a))},getCenter:function(){return new o.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new o.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new o.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof o.LatLng?o.latLng(t):o.latLngBounds(t);var e,i,n=this._southWest,a=this._northEast;return t instanceof o.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=a.lat&&e.lng>=n.lng&&i.lng<=a.lng},intersects:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),a=t.getNorthEast(),r=a.lat>=e.lat&&n.lat<=i.lat,s=a.lng>=e.lng&&n.lng<=i.lng;return r&&s},overlaps:function(t){t=o.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),a=t.getNorthEast(),r=a.lat>e.lat&&n.lat<i.lat,s=a.lng>e.lng&&n.lng<i.lng;return r&&s},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=o.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},o.latLngBounds=function(t,e){return t instanceof o.LatLngBounds?t:new o.LatLngBounds(t,e)},o.Projection={},o.Projection.LonLat={project:function(t){return new o.Point(t.lng,t.lat)},unproject:function(t){return new o.LatLng(t.y,t.x)},bounds:o.bounds([-180,-90],[180,90])},o.Projection.SphericalMercator={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),a=Math.sin(n*e);return new o.Point(this.R*t.lng*e,this.R*Math.log((1+a)/(1-a))/2)},unproject:function(t){var e=180/Math.PI;return new o.LatLng((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=6378137*Math.PI;return o.bounds([-t,-t],[t,t])}()},o.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,i=this.scale(t),n=this.transformation.transform(e.min,i),a=this.transformation.transform(e.max,i);return o.bounds(n,a)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?o.Util.wrapNum(t.lng,this.wrapLng,!0):t.lng,i=this.wrapLat?o.Util.wrapNum(t.lat,this.wrapLat,!0):t.lat,n=t.alt;return o.latLng(i,e,n)}},o.CRS.Simple=o.extend({},o.CRS,{projection:o.Projection.LonLat,transformation:new o.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var i=e.lng-t.lng,n=e.lat-t.lat;return Math.sqrt(i*i+n*n)},infinite:!0}),o.CRS.Earth=o.extend({},o.CRS,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var i=Math.PI/180,n=t.lat*i,o=e.lat*i,a=Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos((e.lng-t.lng)*i);return this.R*Math.acos(Math.min(a,1))}}),o.CRS.EPSG3857=o.extend({},o.CRS.Earth,{code:"EPSG:3857",projection:o.Projection.SphericalMercator,transformation:function(){var t=.5/(Math.PI*o.Projection.SphericalMercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.CRS.EPSG900913=o.extend({},o.CRS.EPSG3857,{code:"EPSG:900913"}),o.CRS.EPSG4326=o.extend({},o.CRS.Earth,{code:"EPSG:4326",projection:o.Projection.LonLat,transformation:new o.Transformation(1/180,1,-1/180,.5)}),o.Map=o.Evented.extend({options:{crs:o.CRS.EPSG3857,center:i,zoom:i,minZoom:i,maxZoom:i,layers:[],maxBounds:i,renderer:i,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=o.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=o.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==i&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==i&&this.setView(o.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this.callInitHooks(),this._addLayers(this.options.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(o.latLng(t),e),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(o.Browser.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),a=this.getSize().divideBy(2),r=t instanceof o.Point?t:this.latLngToContainerPoint(t),s=r.subtract(a).multiplyBy(1-1/n),c=this.containerPointToLatLng(a.add(s));return this.setView(c,e,{zoom:i})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():o.latLngBounds(t);var i=o.point(e.paddingTopLeft||e.padding||[0,0]),n=o.point(e.paddingBottomRight||e.padding||[0,0]),a=this.getBoundsZoom(t,!1,i.add(n));a="number"==typeof e.maxZoom?Math.min(e.maxZoom,a):a;var r=n.subtract(i).divideBy(2),s=this.project(t.getSouthWest(),a),c=this.project(t.getNorthEast(),a),l=this.unproject(s.add(c).divideBy(2).add(r),a);return{center:l,zoom:a}},fitBounds:function(t,e){if(t=o.latLngBounds(t),!t.isValid())throw new Error("Bounds are not valid.");var i=this._getBoundsCenterZoom(t,e);return this.setView(i.center,i.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(o.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=o.latLngBounds(t),t.isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){return this.options.minZoom=t,this._loaded&&this.getZoom()<this.options.minZoom?this.setZoom(t):this},setMaxZoom:function(t){return this.options.maxZoom=t,this._loaded&&this.getZoom()>this.options.maxZoom?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var i=this.getCenter(),n=this._limitCenter(i,this._zoom,o.latLngBounds(t));return i.equals(n)||this.panTo(n,e),this._enforcingBounds=!1,this},invalidateSize:function(t){if(!this._loaded)return this;t=o.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),a=i.divideBy(2).round(),r=n.subtract(a);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(t){this._container._leaflet_id=i,this._containerId=i}o.DomUtil.remove(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this._loaded&&this.fire("unload");for(var e in this._layers)this._layers[e].remove();return this},createPane:function(t,e){var i="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),n=o.DomUtil.create("div",i,e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new o.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=o.latLngBounds(t),i=o.point(i||[0,0]);var n=this.getZoom()||0,a=this.getMinZoom(),r=this.getMaxZoom(),s=t.getNorthWest(),c=t.getSouthEast(),l=this.getSize().subtract(i),h=this.project(c,n).subtract(this.project(s,n)),d=o.Browser.any3d?this.options.zoomSnap:1,u=Math.min(l.x/h.x,l.y/h.y);return n=this.getScaleZoom(u,n),d&&(n=Math.round(n/(d/100))*(d/100),n=e?Math.ceil(n/d)*d:Math.floor(n/d)*d),Math.max(a,Math.min(r,n))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new o.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var i=this._getTopLeftPoint(t,e);return new o.Bounds(i,i.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===i?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=e===i?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=e===i?this._zoom:e;var o=n.zoom(t*n.scale(e));return isNaN(o)?1/0:o},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(o.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(o.point(t),e)},layerPointToLatLng:function(t){var e=o.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(o.latLng(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(o.latLng(t))},distance:function(t,e){return this.options.crs.distance(o.latLng(t),o.latLng(e))},containerPointToLayerPoint:function(t){return o.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return o.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(o.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(o.latLng(t)))},mouseEventToContainerPoint:function(t){return o.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=o.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");o.DomEvent.addListener(e,"scroll",this._onScroll,this),this._containerId=o.Util.stamp(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&o.Browser.any3d,o.DomUtil.addClass(t,"leaflet-container"+(o.Browser.touch?" leaflet-touch":"")+(o.Browser.retina?" leaflet-retina":"")+(o.Browser.ielt9?" leaflet-oldie":"")+(o.Browser.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=o.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),o.DomUtil.setPosition(this._mapPane,new o.Point(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(o.DomUtil.addClass(t.markerPane,"leaflet-zoom-hide"),o.DomUtil.addClass(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){o.DomUtil.setPosition(this._mapPane,new o.Point(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var n=this._zoom!==e;this._moveStart(n)._move(t,e)._moveEnd(n),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t){return t&&this.fire("zoomstart"),this.fire("movestart")},_move:function(t,e,n){e===i&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return o.Util.cancelAnimFrame(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){o.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(o.DomEvent){this._targets={},this._targets[o.stamp(this._container)]=this;var i=e?"off":"on";o.DomEvent[i](this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress",this._handleDOMEvent,this),this.options.trackResize&&o.DomEvent[i](t,"resize",this._onResize,this),o.Browser.any3d&&this.options.transform3DLimit&&this[i]("moveend",this._onMoveEnd)}},_onResize:function(){o.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=o.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var i,n=[],a="mouseout"===e||"mouseover"===e,r=t.target||t.srcElement,s=!1;r;){if(i=this._targets[o.stamp(r)],i&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(i)){s=!0;break}if(i&&i.listens(e,!0)){if(a&&!o.DomEvent._isExternalTarget(r,t))break;if(n.push(i),a)break}if(r===this._container)break;r=r.parentNode}return n.length||s||a||!o.DomEvent._isExternalTarget(r,t)||(n=[this]),n},_handleDOMEvent:function(t){if(this._loaded&&!o.DomEvent._skipped(t)){var e="keypress"===t.type&&13===t.keyCode?"click":t.type;"mousedown"===e&&o.DomUtil.preventOutline(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_fireDOMEvent:function(t,e,i){if("click"===t.type){var n=o.Util.extend({},t);n.type="preclick",this._fireDOMEvent(n,n.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e)),i.length)){var a=i[0];"contextmenu"===e&&a.listens(e,!0)&&o.DomEvent.preventDefault(t);var r={originalEvent:t};if("keypress"!==t.type){var s=a instanceof o.Marker;r.containerPoint=s?this.latLngToContainerPoint(a.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=s?a.getLatLng():this.layerPointToLatLng(r.layerPoint);
}for(var c=0;c<i.length;c++)if(i[c].fire(e,r,!0),r.originalEvent._stopped||i[c].options.nonBubblingEvents&&-1!==o.Util.indexOf(i[c].options.nonBubblingEvents,e))return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return o.DomUtil.getPosition(this._mapPane)||new o.Point(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var n=t&&e!==i?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return n.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewPixelOrigin(i,e);return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),a=this.getSize().divideBy(2),r=new o.Bounds(n.subtract(a),n.add(a)),s=this._getBoundsOffset(r,i,e);return s.round().equals([0,0])?t:this.unproject(n.add(s),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new o.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=o.bounds(this.project(e.getNorthEast(),i),this.project(e.getSouthWest(),i)),a=n.min.subtract(t.min),r=n.max.subtract(t.max),s=this._rebound(a.x,-r.x),c=this._rebound(a.y,-r.y);return new o.Point(s,c)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom(),n=o.Browser.any3d?this.options.zoomSnap:1;return n&&(t=Math.round(t/n)*n),Math.max(e,Math.min(i,t))}}),o.map=function(t,e){return new o.Map(t,e)},o.Layer=o.Evented.extend({options:{pane:"overlayPane",nonBubblingEvents:[]},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[o.stamp(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[o.stamp(t)],this},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var i=this.getEvents();e.on(i,this),this.once("remove",function(){e.off(i,this)},this)}this.onAdd(e),this.getAttribution&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}}),o.Map.include({addLayer:function(t){var e=o.stamp(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=o.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&o.stamp(t)in this._layers},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},_addLayers:function(t){t=t?o.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[o.stamp(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=o.stamp(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-(1/0),n=this._getZoomSpan();for(var o in this._zoomBoundLayers){var a=this._zoomBoundLayers[o].options;t=a.minZoom===i?t:Math.min(t,a.minZoom),e=a.maxZoom===i?e:Math.max(e,a.maxZoom)}this._layersMaxZoom=e===-(1/0)?i:e,this._layersMinZoom=t===1/0?i:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange")}}),o.Projection.Mercator={R:6378137,R_MINOR:6356752.314245179,bounds:o.bounds([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,i=this.R,n=t.lat*e,a=this.R_MINOR/i,r=Math.sqrt(1-a*a),s=r*Math.sin(n),c=Math.tan(Math.PI/4-n/2)/Math.pow((1-s)/(1+s),r/2);return n=-i*Math.log(Math.max(c,1e-10)),new o.Point(t.lng*e*i,n)},unproject:function(t){for(var e,i=180/Math.PI,n=this.R,a=this.R_MINOR/n,r=Math.sqrt(1-a*a),s=Math.exp(-t.y/n),c=Math.PI/2-2*Math.atan(s),l=0,h=.1;15>l&&Math.abs(h)>1e-7;l++)e=r*Math.sin(c),e=Math.pow((1-e)/(1+e),r/2),h=Math.PI/2-2*Math.atan(s*e)-c,c+=h;return new o.LatLng(c*i,t.x*i/n)}},o.CRS.EPSG3395=o.extend({},o.CRS.Earth,{code:"EPSG:3395",projection:o.Projection.Mercator,transformation:function(){var t=.5/(Math.PI*o.Projection.Mercator.R);return new o.Transformation(t,.5,-t,.5)}()}),o.GridLayer=o.Layer.extend({options:{tileSize:256,opacity:1,updateWhenIdle:o.Browser.mobile,updateWhenZooming:!0,updateInterval:200,attribution:null,zIndex:1,bounds:null,minZoom:0,maxZoom:i,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){o.setOptions(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),o.DomUtil.remove(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=null},bringToFront:function(){return this._map&&(o.DomUtil.toFront(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(o.DomUtil.toBack(this._container),this._setAutoZIndex(Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=o.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return e.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof o.Point?t:new o.Point(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,i=this.getPane().children,n=-t(-(1/0),1/0),o=0,a=i.length;a>o;o++)e=i[o].style.zIndex,i[o]!==this._container&&e&&(n=t(n,+e));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!o.Browser.ielt9){o.DomUtil.setOpacity(this._container,this.options.opacity);var t=+new Date,e=!1,i=!1;for(var n in this._tiles){var a=this._tiles[n];if(a.current&&a.loaded){var r=Math.min(1,(t-a.loaded)/200);o.DomUtil.setOpacity(a.el,r),1>r?e=!0:(a.active&&(i=!0),a.active=!0)}}i&&!this._noPrune&&this._pruneTiles(),e&&(o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this))}},_initContainer:function(){this._container||(this._container=o.DomUtil.create("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t===i)return i;for(var n in this._levels)this._levels[n].el.children.length||n===t?this._levels[n].el.style.zIndex=e-Math.abs(t-n):(o.DomUtil.remove(this._levels[n].el),this._removeTilesAtZoom(n),delete this._levels[n]);var a=this._levels[t],r=this._map;return a||(a=this._levels[t]={},a.el=o.DomUtil.create("div","leaflet-tile-container leaflet-zoom-animated",this._container),a.el.style.zIndex=e,a.origin=r.project(r.unproject(r.getPixelOrigin()),t).round(),a.zoom=t,this._setZoomTransform(a,r.getCenter(),r.getZoom()),o.Util.falseFn(a.el.offsetWidth)),this._level=a,a},_pruneTiles:function(){if(this._map){var t,e,i=this._map.getZoom();if(i>this.options.maxZoom||i<this.options.minZoom)return void this._removeAllTiles();for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var n=e.coords;this._retainParent(n.x,n.y,n.z,n.z-5)||this._retainChildren(n.x,n.y,n.z,n.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)o.DomUtil.remove(this._levels[t].el),delete this._levels[t];this._removeAllTiles(),this._tileZoom=null},_retainParent:function(t,e,i,n){var a=Math.floor(t/2),r=Math.floor(e/2),s=i-1,c=new o.Point(+a,+r);c.z=+s;var l=this._tileCoordsToKey(c),h=this._tiles[l];return h&&h.active?(h.retain=!0,!0):(h&&h.loaded&&(h.retain=!0),s>n?this._retainParent(a,r,s,n):!1)},_retainChildren:function(t,e,i,n){for(var a=2*t;2*t+2>a;a++)for(var r=2*e;2*e+2>r;r++){var s=new o.Point(a,r);s.z=i+1;var c=this._tileCoordsToKey(s),l=this._tiles[c];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n>i+1&&this._retainChildren(a,r,i+1,n))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_setView:function(t,e,n,o){var a=Math.round(e);(this.options.maxZoom!==i&&a>this.options.maxZoom||this.options.minZoom!==i&&a<this.options.minZoom)&&(a=i);var r=this.options.updateWhenZooming&&a!==this._tileZoom;o&&!r||(this._tileZoom=a,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),a!==i&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var i in this._levels)this._setZoomTransform(this._levels[i],t,e)},_setZoomTransform:function(t,e,i){var n=this._map.getZoomScale(i,t.zoom),a=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(e,i)).round();o.Browser.any3d?o.DomUtil.setTransform(t.el,a,n):o.DomUtil.setPosition(t.el,a)},_resetGrid:function(){var t=this._map,e=t.options.crs,i=this._tileSize=this.getTileSize(),n=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],n).x/i.x),Math.ceil(t.project([0,e.wrapLng[1]],n).x/i.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],n).y/i.x),Math.ceil(t.project([e.wrapLat[1],0],n).y/i.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,i=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),n=e.getZoomScale(i,this._tileZoom),a=e.project(t,this._tileZoom).floor(),r=e.getSize().divideBy(2*n);return new o.Bounds(a.subtract(r),a.add(r))},_update:function(t){var n=this._map;if(n){var a=n.getZoom();if(t===i&&(t=n.getCenter()),this._tileZoom!==i){var r=this._getTiledPixelBounds(t),s=this._pxBoundsToTileRange(r),c=s.getCenter(),l=[],h=this.options.keepBuffer,d=new o.Bounds(s.getBottomLeft().subtract([h,-h]),s.getTopRight().add([h,-h]));for(var u in this._tiles){var m=this._tiles[u].coords;m.z===this._tileZoom&&d.contains(o.point(m.x,m.y))||(this._tiles[u].current=!1)}if(Math.abs(a-this._tileZoom)>1)return void this._setView(t,a);for(var p=s.min.y;p<=s.max.y;p++)for(var f=s.min.x;f<=s.max.x;f++){var g=new o.Point(f,p);if(g.z=this._tileZoom,this._isValidTile(g)){var _=this._tiles[this._tileCoordsToKey(g)];_?_.current=!0:l.push(g)}}if(l.sort(function(t,e){return t.distanceTo(c)-e.distanceTo(c)}),0!==l.length){this._loading||(this._loading=!0,this.fire("loading"));var v=e.createDocumentFragment();for(f=0;f<l.length;f++)this._addTile(l[f],v);this._level.el.appendChild(v)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var i=this._globalTileRange;if(!e.wrapLng&&(t.x<i.min.x||t.x>i.max.x)||!e.wrapLat&&(t.y<i.min.y||t.y>i.max.y))return!1}if(!this.options.bounds)return!0;var n=this._tileCoordsToBounds(t);return o.latLngBounds(this.options.bounds).overlaps(n)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToBounds:function(t){var e=this._map,i=this.getTileSize(),n=t.scaleBy(i),a=n.add(i),r=e.unproject(n,t.z),s=e.unproject(a,t.z);return this.options.noWrap||(r=e.wrapLatLng(r),s=e.wrapLatLng(s)),new o.LatLngBounds(r,s)},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),i=new o.Point(+e[0],+e[1]);return i.z=+e[2],i},_removeTile:function(t){var e=this._tiles[t];e&&(o.DomUtil.remove(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){o.DomUtil.addClass(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,o.Browser.ielt9&&this.options.opacity<1&&o.DomUtil.setOpacity(t,this.options.opacity),o.Browser.android&&!o.Browser.android23&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var i=this._getTilePos(t),n=this._tileCoordsToKey(t),a=this.createTile(this._wrapCoords(t),o.bind(this._tileReady,this,t));this._initTile(a),this.createTile.length<2&&o.Util.requestAnimFrame(o.bind(this._tileReady,this,t,null,a)),o.DomUtil.setPosition(a,i),this._tiles[n]={el:a,coords:t,current:!0},e.appendChild(a),this.fire("tileloadstart",{tile:a,coords:t})},_tileReady:function(t,e,i){if(this._map){e&&this.fire("tileerror",{error:e,tile:i,coords:t});var n=this._tileCoordsToKey(t);i=this._tiles[n],i&&(i.loaded=+new Date,this._map._fadeAnimated?(o.DomUtil.setOpacity(i.el,0),o.Util.cancelAnimFrame(this._fadeFrame),this._fadeFrame=o.Util.requestAnimFrame(this._updateOpacity,this)):(i.active=!0,this._pruneTiles()),e||(o.DomUtil.addClass(i.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:i.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),o.Browser.ielt9||!this._map._fadeAnimated?o.Util.requestAnimFrame(this._pruneTiles,this):setTimeout(o.bind(this._pruneTiles,this),250)))}},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new o.Point(this._wrapX?o.Util.wrapNum(t.x,this._wrapX):t.x,this._wrapY?o.Util.wrapNum(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new o.Bounds(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),o.gridLayer=function(t){return new o.GridLayer(t)},o.TileLayer=o.GridLayer.extend({options:{minZoom:0,maxZoom:18,maxNativeZoom:null,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,e=o.setOptions(this,e),e.detectRetina&&o.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),o.Browser.android||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},createTile:function(t,i){var n=e.createElement("img");return o.DomEvent.on(n,"load",o.bind(this._tileOnLoad,this,i,n)),o.DomEvent.on(n,"error",o.bind(this._tileOnError,this,i,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:o.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return o.Util.template(this._url,o.extend(e,this.options))},_tileOnLoad:function(t,e){o.Browser.ielt9?setTimeout(o.bind(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,i){var n=this.options.errorTileUrl;n&&(e.src=n),t(i,e)},getTileSize:function(){var t=this._map,e=o.GridLayer.prototype.getTileSize.call(this),i=this._tileZoom+this.options.zoomOffset,n=this.options.maxNativeZoom;return null!==n&&i>n?e.divideBy(t.getZoomScale(n,i)).round():e},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this.options,e=this._tileZoom;return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,null!==t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=o.Util.falseFn,e.onerror=o.Util.falseFn,e.complete||(e.src=o.Util.emptyImageUrl,o.DomUtil.remove(e)))}}),o.tileLayer=function(t,e){return new o.TileLayer(t,e)},o.TileLayer.WMS=o.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=o.extend({},this.defaultWmsParams);for(var n in e)n in this.options||(i[n]=e[n]);e=o.setOptions(this,e),i.width=i.height=e.tileSize*(e.detectRetina&&o.Browser.retina?2:1),this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,o.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToBounds(t),i=this._crs.project(e.getNorthWest()),n=this._crs.project(e.getSouthEast()),a=(this._wmsVersion>=1.3&&this._crs===o.CRS.EPSG4326?[n.y,i.x,i.y,n.x]:[i.x,n.y,n.x,i.y]).join(","),r=o.TileLayer.prototype.getTileUrl.call(this,t);return r+o.Util.getParamString(this.wmsParams,r,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+a},setParams:function(t,e){return o.extend(this.wmsParams,t),e||this.redraw(),this}}),o.tileLayer.wms=function(t,e){return new o.TileLayer.WMS(t,e)},o.ImageOverlay=o.Layer.extend({options:{opacity:1,alt:"",interactive:!1,attribution:null,crossOrigin:!1},initialize:function(t,e,i){this._url=t,this._bounds=o.latLngBounds(e),o.setOptions(this,i)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(o.DomUtil.addClass(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){o.DomUtil.remove(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._image),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=t,this._map&&this._reset(),this},getAttribution:function(){return this.options.attribution},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._image=o.DomUtil.create("img","leaflet-image-layer "+(this._zoomAnimated?"leaflet-zoom-animated":""));t.onselectstart=o.Util.falseFn,t.onmousemove=o.Util.falseFn,t.onload=o.bind(this.fire,this,"load"),this.options.crossOrigin&&(t.crossOrigin=""),t.src=this._url,t.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),i=this._map._latLngToNewLayerPoint(this._bounds.getNorthWest(),t.zoom,t.center);o.DomUtil.setTransform(this._image,i,e)},_reset:function(){var t=this._image,e=new o.Bounds(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),i=e.getSize();o.DomUtil.setPosition(t,e.min),t.style.width=i.x+"px",t.style.height=i.y+"px"},_updateOpacity:function(){o.DomUtil.setOpacity(this._image,this.options.opacity)}}),o.imageOverlay=function(t,e,i){return new o.ImageOverlay(t,e,i)},o.Icon=o.Class.extend({initialize:function(t){o.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n=this._createImg(i,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i=this.options,n=i[e+"Size"];"number"==typeof n&&(n=[n,n]);var a=o.point(n),r=o.point("shadow"===e&&i.shadowAnchor||i.iconAnchor||a&&a.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(i.className||""),r&&(t.style.marginLeft=-r.x+"px",t.style.marginTop=-r.y+"px"),a&&(t.style.width=a.x+"px",t.style.height=a.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return o.Browser.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),o.icon=function(t){return new o.Icon(t)},o.Icon.Default=o.Icon.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return o.Icon.Default.imagePath||(o.Icon.Default.imagePath=this._detectIconPath()),(this.options.imagePath||o.Icon.Default.imagePath)+o.Icon.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=o.DomUtil.create("div","leaflet-default-icon-path",e.body),i=o.DomUtil.getStyle(t,"background-image")||o.DomUtil.getStyle(t,"backgroundImage");return e.body.removeChild(t),0===i.indexOf("url")?i.replace(/^url\([\"\']?/,"").replace(/marker-icon\.png[\"\']?\)$/,""):""}}),o.Marker=o.Layer.extend({options:{icon:new o.Icon.Default,interactive:!0,draggable:!1,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",nonBubblingEvents:["click","dblclick","mouseover","mouseout","contextmenu"]},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=o.latLng(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),i=t.icon.createIcon(this._icon),n=!1;i!==this._icon&&(this._icon&&this._removeIcon(),n=!0,t.title&&(i.title=t.title),t.alt&&(i.alt=t.alt)),o.DomUtil.addClass(i,e),t.keyboard&&(i.tabIndex="0"),this._icon=i,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var a=t.icon.createShadow(this._shadow),r=!1;a!==this._shadow&&(this._removeShadow(),r=!0),a&&o.DomUtil.addClass(a,e),this._shadow=a,t.opacity<1&&this._updateOpacity(),n&&this.getPane().appendChild(this._icon),this._initInteraction(),a&&r&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),o.DomUtil.remove(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&o.DomUtil.remove(this._shadow),this._shadow=null},_setPos:function(t){o.DomUtil.setPosition(this._icon,t),this._shadow&&o.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(o.DomUtil.addClass(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),o.Handler.MarkerDrag)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new o.Handler.MarkerDrag(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;o.DomUtil.setOpacity(this._icon,t),this._shadow&&o.DomUtil.setOpacity(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),o.marker=function(t,e){return new o.Marker(t,e)},o.DivIcon=o.Icon.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;if(i.innerHTML=n.html!==!1?n.html:"",n.bgPos){var a=o.point(n.bgPos);i.style.backgroundPosition=-a.x+"px "+-a.y+"px"}return this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),o.divIcon=function(t){return new o.DivIcon(t)},o.DivOverlay=o.Layer.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){o.setOptions(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&o.DomUtil.setOpacity(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(o.DomUtil.setOpacity(this._container,0),this._removeTimeout=setTimeout(o.bind(o.DomUtil.remove,o.DomUtil,this._container),200)):o.DomUtil.remove(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=o.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&o.DomUtil.toFront(this._container),this},bringToBack:function(){return this._map&&o.DomUtil.toBack(this._container),this},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=o.point(this.options.offset),i=this._getAnchor();this._zoomAnimated?o.DomUtil.setPosition(this._container,t.add(i)):e=e.add(t).add(i);var n=this._containerBottom=-e.y,a=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=n+"px",this._container.style.left=a+"px"}},_getAnchor:function(){return[0,0]}}),o.Popup=o.DivOverlay.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof o.Path||this._source.on("preclick",o.DomEvent.stopPropagation))},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof o.Path||this._source.off("preclick",o.DomEvent.stopPropagation))},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=o.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated");if(this.options.closeButton){var i=this._closeButton=o.DomUtil.create("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",o.DomEvent.on(i,"click",this._onCloseButtonClick,this)}var n=this._wrapper=o.DomUtil.create("div",t+"-content-wrapper",e);this._contentNode=o.DomUtil.create("div",t+"-content",n),o.DomEvent.disableClickPropagation(n).disableScrollPropagation(this._contentNode).on(n,"contextmenu",o.DomEvent.stopPropagation),this._tipContainer=o.DomUtil.create("div",t+"-tip-container",e),this._tip=o.DomUtil.create("div",t+"-tip",this._tipContainer)},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,a=this.options.maxHeight,r="leaflet-popup-scrolled";a&&n>a?(e.height=a+"px",o.DomUtil.addClass(t,r)):o.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),i=this._getAnchor();o.DomUtil.setPosition(this._container,e.add(i))},_adjustPan:function(){if(!(!this.options.autoPan||this._map._panAnim&&this._map._panAnim._inProgress)){var t=this._map,e=parseInt(o.DomUtil.getStyle(this._container,"marginBottom"),10)||0,i=this._container.offsetHeight+e,n=this._containerWidth,a=new o.Point(this._containerLeft,-i-this._containerBottom);a._add(o.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(a),s=o.point(this.options.autoPanPadding),c=o.point(this.options.autoPanPaddingTopLeft||s),l=o.point(this.options.autoPanPaddingBottomRight||s),h=t.getSize(),d=0,u=0;
r.x+n+l.x>h.x&&(d=r.x+n-h.x+l.x),r.x-d-c.x<0&&(d=r.x-c.x),r.y+i+l.y>h.y&&(u=r.y+i-h.y+l.y),r.y-u-c.y<0&&(u=r.y-c.y),(d||u)&&t.fire("autopanstart").panBy([d,u])}},_onCloseButtonClick:function(t){this._close(),o.DomEvent.stop(t)},_getAnchor:function(){return o.point(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),o.popup=function(t,e){return new o.Popup(t,e)},o.Map.mergeOptions({closePopupOnClick:!0}),o.Map.include({openPopup:function(t,e,i){return t instanceof o.Popup||(t=new o.Popup(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),o.Layer.include({bindPopup:function(t,e){return t instanceof o.Popup?(o.setOptions(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new o.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._popup&&this._map&&(this._popup._source=t,this._popup.update(),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;if(this._popup&&this._map)return o.DomEvent.stop(t),e instanceof o.Path?void this.openPopup(t.layer||t.target,t.latlng):void(this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),o.Marker.include({_getPopupAnchor:function(){return this.options.icon.options.popupAnchor||[0,0]}}),o.Tooltip=o.DivOverlay.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){o.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){o.DivOverlay.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=o.DivOverlay.prototype.getEvents.call(this);return o.Browser.touch&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=o.DomUtil.create("div",e)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),a=e.layerPointToContainerPoint(t),r=this.options.direction,s=i.offsetWidth,c=i.offsetHeight,l=o.point(this.options.offset),h=this._getAnchor();"top"===r?t=t.add(o.point(-s/2+l.x,-c+l.y+h.y)):"bottom"===r?t=t.subtract(o.point(s/2-l.x,-l.y)):"center"===r?t=t.subtract(o.point(s/2+l.x,c/2-h.y+l.y)):"right"===r||"auto"===r&&a.x<n.x?(r="right",t=t.add([l.x+h.x,h.y-c/2+l.y])):(r="left",t=t.subtract(o.point(s+h.x-l.x,c/2-h.y-l.y))),o.DomUtil.removeClass(i,"leaflet-tooltip-right"),o.DomUtil.removeClass(i,"leaflet-tooltip-left"),o.DomUtil.removeClass(i,"leaflet-tooltip-top"),o.DomUtil.removeClass(i,"leaflet-tooltip-bottom"),o.DomUtil.addClass(i,"leaflet-tooltip-"+r),o.DomUtil.setPosition(i,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&o.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return o.point(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),o.tooltip=function(t,e){return new o.Tooltip(t,e)},o.Map.include({openTooltip:function(t,e,i){return t instanceof o.Tooltip||(t=new o.Tooltip(i).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),o.Layer.include({bindTooltip:function(t,e){return t instanceof o.Tooltip?(o.setOptions(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=o.tooltip(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",i={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?i.add=this._openTooltip:(i.mouseover=this._openTooltip,i.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(i.mousemove=this._moveTooltip),o.Browser.touch&&(i.click=this._openTooltip)),this[e](i),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){if(t instanceof o.Layer||(e=t,t=this),t instanceof o.FeatureGroup)for(var i in this._layers){t=this._layers[i];break}return e||(e=t.getCenter?t.getCenter():t.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=t,this._tooltip.update(),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.addClass(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(o.DomUtil.removeClass(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:i)},_moveTooltip:function(t){var e,i,n=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(e),n=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(n)}}),o.Marker.include({_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor||[0,0]}}),o.LayerGroup=o.Layer.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){for(var t in this._layers)this.removeLayer(this._layers[t]);return this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){for(var e in this._layers)t.addLayer(this._layers[e])},onRemove:function(t){for(var e in this._layers)t.removeLayer(this._layers[e])},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return o.stamp(t)}}),o.layerGroup=function(t){return new o.LayerGroup(t)},o.FeatureGroup=o.LayerGroup.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),o.LayerGroup.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),o.LayerGroup.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new o.LatLngBounds;for(var e in this._layers){var i=this._layers[e];t.extend(i.getBounds?i.getBounds():i.getLatLng())}return t}}),o.featureGroup=function(t){return new o.FeatureGroup(t)},o.Renderer=o.Layer.extend({options:{padding:.1},initialize:function(t){o.setOptions(this,t),o.stamp(this)},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&o.DomUtil.addClass(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update()},onRemove:function(){o.DomUtil.remove(this._container)},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var i=this._map.getZoomScale(e,this._zoom),n=o.DomUtil.getPosition(this._container),a=this._map.getSize().multiplyBy(.5+this.options.padding),r=this._map.project(this._center,e),s=this._map.project(t,e),c=s.subtract(r),l=a.multiplyBy(-i).add(n).add(a).subtract(c);o.Browser.any3d?o.DomUtil.setTransform(this._container,l,i):o.DomUtil.setPosition(this._container,l)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom)},_update:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new o.Bounds(i,i.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),o.Map.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this.options.preferCanvas&&o.canvas()||o.svg()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||t===i)return!1;var e=this._paneRenderers[t];return e===i&&(e=o.SVG&&o.svg({pane:t})||o.Canvas&&o.canvas({pane:t}),this._paneRenderers[t]=e),e}}),o.Path=o.Layer.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),this._renderer.on("update",this._update,this)},onRemove:function(){this._renderer._removePath(this),this._renderer.off("update",this._update,this)},getEvents:function(){return{zoomend:this._project,viewreset:this._reset}},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return o.setOptions(this,t),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(o.Browser.touch?10:0)}}),o.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,a=new o(n);a[0]=a[n-1]=1,this._simplifyDPStep(t,a,e,0,n-1);var r,s=[];for(r=0;n>r;r++)a[r]&&s.push(t[r]);return s},_simplifyDPStep:function(t,e,i,n,o){var a,r,s,c=0;for(r=n+1;o-1>=r;r++)s=this._sqClosestPointOnSegment(t[r],t[n],t[o],!0),s>c&&(a=r,c=s);c>i&&(e[a]=1,this._simplifyDPStep(t,e,i,n,a),this._simplifyDPStep(t,e,i,a,o))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,o=0,a=t.length;a>n;n++)this._sqDist(t[n],t[o])>e&&(i.push(t[n]),o=n);return a-1>o&&i.push(t[a-1]),i},clipSegment:function(t,e,i,n,o){var a,r,s,c=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(c|l))return[t,e];if(c&l)return!1;a=c||l,r=this._getEdgeIntersection(t,e,a,i,o),s=this._getBitCode(r,i),a===c?(t=r,c=s):(e=r,l=s)}},_getEdgeIntersection:function(t,e,i,n,a){var r,s,c=e.x-t.x,l=e.y-t.y,h=n.min,d=n.max;return 8&i?(r=t.x+c*(d.y-t.y)/l,s=d.y):4&i?(r=t.x+c*(h.y-t.y)/l,s=h.y):2&i?(r=d.x,s=t.y+l*(d.x-t.x)/c):1&i&&(r=h.x,s=t.y+l*(h.x-t.x)/c),new o.Point(r,s,a)},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var a,r=e.x,s=e.y,c=i.x-r,l=i.y-s,h=c*c+l*l;return h>0&&(a=((t.x-r)*c+(t.y-s)*l)/h,a>1?(r=i.x,s=i.y):a>0&&(r+=c*a,s+=l*a)),c=t.x-r,l=t.y-s,n?c*c+l*l:new o.Point(r,s)}},o.Polyline=o.Path.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){o.setOptions(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,i,n=1/0,a=null,r=o.LineUtil._sqClosestPointOnSegment,s=0,c=this._parts.length;c>s;s++)for(var l=this._parts[s],h=1,d=l.length;d>h;h++){e=l[h-1],i=l[h];var u=r(t,e,i,!0);n>u&&(n=u,a=r(t,e,i))}return a&&(a.distance=Math.sqrt(n)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,a,r,s=this._rings[0],c=s.length;if(!c)return null;for(t=0,e=0;c-1>t;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,n=0;c-1>t;t++)if(o=s[t],a=s[t+1],i=o.distanceTo(a),n+=i,n>e)return r=(n-e)/i,this._map.layerPointToLatLng([a.x-r*(a.x-o.x),a.y-r*(a.y-o.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=o.latLng(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new o.LatLngBounds,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return o.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],i=o.Polyline._flat(t),n=0,a=t.length;a>n;n++)i?(e[n]=o.latLng(t[n]),this._bounds.extend(e[n])):e[n]=this._convertLatLngs(t[n]);return e},_project:function(){var t=new o.Bounds;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t);var e=this._clickTolerance(),i=new o.Point(e,e);this._bounds.isValid()&&t.isValid()&&(t.min._subtract(i),t.max._add(i),this._pxBounds=t)},_projectLatlngs:function(t,e,i){var n,a,r=t[0]instanceof o.LatLng,s=t.length;if(r){for(a=[],n=0;s>n;n++)a[n]=this._map.latLngToLayerPoint(t[n]),i.extend(a[n]);e.push(a)}else for(n=0;s>n;n++)this._projectLatlngs(t[n],e,i)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);var e,i,n,a,r,s,c,l=this._parts;for(e=0,n=0,a=this._rings.length;a>e;e++)for(c=this._rings[e],i=0,r=c.length;r-1>i;i++)s=o.LineUtil.clipSegment(c[i],c[i+1],t,i,!0),s&&(l[n]=l[n]||[],l[n].push(s[0]),s[1]===c[i+1]&&i!==r-2||(l[n].push(s[1]),n++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,i=0,n=t.length;n>i;i++)t[i]=o.LineUtil.simplify(t[i],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)}}),o.polyline=function(t,e){return new o.Polyline(t,e)},o.Polyline._flat=function(t){return!o.Util.isArray(t[0])||"object"!=typeof t[0][0]&&"undefined"!=typeof t[0][0]},o.PolyUtil={},o.PolyUtil.clipPolygon=function(t,e,i){var n,a,r,s,c,l,h,d,u,m=[1,4,2,8],p=o.LineUtil;for(a=0,h=t.length;h>a;a++)t[a]._code=p._getBitCode(t[a],e);for(s=0;4>s;s++){for(d=m[s],n=[],a=0,h=t.length,r=h-1;h>a;r=a++)c=t[a],l=t[r],c._code&d?l._code&d||(u=p._getEdgeIntersection(l,c,d,e,i),u._code=p._getBitCode(u,e),n.push(u)):(l._code&d&&(u=p._getEdgeIntersection(l,c,d,e,i),u._code=p._getBitCode(u,e),n.push(u)),n.push(c));t=n}return t},o.Polygon=o.Polyline.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,i,n,o,a,r,s,c,l=this._rings[0],h=l.length;if(!h)return null;for(a=r=s=0,t=0,e=h-1;h>t;e=t++)i=l[t],n=l[e],o=i.y*n.x-n.y*i.x,r+=(i.x+n.x)*o,s+=(i.y+n.y)*o,a+=3*o;return c=0===a?l[0]:[r/a,s/a],this._map.layerPointToLatLng(c)},_convertLatLngs:function(t){var e=o.Polyline.prototype._convertLatLngs.call(this,t),i=e.length;return i>=2&&e[0]instanceof o.LatLng&&e[0].equals(e[i-1])&&e.pop(),e},_setLatLngs:function(t){o.Polyline.prototype._setLatLngs.call(this,t),o.Polyline._flat(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return o.Polyline._flat(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,i=new o.Point(e,e);if(t=new o.Bounds(t.min.subtract(i),t.max.add(i)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t)){if(this.options.noClip)return void(this._parts=this._rings);for(var n,a=0,r=this._rings.length;r>a;a++)n=o.PolyUtil.clipPolygon(this._rings[a],t,!0),n.length&&this._parts.push(n)}},_updatePath:function(){this._renderer._updatePoly(this,!0)}}),o.polygon=function(t,e){return new o.Polygon(t,e)},o.Rectangle=o.Polygon.extend({initialize:function(t,e){o.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=o.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),o.rectangle=function(t,e){return new o.Rectangle(t,e)},o.CircleMarker=o.Path.extend({options:{fill:!0,radius:10},initialize:function(t,e){o.setOptions(this,e),this._latlng=o.latLng(t),this._radius=this.options.radius},setLatLng:function(t){return this._latlng=o.latLng(t),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return o.Path.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,i=this._clickTolerance(),n=[t+i,e+i];this._pxBounds=new o.Bounds(this._point.subtract(n),this._point.add(n))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)}}),o.circleMarker=function(t,e){return new o.CircleMarker(t,e)},o.Circle=o.CircleMarker.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=o.extend({},i,{radius:e})),o.setOptions(this,e),this._latlng=o.latLng(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new o.LatLngBounds(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:o.Path.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,i=this._map,n=i.options.crs;if(n.distance===o.CRS.Earth.distance){var a=Math.PI/180,r=this._mRadius/o.CRS.Earth.R/a,s=i.project([e+r,t]),c=i.project([e-r,t]),l=s.add(c).divideBy(2),h=i.unproject(l).lat,d=Math.acos((Math.cos(r*a)-Math.sin(e*a)*Math.sin(h*a))/(Math.cos(e*a)*Math.cos(h*a)))/a;(isNaN(d)||0===d)&&(d=r/Math.cos(Math.PI/180*e)),this._point=l.subtract(i.getPixelOrigin()),this._radius=isNaN(d)?0:Math.max(Math.round(l.x-i.project([h,t-d]).x),1),this._radiusY=Math.max(Math.round(l.y-s.y),1)}else{var u=n.unproject(n.project(this._latlng).subtract([this._mRadius,0]));this._point=i.latLngToLayerPoint(this._latlng),this._radius=this._point.x-i.latLngToLayerPoint(u).x}this._updateBounds()}}),o.circle=function(t,e,i){return new o.Circle(t,e,i)},o.SVG=o.Renderer.extend({getEvents:function(){var t=o.Renderer.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=o.SVG.create("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=o.SVG.create("g"),this._container.appendChild(this._rootGroup)},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){o.Renderer.prototype._update.call(this);var t=this._bounds,e=t.getSize(),i=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,i.setAttribute("width",e.x),i.setAttribute("height",e.y)),o.DomUtil.setPosition(i,t.min),i.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=o.SVG.create("path");t.options.className&&o.DomUtil.addClass(e,t.options.className),t.options.interactive&&o.DomUtil.addClass(e,"leaflet-interactive"),this._updateStyle(t)},_addPath:function(t){this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){o.DomUtil.remove(t._path),t.removeInteractiveTarget(t._path)},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,i=t.options;e&&(i.stroke?(e.setAttribute("stroke",i.color),e.setAttribute("stroke-opacity",i.opacity),e.setAttribute("stroke-width",i.weight),e.setAttribute("stroke-linecap",i.lineCap),e.setAttribute("stroke-linejoin",i.lineJoin),i.dashArray?e.setAttribute("stroke-dasharray",i.dashArray):e.removeAttribute("stroke-dasharray"),i.dashOffset?e.setAttribute("stroke-dashoffset",i.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),i.fill?(e.setAttribute("fill",i.fillColor||i.color),e.setAttribute("fill-opacity",i.fillOpacity),e.setAttribute("fill-rule",i.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,o.SVG.pointsToPath(t._parts,e))},_updateCircle:function(t){var e=t._point,i=t._radius,n=t._radiusY||i,o="a"+i+","+n+" 0 1,0 ",a=t._empty()?"M0 0":"M"+(e.x-i)+","+e.y+o+2*i+",0 "+o+2*-i+",0 ";this._setPath(t,a)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){o.DomUtil.toFront(t._path)},_bringToBack:function(t){o.DomUtil.toBack(t._path)}}),o.extend(o.SVG,{create:function(t){return e.createElementNS("http://www.w3.org/2000/svg",t)},pointsToPath:function(t,e){var i,n,a,r,s,c,l="";for(i=0,a=t.length;a>i;i++){for(s=t[i],n=0,r=s.length;r>n;n++)c=s[n],l+=(n?"L":"M")+c.x+" "+c.y;l+=e?o.Browser.svg?"z":"x":""}return l||"M0 0"}}),o.Browser.svg=!(!e.createElementNS||!o.SVG.create("svg").createSVGRect),o.svg=function(t){return o.Browser.svg||o.Browser.vml?new o.SVG(t):null},o.Browser.vml=!o.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),o.SVG.include(o.Browser.vml?{_initContainer:function(){this._container=o.DomUtil.create("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(o.Renderer.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=o.SVG.create("shape");o.DomUtil.addClass(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=o.SVG.create("path"),e.appendChild(t._path),this._updateStyle(t)},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;o.DomUtil.remove(e),t.removeInteractiveTarget(e)},_updateStyle:function(t){var e=t._stroke,i=t._fill,n=t.options,a=t._container;a.stroked=!!n.stroke,a.filled=!!n.fill,n.stroke?(e||(e=t._stroke=o.SVG.create("stroke")),a.appendChild(e),e.weight=n.weight+"px",e.color=n.color,e.opacity=n.opacity,n.dashArray?e.dashStyle=o.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=n.lineCap.replace("butt","flat"),e.joinstyle=n.lineJoin):e&&(a.removeChild(e),t._stroke=null),n.fill?(i||(i=t._fill=o.SVG.create("fill")),a.appendChild(i),i.color=n.fillColor||n.color,i.opacity=n.fillOpacity):i&&(a.removeChild(i),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),i=Math.round(t._radius),n=Math.round(t._radiusY||i);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+i+","+n+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){o.DomUtil.toFront(t._container)},_bringToBack:function(t){o.DomUtil.toBack(t._container)}}:{}),o.Browser.vml&&(o.SVG.create=function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}()),o.Canvas=o.Renderer.extend({onAdd:function(){o.Renderer.prototype.onAdd.call(this),this._layers=this._layers||{},this._draw()},_initContainer:function(){var t=this._container=e.createElement("canvas");o.DomEvent.on(t,"mousemove",o.Util.throttle(this._onMouseMove,32,this),this).on(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this).on(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_update:function(){if(!this._map._animatingZoom||!this._bounds){this._drawnLayers={},o.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,i=t.getSize(),n=o.Browser.retina?2:1;o.DomUtil.setPosition(e,t.min),e.width=n*i.x,e.height=n*i.y,e.style.width=i.x+"px",e.style.height=i.y+"px",o.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_initPath:function(t){this._updateDashArray(t),this._layers[o.stamp(t)]=t},_addPath:o.Util.falseFn,_removePath:function(t){t._removed=!0,this._requestRedraw(t)},_updatePath:function(t){this._redrawBounds=t._pxBounds,this._draw(!0),t._project(),t._update(),this._draw(),this._redrawBounds=null},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(t.options.dashArray){var e,i=t.options.dashArray.split(","),n=[];for(e=0;e<i.length;e++)n.push(Number(i[e]));t.options._dashArray=n}},_requestRedraw:function(t){if(this._map){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new o.Bounds,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e])),this._redrawRequest=this._redrawRequest||o.Util.requestAnimFrame(this._redraw,this)}},_redraw:function(){this._redrawRequest=null,this._draw(!0),this._draw(),this._redrawBounds=null},_draw:function(t){this._clear=t;var e,i=this._redrawBounds;this._ctx.save(),i&&(this._ctx.beginPath(),this._ctx.rect(i.min.x,i.min.y,i.max.x-i.min.x,i.max.y-i.min.y),this._ctx.clip());for(var n in this._layers)e=this._layers[n],(!i||e._pxBounds&&e._pxBounds.intersects(i))&&e._updatePath(),t&&e._removed&&(delete e._removed,delete this._layers[n]);this._ctx.restore()},_updatePoly:function(t,e){var i,n,o,a,r=t._parts,s=r.length,c=this._ctx;if(s){for(this._drawnLayers[t._leaflet_id]=t,c.beginPath(),c.setLineDash&&c.setLineDash(t.options&&t.options._dashArray||[]),i=0;s>i;i++){for(n=0,o=r[i].length;o>n;n++)a=r[i][n],c[n?"lineTo":"moveTo"](a.x,a.y);e&&c.closePath()}this._fillStroke(c,t)}},_updateCircle:function(t){if(!t._empty()){var e=t._point,i=this._ctx,n=t._radius,o=(t._radiusY||n)/n;this._drawnLayers[t._leaflet_id]=t,1!==o&&(i.save(),i.scale(1,o)),i.beginPath(),i.arc(e.x,e.y/o,n,0,2*Math.PI,!1),1!==o&&i.restore(),this._fillStroke(i,t)}},_fillStroke:function(t,e){var i=this._clear,n=e.options;t.globalCompositeOperation=i?"destination-out":"source-over",n.fill&&(t.globalAlpha=i?1:n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.globalAlpha=i?1:n.opacity,e._prevWeight=t.lineWidth=i?e._prevWeight+1:n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){var e,i=this._map.mouseEventToLayerPoint(t),n=[];for(var a in this._layers)e=this._layers[a],e.options.interactive&&e._containsPoint(i)&&!this._map._draggableMoved(e)&&(o.DomEvent._fakeStop(t),n.push(e));n.length&&this._fireEvent(n,t)},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseOut(t,e),this._handleMouseHover(t,e)}},_handleMouseOut:function(t,e){var i=this._hoveredLayer;!i||"mouseout"!==t.type&&i._containsPoint(e)||(o.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){var i,n;for(i in this._drawnLayers)n=this._drawnLayers[i],n.options.interactive&&n._containsPoint(e)&&(o.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([n],t,"mouseover"),this._hoveredLayer=n);this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,i){this._map._fireDOMEvent(e,i||e.type,t)},_bringToFront:o.Util.falseFn,_bringToBack:o.Util.falseFn}),o.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),o.canvas=function(t){return o.Browser.canvas?new o.Canvas(t):null},o.Polyline.prototype._containsPoint=function(t,e){var i,n,a,r,s,c,l=this._clickTolerance();if(!this._pxBounds.contains(t))return!1;for(i=0,r=this._parts.length;r>i;i++)for(c=this._parts[i],n=0,s=c.length,a=s-1;s>n;a=n++)if((e||0!==n)&&o.LineUtil.pointToSegmentDistance(t,c[a],c[n])<=l)return!0;return!1},o.Polygon.prototype._containsPoint=function(t){var e,i,n,a,r,s,c,l,h=!1;if(!this._pxBounds.contains(t))return!1;for(a=0,c=this._parts.length;c>a;a++)for(e=this._parts[a],r=0,l=e.length,s=l-1;l>r;s=r++)i=e[r],n=e[s],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(h=!h);return h||o.Polyline.prototype._containsPoint.call(this,t,!0)},o.CircleMarker.prototype._containsPoint=function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()},o.GeoJSON=o.FeatureGroup.extend({initialize:function(t,e){o.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,a=o.Util.isArray(t)?t:t.features;if(a){for(e=0,i=a.length;i>e;e++)n=a[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(n);return this;
}var r=this.options;if(r.filter&&!r.filter(t))return this;var s=o.GeoJSON.geometryToLayer(t,r);return s?(s.feature=o.GeoJSON.asFeature(t),s.defaultOptions=s.options,this.resetStyle(s),r.onEachFeature&&r.onEachFeature(t,s),this.addLayer(s)):this},resetStyle:function(t){return t.options=o.Util.extend({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),o.extend(o.GeoJSON,{geometryToLayer:function(t,e){var i,n,a,r,s="Feature"===t.type?t.geometry:t,c=s?s.coordinates:null,l=[],h=e&&e.pointToLayer,d=e&&e.coordsToLatLng||this.coordsToLatLng;if(!c&&!s)return null;switch(s.type){case"Point":return i=d(c),h?h(t,i):new o.Marker(i);case"MultiPoint":for(a=0,r=c.length;r>a;a++)i=d(c[a]),l.push(h?h(t,i):new o.Marker(i));return new o.FeatureGroup(l);case"LineString":case"MultiLineString":return n=this.coordsToLatLngs(c,"LineString"===s.type?0:1,d),new o.Polyline(n,e);case"Polygon":case"MultiPolygon":return n=this.coordsToLatLngs(c,"Polygon"===s.type?1:2,d),new o.Polygon(n,e);case"GeometryCollection":for(a=0,r=s.geometries.length;r>a;a++){var u=this.geometryToLayer({geometry:s.geometries[a],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new o.FeatureGroup(l);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new o.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){for(var n,o=[],a=0,r=t.length;r>a;a++)n=e?this.coordsToLatLngs(t[a],e-1,i):(i||this.coordsToLatLng)(t[a]),o.push(n);return o},latLngToCoords:function(t){return t.alt!==i?[t.lng,t.lat,t.alt]:[t.lng,t.lat]},latLngsToCoords:function(t,e,i){for(var n=[],a=0,r=t.length;r>a;a++)n.push(e?o.GeoJSON.latLngsToCoords(t[a],e-1,i):o.GeoJSON.latLngToCoords(t[a]));return!e&&i&&n.push(n[0]),n},getFeature:function(t,e){return t.feature?o.extend({},t.feature,{geometry:e}):o.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var r={toGeoJSON:function(){return o.GeoJSON.getFeature(this,{type:"Point",coordinates:o.GeoJSON.latLngToCoords(this.getLatLng())})}};o.Marker.include(r),o.Circle.include(r),o.CircleMarker.include(r),o.Polyline.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=o.GeoJSON.latLngsToCoords(this._latlngs,t?1:0);return o.GeoJSON.getFeature(this,{type:(t?"Multi":"")+"LineString",coordinates:e})},o.Polygon.prototype.toGeoJSON=function(){var t=!o.Polyline._flat(this._latlngs),e=t&&!o.Polyline._flat(this._latlngs[0]),i=o.GeoJSON.latLngsToCoords(this._latlngs,e?2:t?1:0,!0);return t||(i=[i]),o.GeoJSON.getFeature(this,{type:(e?"Multi":"")+"Polygon",coordinates:i})},o.LayerGroup.include({toMultiPoint:function(){var t=[];return this.eachLayer(function(e){t.push(e.toGeoJSON().geometry.coordinates)}),o.GeoJSON.getFeature(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint();var e="GeometryCollection"===t,i=[];return this.eachLayer(function(t){if(t.toGeoJSON){var n=t.toGeoJSON();i.push(e?n.geometry:o.GeoJSON.asFeature(n))}}),e?o.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}}),o.geoJSON=function(t,e){return new o.GeoJSON(t,e)},o.geoJson=o.geoJSON;var s="_leaflet_events";o.DomEvent={on:function(t,e,i,n){if("object"==typeof e)for(var a in e)this._on(t,a,e[a],i);else{e=o.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._on(t,e[r],i,n)}return this},off:function(t,e,i,n){if("object"==typeof e)for(var a in e)this._off(t,a,e[a],i);else{e=o.Util.splitWords(e);for(var r=0,s=e.length;s>r;r++)this._off(t,e[r],i,n)}return this},_on:function(e,i,n,a){var r=i+o.stamp(n)+(a?"_"+o.stamp(a):"");if(e[s]&&e[s][r])return this;var c=function(i){return n.call(a||e,i||t.event)},l=c;return o.Browser.pointer&&0===i.indexOf("touch")?this.addPointerListener(e,i,c,r):o.Browser.touch&&"dblclick"===i&&this.addDoubleTapListener?this.addDoubleTapListener(e,c,r):"addEventListener"in e?"mousewheel"===i?e.addEventListener("onwheel"in e?"wheel":"mousewheel",c,!1):"mouseenter"===i||"mouseleave"===i?(c=function(i){i=i||t.event,o.DomEvent._isExternalTarget(e,i)&&l(i)},e.addEventListener("mouseenter"===i?"mouseover":"mouseout",c,!1)):("click"===i&&o.Browser.android&&(c=function(t){return o.DomEvent._filterClick(t,l)}),e.addEventListener(i,c,!1)):"attachEvent"in e&&e.attachEvent("on"+i,c),e[s]=e[s]||{},e[s][r]=c,this},_off:function(t,e,i,n){var a=e+o.stamp(i)+(n?"_"+o.stamp(n):""),r=t[s]&&t[s][a];return r?(o.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,a):o.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,a):"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",r,!1):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[s][a]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,o.DomEvent._skipped(t),this},disableScrollPropagation:function(t){return o.DomEvent.on(t,"mousewheel",o.DomEvent.stopPropagation)},disableClickPropagation:function(t){var e=o.DomEvent.stopPropagation;return o.DomEvent.on(t,o.Draggable.START.join(" "),e),o.DomEvent.on(t,{click:o.DomEvent._fakeStop,dblclick:e})},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return o.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new o.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new o.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},_wheelPxFactor:o.Browser.win&&o.Browser.chrome?2:o.Browser.gecko?t.devicePixelRatio:1,getWheelDelta:function(t){return o.Browser.edge?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/o.DomEvent._wheelPxFactor:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0},_skipEvents:{},_fakeStop:function(t){o.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_isExternalTarget:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,n=o.DomEvent._lastClick&&i-o.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void o.DomEvent.stop(t):(o.DomEvent._lastClick=i,void e(t))}},o.DomEvent.addListener=o.DomEvent.on,o.DomEvent.removeListener=o.DomEvent.off,o.Draggable=o.Evented.extend({options:{clickTolerance:3},statics:{START:o.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e,i){this._element=t,this._dragStartTarget=e||t,this._preventOutline=i},enable:function(){this._enabled||(o.DomEvent.on(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(o.DomEvent.off(this._dragStartTarget,o.Draggable.START.join(" "),this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!o.DomUtil.hasClass(this._element,"leaflet-zoom-anim")&&!(o.Draggable._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches)&&this._enabled&&(o.Draggable._dragging=!0,this._preventOutline&&o.DomUtil.preventOutline(this._element),o.DomUtil.disableImageDrag(),o.DomUtil.disableTextSelection(),!this._moving))){this.fire("down");var i=t.touches?t.touches[0]:t;this._startPoint=new o.Point(i.clientX,i.clientY),o.DomEvent.on(e,o.Draggable.MOVE[t.type],this._onMove,this).on(e,o.Draggable.END[t.type],this._onUp,this)}},_onMove:function(i){if(!i._simulated&&this._enabled){if(i.touches&&i.touches.length>1)return void(this._moved=!0);var n=i.touches&&1===i.touches.length?i.touches[0]:i,a=new o.Point(n.clientX,n.clientY),r=a.subtract(this._startPoint);(r.x||r.y)&&(Math.abs(r.x)+Math.abs(r.y)<this.options.clickTolerance||(o.DomEvent.preventDefault(i),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=o.DomUtil.getPosition(this._element).subtract(r),o.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,t.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),o.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,o.Util.cancelAnimFrame(this._animRequest),this._lastEvent=i,this._animRequest=o.Util.requestAnimFrame(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),o.DomUtil.setPosition(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){if(!t._simulated&&this._enabled){o.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(o.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var i in o.Draggable.MOVE)o.DomEvent.off(e,o.Draggable.MOVE[i],this._onMove,this).off(e,o.Draggable.END[i],this._onUp,this);o.DomUtil.enableImageDrag(),o.DomUtil.enableTextSelection(),this._moved&&this._moving&&(o.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,o.Draggable._dragging=!1}}}),o.Handler=o.Class.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}}),o.Map.mergeOptions({dragging:!0,inertia:!o.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0}),o.Map.Drag=o.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new o.Draggable(t._mapPane,t._container),this._draggable.on({down:this._onDown,dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}o.DomUtil.addClass(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-grab"),o.DomUtil.removeClass(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDown:function(){this._map._stop()},_onDragStart:function(){var t=this._map;if(this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=o.latLngBounds(this._map.options.maxBounds);this._offsetLimit=o.bounds(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,i=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(i),this._times.push(e),e-this._times[0]>50&&(this._positions.shift(),this._times.shift())}this._map.fire("move",t).fire("drag",t)},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,o=(n-e+i)%t+e-i,a=(n+e+i)%t-e-i,r=Math.abs(o+i)<Math.abs(a+i)?o:a;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,i=e.options,n=!i.inertia||this._times.length<2;if(e.fire("dragend",t),n)e.fire("moveend");else{var a=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,s=i.easeLinearity,c=a.multiplyBy(s/r),l=c.distanceTo([0,0]),h=Math.min(i.inertiaMaxSpeed,l),d=c.multiplyBy(h/l),u=h/(i.inertiaDeceleration*s),m=d.multiplyBy(-u/2).round();m.x||m.y?(m=e._limitOffset(m,e.options.maxBounds),o.Util.requestAnimFrame(function(){e.panBy(m,{duration:u,easeLinearity:s,noMoveStart:!0,animate:!0})})):e.fire("moveend")}}}),o.Map.addInitHook("addHandler","dragging",o.Map.Drag),o.Map.mergeOptions({doubleClickZoom:!0}),o.Map.DoubleClickZoom=o.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom(),n=e.options.zoomDelta,o=t.originalEvent.shiftKey?i-n:i+n;"center"===e.options.doubleClickZoom?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}}),o.Map.addInitHook("addHandler","doubleClickZoom",o.Map.DoubleClickZoom),o.Map.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60}),o.Map.ScrollWheelZoom=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){o.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=o.DomEvent.getWheelDelta(t),i=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(i-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o.bind(this._performZoom,this),n),o.DomEvent.stop(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),i=this._map.options.zoomSnap||0;t._stop();var n=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(n))))/Math.LN2,a=i?Math.ceil(o/i)*i:o,r=t._limitZoom(e+(this._delta>0?a:-a))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}}),o.Map.addInitHook("addHandler","scrollWheelZoom",o.Map.ScrollWheelZoom),o.extend(o.DomEvent,{_touchstart:o.Browser.msPointer?"MSPointerDown":o.Browser.pointer?"pointerdown":"touchstart",_touchend:o.Browser.msPointer?"MSPointerUp":o.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function n(t){var e;if(e=o.Browser.pointer?o.DomEvent._pointersCount:t.touches.length,!(e>1)){var i=Date.now(),n=i-(r||i);s=t.touches?t.touches[0]:t,c=n>0&&l>=n,r=i}}function a(){if(c&&!s.cancelBubble){if(o.Browser.pointer){var t,i,n={};for(i in s)t=s[i],n[i]=t&&t.bind?t.bind(s):t;s=n}s.type="dblclick",e(s),r=null}}var r,s,c=!1,l=250,h="_leaflet_",d=this._touchstart,u=this._touchend;return t[h+d+i]=n,t[h+u+i]=a,t[h+"dblclick"+i]=e,t.addEventListener(d,n,!1),t.addEventListener(u,a,!1),o.Browser.edge||t.addEventListener("dblclick",e,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_",n=t[i+this._touchstart+e],a=t[i+this._touchend+e],r=t[i+"dblclick"+e];return t.removeEventListener(this._touchstart,n,!1),t.removeEventListener(this._touchend,a,!1),o.Browser.edge||t.removeEventListener("dblclick",r,!1),this}}),o.extend(o.DomEvent,{POINTER_DOWN:o.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:o.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:o.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:o.Browser.msPointer?"MSPointerCancel":"pointercancel",TAG_WHITE_LIST:["INPUT","SELECT","OPTION"],_pointers:{},_pointersCount:0,addPointerListener:function(t,e,i,n){return"touchstart"===e?this._addPointerStart(t,i,n):"touchmove"===e?this._addPointerMove(t,i,n):"touchend"===e&&this._addPointerEnd(t,i,n),this},removePointerListener:function(t,e,i){var n=t["_leaflet_"+e+i];return"touchstart"===e?t.removeEventListener(this.POINTER_DOWN,n,!1):"touchmove"===e?t.removeEventListener(this.POINTER_MOVE,n,!1):"touchend"===e&&(t.removeEventListener(this.POINTER_UP,n,!1),t.removeEventListener(this.POINTER_CANCEL,n,!1)),this},_addPointerStart:function(t,i,n){var a=o.bind(function(t){if("mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(this.TAG_WHITE_LIST.indexOf(t.target.tagName)<0))return;o.DomEvent.preventDefault(t)}this._handlePointer(t,i)},this);if(t["_leaflet_touchstart"+n]=a,t.addEventListener(this.POINTER_DOWN,a,!1),!this._pointerDocListener){var r=o.bind(this._globalPointerUp,this);e.documentElement.addEventListener(this.POINTER_DOWN,o.bind(this._globalPointerDown,this),!0),e.documentElement.addEventListener(this.POINTER_MOVE,o.bind(this._globalPointerMove,this),!0),e.documentElement.addEventListener(this.POINTER_UP,r,!0),e.documentElement.addEventListener(this.POINTER_CANCEL,r,!0),this._pointerDocListener=!0}},_globalPointerDown:function(t){this._pointers[t.pointerId]=t,this._pointersCount++},_globalPointerMove:function(t){this._pointers[t.pointerId]&&(this._pointers[t.pointerId]=t)},_globalPointerUp:function(t){delete this._pointers[t.pointerId],this._pointersCount--},_handlePointer:function(t,e){t.touches=[];for(var i in this._pointers)t.touches.push(this._pointers[i]);t.changedTouches=[t],e(t)},_addPointerMove:function(t,e,i){var n=o.bind(function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&this._handlePointer(t,e)},this);t["_leaflet_touchmove"+i]=n,t.addEventListener(this.POINTER_MOVE,n,!1)},_addPointerEnd:function(t,e,i){var n=o.bind(function(t){this._handlePointer(t,e)},this);t["_leaflet_touchend"+i]=n,t.addEventListener(this.POINTER_UP,n,!1),t.addEventListener(this.POINTER_CANCEL,n,!1)}}),o.Map.mergeOptions({touchZoom:o.Browser.touch&&!o.Browser.android23,bounceAtZoomLimits:!0}),o.Map.TouchZoom=o.Handler.extend({addHooks:function(){o.DomUtil.addClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){o.DomUtil.removeClass(this._map._container,"leaflet-touch-zoom"),o.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToContainerPoint(t.touches[0]),a=i.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=i.getSize()._divideBy(2),this._startLatLng=i.containerPointToLatLng(this._centerPoint),"center"!==i.options.touchZoom&&(this._pinchStartLatLng=i.containerPointToLatLng(n.add(a)._divideBy(2))),this._startDist=n.distanceTo(a),this._startZoom=i.getZoom(),this._moved=!1,this._zooming=!0,i._stop(),o.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),o.DomEvent.preventDefault(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,i=e.mouseEventToContainerPoint(t.touches[0]),n=e.mouseEventToContainerPoint(t.touches[1]),a=i.distanceTo(n)/this._startDist;if(this._zoom=e.getScaleZoom(a,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&1>a||this._zoom>e.getMaxZoom()&&a>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===a)return}else{var r=i._add(n)._divideBy(2)._subtract(this._centerPoint);if(1===a&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0),this._moved=!0),o.Util.cancelAnimFrame(this._animRequest);var s=o.bind(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=o.Util.requestAnimFrame(s,this,!0),o.DomEvent.preventDefault(t)}},_onTouchEnd:function(){return this._moved&&this._zooming?(this._zooming=!1,o.Util.cancelAnimFrame(this._animRequest),o.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd),void(this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom)))):void(this._zooming=!1)}}),o.Map.addInitHook("addHandler","touchZoom",o.Map.TouchZoom),o.Map.mergeOptions({tap:!0,tapTolerance:15}),o.Map.Tap=o.Handler.extend({addHooks:function(){o.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){o.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(o.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new o.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(o.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),this._simulateEvent("mousedown",i),o.DomEvent.on(e,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),o.DomEvent.off(e,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&o.DomUtil.removeClass(n,"leaflet-active"),this._simulateEvent("mouseup",i),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new o.Point(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(i,n){var o=e.createEvent("MouseEvents");o._simulated=!0,n.target._simulatedClick=!0,o.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(o)}}),o.Browser.touch&&!o.Browser.pointer&&o.Map.addInitHook("addHandler","tap",o.Map.Tap),o.Map.mergeOptions({boxZoom:!0}),o.Map.BoxZoom=o.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){o.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){o.DomEvent.off(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_resetState:function(){this._moved=!1},_onMouseDown:function(t){return!t.shiftKey||1!==t.which&&1!==t.button?!1:(this._resetState(),o.DomUtil.disableTextSelection(),o.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),void o.DomEvent.on(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this))},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=o.DomUtil.create("div","leaflet-zoom-box",this._container),o.DomUtil.addClass(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new o.Bounds(this._point,this._startPoint),i=e.getSize();o.DomUtil.setPosition(this._box,e.min),this._box.style.width=i.x+"px",this._box.style.height=i.y+"px"},_finish:function(){this._moved&&(o.DomUtil.remove(this._box),o.DomUtil.removeClass(this._container,"leaflet-crosshair")),o.DomUtil.enableTextSelection(),o.DomUtil.enableImageDrag(),o.DomEvent.off(e,{contextmenu:o.DomEvent.stop,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){setTimeout(o.bind(this._resetState,this),0);var e=new o.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),o.Map.addInitHook("addHandler","boxZoom",o.Map.BoxZoom),o.Map.mergeOptions({keyboard:!0,keyboardPanDelta:80}),o.Map.Keyboard=o.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),o.DomEvent.on(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),o.DomEvent.off(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,o=i.scrollTop||n.scrollTop,a=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(a,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,i,n=this._panKeys={},o=this.keyCodes;for(e=0,i=o.left.length;i>e;e++)n[o.left[e]]=[-1*t,0];for(e=0,i=o.right.length;i>e;e++)n[o.right[e]]=[t,0];for(e=0,i=o.down.length;i>e;e++)n[o.down[e]]=[0,t];for(e=0,i=o.up.length;i>e;e++)n[o.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,i,n=this._zoomKeys={},o=this.keyCodes;for(e=0,i=o.zoomIn.length;i>e;e++)n[o.zoomIn[e]]=t;for(e=0,i=o.zoomOut.length;i>e;e++)n[o.zoomOut[e]]=-t},_addHooks:function(){o.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){o.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,i=t.keyCode,n=this._map;if(i in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;e=this._panKeys[i],t.shiftKey&&(e=o.point(e).multiplyBy(3)),n.panBy(e),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else if(i in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[i]);else{if(27!==i)return;n.closePopup()}o.DomEvent.stop(t)}}}),o.Map.addInitHook("addHandler","keyboard",o.Map.Keyboard),o.Handler.MarkerDrag=o.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new o.Draggable(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),o.DomUtil.addClass(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&o.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(t){var e=this._marker,i=e._shadow,n=o.DomUtil.getPosition(e._icon),a=e._map.layerPointToLatLng(n);i&&o.DomUtil.setPosition(i,n),e._latlng=a,t.latlng=a,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),o.Control=o.Class.extend({options:{position:"topright"},initialize:function(t){o.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return o.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},remove:function(){return this._map?(o.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),o.control=function(t){return new o.Control(t)},o.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){function t(t,a){var r=i+t+" "+i+a;e[t+a]=o.DomUtil.create("div",r,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=o.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){o.DomUtil.remove(this._controlContainer)}}),o.Control.Zoom=o.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=o.DomUtil.create("div",e+" leaflet-bar"),n=this.options;return this._zoomInButton=this._createButton(n.zoomInText,n.zoomInTitle,e+"-in",i,this._zoomIn),this._zoomOutButton=this._createButton(n.zoomOutText,n.zoomOutTitle,e+"-out",i,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,i,n,a){var r=o.DomUtil.create("a",i,n);return r.innerHTML=t,r.href="#",r.title=e,o.DomEvent.on(r,"mousedown dblclick",o.DomEvent.stopPropagation).on(r,"click",o.DomEvent.stop).on(r,"click",a,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";o.DomUtil.removeClass(this._zoomInButton,e),o.DomUtil.removeClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&o.DomUtil.addClass(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&o.DomUtil.addClass(this._zoomInButton,e)}}),o.Map.mergeOptions({zoomControl:!0}),o.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new o.Control.Zoom,this.addControl(this.zoomControl))}),o.control.zoom=function(t){return new o.Control.Zoom(t)},o.Control.Attribution=o.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){o.setOptions(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=o.DomUtil.create("div","leaflet-control-attribution"),o.DomEvent&&o.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());
return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}}}),o.Map.mergeOptions({attributionControl:!0}),o.Map.addInitHook(function(){this.options.attributionControl&&(new o.Control.Attribution).addTo(this)}),o.control.attribution=function(t){return new o.Control.Attribution(t)},o.Control.Scale=o.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",i=o.DomUtil.create("div",e),n=this.options;return this._addScales(n,e+"-line",i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=o.DomUtil.create("div",e,i)),t.imperial&&(this._iScale=o.DomUtil.create("div",e,i))},_update:function(){var t=this._map,e=t.getSize().y/2,i=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(i)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),i=1e3>e?e+" m":e/1e3+" km";this._updateScale(this._mScale,i,e/t)},_updateImperial:function(t){var e,i,n,o=3.2808399*t;o>5280?(e=o/5280,i=this._getRoundNum(e),this._updateScale(this._iScale,i+" mi",i/e)):(n=this._getRoundNum(o),this._updateScale(this._iScale,n+" ft",n/o))},_updateScale:function(t,e,i){t.style.width=Math.round(this.options.maxWidth*i)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),o.control.scale=function(t){return new o.Control.Scale(t)},o.Control.Layers=o.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1},initialize:function(t,e,i){o.setOptions(this,i),this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this),this._container},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(o.stamp(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){o.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._form.clientHeight?(o.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=t+"px"):o.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return o.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=o.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),o.DomEvent.disableClickPropagation(e),o.Browser.touch||o.DomEvent.disableScrollPropagation(e);var i=this._form=o.DomUtil.create("form",t+"-list");if(this.options.collapsed){o.Browser.android||o.DomEvent.on(e,{mouseenter:this.expand,mouseleave:this.collapse},this);var n=this._layersLink=o.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",o.Browser.touch?o.DomEvent.on(n,"click",o.DomEvent.stop).on(n,"click",this.expand,this):o.DomEvent.on(n,"focus",this.expand,this),o.DomEvent.on(i,"click",function(){setTimeout(o.bind(this._onInputClick,this),0)},this),this._map.on("click",this.collapse,this)}else this.expand();this._baseLayersList=o.DomUtil.create("div",t+"-base",i),this._separator=o.DomUtil.create("div",t+"-separator",i),this._overlaysList=o.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&o.stamp(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,i){t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:i}),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(!this._container)return this;o.DomUtil.empty(this._baseLayersList),o.DomUtil.empty(this._overlaysList);var t,e,i,n,a=0;for(i=0;i<this._layers.length;i++)n=this._layers[i],this._addItem(n),e=e||n.overlay,t=t||!n.overlay,a+=n.overlay?0:1;return this.options.hideSingleBase&&(t=t&&a>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(o.stamp(t.target)),i=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(i?' checked="checked"':"")+"/>",o=e.createElement("div");return o.innerHTML=n,o.firstChild},_addItem:function(t){var i,n=e.createElement("label"),a=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=a):i=this._createRadioElement("leaflet-base-layers",a),i.layerId=o.stamp(t.layer),o.DomEvent.on(i,"click",this._onInputClick,this);var r=e.createElement("span");r.innerHTML=" "+t.name;var s=e.createElement("div");n.appendChild(s),s.appendChild(i),s.appendChild(r);var c=t.overlay?this._overlaysList:this._baseLayersList;return c.appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),o=[],a=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)t=n[r],e=this._getLayer(t.layerId).layer,i=this._map.hasLayer(e),t.checked&&!i?o.push(e):!t.checked&&i&&a.push(e);for(r=0;r<a.length;r++)this._map.removeLayer(a[r]);for(r=0;r<o.length;r++)this._map.addLayer(o[r]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._form.getElementsByTagName("input"),o=this._map.getZoom(),a=n.length-1;a>=0;a--)t=n[a],e=this._getLayer(t.layerId).layer,t.disabled=e.options.minZoom!==i&&o<e.options.minZoom||e.options.maxZoom!==i&&o>e.options.maxZoom},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),o.control.layers=function(t,e,i){return new o.Control.Layers(t,e,i)},o.PosAnimation=o.Evented.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=o.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=o.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,i=1e3*this._duration;i>e?this._runFrame(this._easeOut(e/i),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var i=this._startPos.add(this._offset.multiplyBy(t));e&&i._round(),o.DomUtil.setPosition(this._el,i),this.fire("step")},_complete:function(){o.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),o.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(o.latLng(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=o.extend({animate:n.animate},n.zoom),n.pan=o.extend({animate:n.animate,duration:n.duration},n.pan));var a=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(a)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=o.point(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new o.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){o.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){o.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),o.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4});var c=o.DomUtil.TRANSITION&&o.Browser.any3d&&!o.Browser.mobileOpera;c&&o.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),o.DomEvent.on(this._proxy,o.DomUtil.TRANSITION_END,this._catchTransitionEnd,this))}),o.Map.include(c?{_createAnimProxy:function(){var t=this._proxy=o.DomUtil.create("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var i=o.DomUtil.TRANSFORM,n=t.style[i];o.DomUtil.setTransform(t,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===t.style[i]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var e=this.getCenter(),i=this.getZoom();o.DomUtil.setTransform(t,this.project(e,i),this.getZoomScale(i,1))},this)},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),a=this._getCenterOffset(t)._divideBy(1-1/n);return i.animate===!0||this.getSize().contains(a)?(o.Util.requestAnimFrame(function(){this._moveStart(!0)._animateZoom(t,e,!0)},this),!0):!1},_animateZoom:function(t,e,i,n){i&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,o.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:n}),setTimeout(o.bind(this._onZoomTransitionEnd,this),250)},_onZoomTransitionEnd:function(){this._animatingZoom&&(o.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),o.Util.requestAnimFrame(function(){this._moveEnd(!0)},this))}}:{}),o.Map.include({flyTo:function(t,e,n){function a(t){var e=t?-1:1,i=t?v:_,n=v*v-_*_+e*C*C*y*y,o=2*i*C*y,a=n/o,r=Math.sqrt(a*a+1)-a,s=1e-9>r?-18:Math.log(r);return s}function r(t){return(Math.exp(t)-Math.exp(-t))/2}function s(t){return(Math.exp(t)+Math.exp(-t))/2}function c(t){return r(t)/s(t)}function l(t){return _*(s(L)/s(L+A*t))}function h(t){return _*(s(L)*c(L+A*t)-r(L))/C}function d(t){return 1-Math.pow(1-t,1.5)}function u(){var i=(Date.now()-P)/S,n=d(i)*w;1>=i?(this._flyToFrame=o.Util.requestAnimFrame(u,this),this._move(this.unproject(m.add(p.subtract(m).multiplyBy(h(n)/y)),g),this.getScaleZoom(_/l(n),g),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}if(n=n||{},n.animate===!1||!o.Browser.any3d)return this.setView(t,e,n);this._stop();var m=this.project(this.getCenter()),p=this.project(t),f=this.getSize(),g=this._zoom;t=o.latLng(t),e=e===i?g:e;var _=Math.max(f.x,f.y),v=_*this.getZoomScale(g,e),y=p.distanceTo(m)||1,A=1.42,C=A*A,L=a(0),P=Date.now(),w=(a(1)-L)/A,S=n.duration?1e3*n.duration:1e3*w*.8;return this._moveStart(!0),u.call(this),this},flyToBounds:function(t,e){var i=this._getBoundsCenterZoom(t,e);return this.flyTo(i.center,i.zoom,e)}}),o.Map.include({_defaultLocateOptions:{timeout:1e4,watch:!1},locate:function(t){if(t=this._locateOptions=o.extend({},this._defaultLocateOptions,t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=o.bind(this._handleGeolocationResponse,this),i=o.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new o.LatLng(e,i),a=n.toBounds(t.coords.accuracy),r=this._locateOptions;if(r.setView){var s=this.getBoundsZoom(a);this.setView(n,r.maxZoom?Math.min(s,r.maxZoom):s)}var c={latlng:n,bounds:a,timestamp:t.timestamp};for(var l in t.coords)"number"==typeof t.coords[l]&&(c[l]=t.coords[l]);this.fire("locationfound",c)}})}(window,document),function(t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():window.noUiSlider=t()}(function(){"use strict";function t(t,e){var i=document.createElement("div");return l(i,e),t.appendChild(i),i}function e(t){return t.filter(function(t){return this[t]?!1:this[t]=!0},{})}function i(t,e){return Math.round(t/e)*e}function n(t,e){var i=t.getBoundingClientRect(),n=t.ownerDocument,o=n.documentElement,a=u();return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(a.x=0),e?i.top+a.y-o.clientTop:i.left+a.x-o.clientLeft}function o(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function a(t,e,i){i>0&&(l(t,e),setTimeout(function(){h(t,e)},i))}function r(t){return Math.max(Math.min(t,100),0)}function s(t){return Array.isArray(t)?t:[t]}function c(t){t=String(t);var e=t.split(".");return e.length>1?e[1].length:0}function l(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function h(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," ")}function d(t,e){return t.classList?t.classList.contains(e):new RegExp("\\b"+e+"\\b").test(t.className)}function u(){var t=void 0!==window.pageXOffset,e="CSS1Compat"===(document.compatMode||""),i=t?window.pageXOffset:e?document.documentElement.scrollLeft:document.body.scrollLeft,n=t?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop;return{x:i,y:n}}function m(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function p(t,e){return 100/(e-t)}function f(t,e){return 100*e/(t[1]-t[0])}function g(t,e){return f(t,t[0]<0?e+Math.abs(t[0]):e-t[0])}function _(t,e){return e*(t[1]-t[0])/100+t[0]}function v(t,e){for(var i=1;t>=e[i];)i+=1;return i}function y(t,e,i){if(i>=t.slice(-1)[0])return 100;var n,o,a,r,s=v(i,t);return n=t[s-1],o=t[s],a=e[s-1],r=e[s],a+g([n,o],i)/p(a,r)}function A(t,e,i){if(i>=100)return t.slice(-1)[0];var n,o,a,r,s=v(i,e);return n=t[s-1],o=t[s],a=e[s-1],r=e[s],_([n,o],(i-a)*p(a,r))}function C(t,e,n,o){if(100===o)return o;var a,r,s=v(o,t);return n?(a=t[s-1],r=t[s],o-a>(r-a)/2?r:a):e[s-1]?t[s-1]+i(o-t[s-1],e[s-1]):o}function L(t,e,i){var n;if("number"==typeof e&&(e=[e]),"[object Array]"!==Object.prototype.toString.call(e))throw new Error("noUiSlider: 'range' contains invalid value.");if(n="min"===t?0:"max"===t?100:parseFloat(t),!o(n)||!o(e[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");i.xPct.push(n),i.xVal.push(e[0]),n?i.xSteps.push(isNaN(e[1])?!1:e[1]):isNaN(e[1])||(i.xSteps[0]=e[1]),i.xHighestCompleteStep.push(0)}function P(t,e,i){if(!e)return!0;i.xSteps[t]=f([i.xVal[t],i.xVal[t+1]],e)/p(i.xPct[t],i.xPct[t+1]);var n=(i.xVal[t+1]-i.xVal[t])/i.xNumSteps[t],o=Math.ceil(Number(n.toFixed(3))-1),a=i.xVal[t]+i.xNumSteps[t]*o;i.xHighestCompleteStep[t]=a}function w(t,e,i,n){this.xPct=[],this.xVal=[],this.xSteps=[n||!1],this.xNumSteps=[!1],this.xHighestCompleteStep=[],this.snap=e,this.direction=i;var o,a=[];for(o in t)t.hasOwnProperty(o)&&a.push([t[o],o]);for(a.length&&"object"==typeof a[0][0]?a.sort(function(t,e){return t[0][0]-e[0][0]}):a.sort(function(t,e){return t[0]-e[0]}),o=0;o<a.length;o++)L(a[o][1],a[o][0],this);for(this.xNumSteps=this.xSteps.slice(0),o=0;o<this.xNumSteps.length;o++)P(o,this.xNumSteps[o],this)}function S(t,e){if(!o(e))throw new Error("noUiSlider: 'step' is not numeric.");t.singleStep=e}function T(t,e){if("object"!=typeof e||Array.isArray(e))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===e.min||void 0===e.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");if(e.min===e.max)throw new Error("noUiSlider: 'range' 'min' and 'max' cannot be equal.");t.spectrum=new w(e,t.snap,t.dir,t.singleStep)}function b(t,e){if(e=s(e),!Array.isArray(e)||!e.length)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=e.length,t.start=e}function x(t,e){if(t.snap=e,"boolean"!=typeof e)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function D(t,e){if(t.animate=e,"boolean"!=typeof e)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function M(t,e){if(t.animationDuration=e,"number"!=typeof e)throw new Error("noUiSlider: 'animationDuration' option must be a number.")}function E(t,e){var i,n=[!1];if(e===!0||e===!1){for(i=1;i<t.handles;i++)n.push(e);n.push(!1)}else{if(!Array.isArray(e)||!e.length||e.length!==t.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");n=e}t.connect=n}function B(t,e){switch(e){case"horizontal":t.ort=0;break;case"vertical":t.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function I(t,e){if(!o(e))throw new Error("noUiSlider: 'margin' option must be numeric.");if(0!==e&&(t.margin=t.spectrum.getMargin(e),!t.margin))throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function k(t,e){if(!o(e))throw new Error("noUiSlider: 'limit' option must be numeric.");if(t.limit=t.spectrum.getMargin(e),!t.limit||t.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function U(t,e){switch(e){case"ltr":t.dir=0;break;case"rtl":t.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function O(t,e){if("string"!=typeof e)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=e.indexOf("tap")>=0,n=e.indexOf("drag")>=0,o=e.indexOf("fixed")>=0,a=e.indexOf("snap")>=0,r=e.indexOf("hover")>=0;if(o){if(2!==t.handles)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");I(t,t.start[1]-t.start[0])}t.events={tap:i||a,drag:n,fixed:o,snap:a,hover:r}}function F(t,e){if(e!==!1)if(e===!0){t.tooltips=[];for(var i=0;i<t.handles;i++)t.tooltips.push(!0)}else{if(t.tooltips=s(e),t.tooltips.length!==t.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");t.tooltips.forEach(function(t){if("boolean"!=typeof t&&("object"!=typeof t||"function"!=typeof t.to))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")})}}function N(t,e){if(t.format=e,"function"==typeof e.to&&"function"==typeof e.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function R(t,e){if(void 0!==e&&"string"!=typeof e&&e!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");t.cssPrefix=e}function z(t,e){if(void 0!==e&&"object"!=typeof e)throw new Error("noUiSlider: 'cssClasses' must be an object.");if("string"==typeof t.cssPrefix){t.cssClasses={};for(var i in e)e.hasOwnProperty(i)&&(t.cssClasses[i]=t.cssPrefix+e[i])}else t.cssClasses=e}function G(t,e){if(e!==!0&&e!==!1)throw new Error("noUiSlider: 'useRequestAnimationFrame' option should be true (default) or false.");t.useRequestAnimationFrame=e}function Z(t){var e,i={margin:0,limit:0,animate:!0,animationDuration:300,format:H};e={step:{r:!1,t:S},start:{r:!0,t:b},connect:{r:!0,t:E},direction:{r:!0,t:U},snap:{r:!1,t:x},animate:{r:!1,t:D},animationDuration:{r:!1,t:M},range:{r:!0,t:T},orientation:{r:!1,t:B},margin:{r:!1,t:I},limit:{r:!1,t:k},behaviour:{r:!0,t:O},format:{r:!1,t:N},tooltips:{r:!1,t:F},cssPrefix:{r:!1,t:R},cssClasses:{r:!1,t:z},useRequestAnimationFrame:{r:!1,t:G}};var n={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",cssPrefix:"noUi-",cssClasses:{target:"target",base:"base",origin:"origin",handle:"handle",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",ltr:"ltr",rtl:"rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},useRequestAnimationFrame:!0};Object.keys(e).forEach(function(o){if(void 0===t[o]&&void 0===n[o]){if(e[o].r)throw new Error("noUiSlider: '"+o+"' is required.");return!0}e[o].t(i,void 0===t[o]?n[o]:t[o])}),i.pips=t.pips;var o=[["left","top"],["right","bottom"]];return i.style=o[i.dir][i.ort],i.styleOposite=o[i.dir?0:1][i.ort],i}function V(i,o,c){function p(e,i){var n=t(e,o.cssClasses.origin),a=t(n,o.cssClasses.handle);return a.setAttribute("data-handle",i),n}function f(e,i){return i?t(e,o.cssClasses.connect):!1}function g(t,e){et=[],it=[],it.push(f(e,t[0]));for(var i=0;i<o.handles;i++)et.push(p(e,i)),st[i]=i,it.push(f(e,t[i+1]))}function _(e){l(e,o.cssClasses.target),0===o.dir?l(e,o.cssClasses.ltr):l(e,o.cssClasses.rtl),0===o.ort?l(e,o.cssClasses.horizontal):l(e,o.cssClasses.vertical),tt=t(e,o.cssClasses.base)}function v(e,i){return o.tooltips[i]?t(e.firstChild,o.cssClasses.tooltip):!1}function y(){var t=et.map(v);q("update",function(e,i,n){if(t[i]){var a=e[i];o.tooltips[i]!==!0&&(a=o.tooltips[i].to(n[i])),t[i].innerHTML=a}})}function A(t,e,i){if("range"===t||"steps"===t)return ct.xVal;if("count"===t){var n,o=100/(e-1),a=0;for(e=[];(n=a++*o)<=100;)e.push(n);t="positions"}return"positions"===t?e.map(function(t){return ct.fromStepping(i?ct.getStep(t):t)}):"values"===t?i?e.map(function(t){return ct.fromStepping(ct.getStep(ct.toStepping(t)))}):e:void 0}function C(t,i,n){function o(t,e){return(t+e).toFixed(7)/1}var a={},r=ct.xVal[0],s=ct.xVal[ct.xVal.length-1],c=!1,l=!1,h=0;return n=e(n.slice().sort(function(t,e){return t-e})),n[0]!==r&&(n.unshift(r),c=!0),n[n.length-1]!==s&&(n.push(s),l=!0),n.forEach(function(e,r){var s,d,u,m,p,f,g,_,v,y,A=e,C=n[r+1];if("steps"===i&&(s=ct.xNumSteps[r]),s||(s=C-A),A!==!1&&void 0!==C)for(s=Math.max(s,1e-7),d=A;C>=d;d=o(d,s)){for(m=ct.toStepping(d),p=m-h,_=p/t,v=Math.round(_),y=p/v,u=1;v>=u;u+=1)f=h+u*y,a[f.toFixed(5)]=["x",0];g=n.indexOf(d)>-1?1:"steps"===i?2:0,!r&&c&&(g=0),d===C&&l||(a[m.toFixed(5)]=[d,g]),h=m}}),a}function L(t,e,i){function n(t,e){var i=e===o.cssClasses.value,n=i?u:m,a=i?h:d;return e+" "+n[o.ort]+" "+a[t]}function a(t,e,i){return'class="'+n(i[1],e)+'" style="'+o.style+": "+t+'%"'}function r(t,n){n[1]=n[1]&&e?e(n[0],n[1]):n[1],c+="<div "+a(t,o.cssClasses.marker,n)+"></div>",n[1]&&(c+="<div "+a(t,o.cssClasses.value,n)+">"+i.to(n[0])+"</div>")}var s=document.createElement("div"),c="",h=[o.cssClasses.valueNormal,o.cssClasses.valueLarge,o.cssClasses.valueSub],d=[o.cssClasses.markerNormal,o.cssClasses.markerLarge,o.cssClasses.markerSub],u=[o.cssClasses.valueHorizontal,o.cssClasses.valueVertical],m=[o.cssClasses.markerHorizontal,o.cssClasses.markerVertical];return l(s,o.cssClasses.pips),l(s,0===o.ort?o.cssClasses.pipsHorizontal:o.cssClasses.pipsVertical),Object.keys(t).forEach(function(e){r(e,t[e])}),s.innerHTML=c,s}function P(t){var e=t.mode,i=t.density||1,n=t.filter||!1,o=t.values||!1,a=t.stepped||!1,r=A(e,o,a),s=C(i,e,r),c=t.format||{to:Math.round};return at.appendChild(L(s,n,c))}function w(){var t=tt.getBoundingClientRect(),e="offset"+["Width","Height"][o.ort];return 0===o.ort?t.width||tt[e]:t.height||tt[e]}function S(t,e,i,n){var a=function(e){return at.hasAttribute("disabled")?!1:d(at,o.cssClasses.tap)?!1:(e=T(e,n.pageOffset),t===ot.start&&void 0!==e.buttons&&e.buttons>1?!1:n.hover&&e.buttons?!1:(e.calcPoint=e.points[o.ort],void i(e,n)))},r=[];return t.split(" ").forEach(function(t){e.addEventListener(t,a,!1),r.push([t,a])}),r}function T(t,e){t.preventDefault();var i,n,o=0===t.type.indexOf("touch"),a=0===t.type.indexOf("mouse"),r=0===t.type.indexOf("pointer"),s=t;if(0===t.type.indexOf("MSPointer")&&(r=!0),o){if(s.touches.length>1)return!1;i=t.changedTouches[0].pageX,n=t.changedTouches[0].pageY}return e=e||u(),(a||r)&&(i=t.clientX+e.x,n=t.clientY+e.y),s.pageOffset=e,s.points=[i,n],s.cursor=a||r,s}function b(t){var e=t-n(tt,o.ort),i=100*e/w();return o.dir?100-i:i}function x(t){var e=100,i=!1;return et.forEach(function(n,o){if(!n.hasAttribute("disabled")){var a=Math.abs(rt[o]-t);e>a&&(i=o,e=a)}}),i}function D(t,e,i,n){var o=i.slice(),a=[!t,t],r=[t,!t];n=n.slice(),t&&n.reverse(),n.length>1?n.forEach(function(t,i){var n=N(o,t,o[t]+e,a[i],r[i]);n===!1?e=0:(e=n-o[t],o[t]=n)}):a=r=[!0];var s=!1;n.forEach(function(t,n){s=V(t,i[t]+e,a[n],r[n])||s}),s&&n.forEach(function(t){M("update",t),M("slide",t)})}function M(t,e,i){Object.keys(ht).forEach(function(n){var a=n.split(".")[0];t===a&&ht[n].forEach(function(t){t.call(nt,lt.map(o.format.to),e,lt.slice(),i||!1,rt.slice())})})}function E(t,e){"mouseout"===t.type&&"HTML"===t.target.nodeName&&null===t.relatedTarget&&I(t,e)}function B(t,e){if(-1===navigator.appVersion.indexOf("MSIE 9")&&0===t.buttons&&0!==e.buttonsProperty)return I(t,e);var i=(o.dir?-1:1)*(t.calcPoint-e.startCalcPoint),n=100*i/e.baseSize;D(i>0,n,e.locations,e.handleNumbers)}function I(t,e){var i=tt.querySelector("."+o.cssClasses.active);null!==i&&h(i,o.cssClasses.active),t.cursor&&(document.body.style.cursor="",document.body.removeEventListener("selectstart",document.body.noUiListener)),document.documentElement.noUiListeners.forEach(function(t){document.documentElement.removeEventListener(t[0],t[1])}),h(at,o.cssClasses.drag),G(),e.handleNumbers.forEach(function(t){M("set",t),M("change",t),M("end",t)})}function k(t,e){if(1===e.handleNumbers.length){var i=et[e.handleNumbers[0]];if(i.hasAttribute("disabled"))return!1;l(i.children[0],o.cssClasses.active)}t.preventDefault(),t.stopPropagation();var n=S(ot.move,document.documentElement,B,{startCalcPoint:t.calcPoint,baseSize:w(),pageOffset:t.pageOffset,handleNumbers:e.handleNumbers,buttonsProperty:t.buttons,locations:rt.slice()}),a=S(ot.end,document.documentElement,I,{handleNumbers:e.handleNumbers}),r=S("mouseout",document.documentElement,E,{handleNumbers:e.handleNumbers});if(document.documentElement.noUiListeners=n.concat(a,r),t.cursor){document.body.style.cursor=getComputedStyle(t.target).cursor,et.length>1&&l(at,o.cssClasses.drag);var s=function(){return!1};document.body.noUiListener=s,document.body.addEventListener("selectstart",s,!1)}e.handleNumbers.forEach(function(t){M("start",t)})}function U(t){t.stopPropagation();var e=b(t.calcPoint),i=x(e);return i===!1?!1:(o.events.snap||a(at,o.cssClasses.tap,o.animationDuration),V(i,e,!0,!0),G(),M("slide",i,!0),M("set",i,!0),M("change",i,!0),M("update",i,!0),void(o.events.snap&&k(t,{handleNumbers:[i]})))}function O(t){var e=b(t.calcPoint),i=ct.getStep(e),n=ct.fromStepping(i);Object.keys(ht).forEach(function(t){"hover"===t.split(".")[0]&&ht[t].forEach(function(t){t.call(nt,n)})})}function F(t){t.fixed||et.forEach(function(t,e){S(ot.start,t.children[0],k,{handleNumbers:[e]})}),t.tap&&S(ot.start,tt,U,{}),t.hover&&S(ot.move,tt,O,{hover:!0}),t.drag&&it.forEach(function(e,i){if(e!==!1&&0!==i&&i!==it.length-1){var n=et[i-1],a=et[i],r=[e];l(e,o.cssClasses.draggable),t.fixed&&(r.push(n.children[0]),r.push(a.children[0])),r.forEach(function(t){S(ot.start,t,k,{handles:[n,a],handleNumbers:[i-1,i]})})}})}function N(t,e,i,n,a){return et.length>1&&(n&&e>0&&(i=Math.max(i,t[e-1]+o.margin)),a&&e<et.length-1&&(i=Math.min(i,t[e+1]-o.margin))),et.length>1&&o.limit&&(n&&e>0&&(i=Math.min(i,t[e-1]+o.limit)),a&&e<et.length-1&&(i=Math.max(i,t[e+1]-o.limit))),i=ct.getStep(i),i=r(i),i===t[e]?!1:i}function R(t){return t+"%"}function z(t,e){rt[t]=e,lt[t]=ct.fromStepping(e);var i=function(){et[t].style[o.style]=R(e),W(t),W(t+1)};window.requestAnimationFrame&&o.useRequestAnimationFrame?window.requestAnimationFrame(i):i()}function G(){st.forEach(function(t){var e=rt[t]>50?-1:1,i=3+(et.length+e*t);et[t].childNodes[0].style.zIndex=i})}function V(t,e,i,n){return e=N(rt,t,e,i,n),e===!1?!1:(z(t,e),!0)}function W(t){if(it[t]){var e=0,i=100;0!==t&&(e=rt[t-1]),t!==it.length-1&&(i=rt[t]),it[t].style[o.style]=R(e),it[t].style[o.styleOposite]=R(100-i)}}function H(t,e){null!==t&&t!==!1&&("number"==typeof t&&(t=String(t)),t=o.format.from(t),t===!1||isNaN(t)||V(e,ct.toStepping(t),!1,!1))}function $(t,e){var i=s(t),n=void 0===rt[0];e=void 0===e?!0:!!e,i.forEach(H),o.animate&&!n&&a(at,o.cssClasses.tap,o.animationDuration),st.forEach(function(t){V(t,rt[t],!0,!1)}),G(),st.forEach(function(t){M("update",t),null!==i[t]&&e&&M("set",t)})}function J(t){$(o.start,t)}function j(){var t=lt.map(o.format.to);return 1===t.length?t[0]:t}function K(){for(var t in o.cssClasses)o.cssClasses.hasOwnProperty(t)&&h(at,o.cssClasses[t]);for(;at.firstChild;)at.removeChild(at.firstChild);delete at.noUiSlider}function Q(){return rt.map(function(t,e){var i=ct.getNearbySteps(t),n=lt[e],o=i.thisStep.step,a=null;o!==!1&&n+o>i.stepAfter.startValue&&(o=i.stepAfter.startValue-n),a=n>i.thisStep.startValue?i.thisStep.step:i.stepBefore.step===!1?!1:n-i.stepBefore.highestStep,100===t?o=null:0===t&&(a=null);var r=ct.countStepDecimals();return null!==o&&o!==!1&&(o=Number(o.toFixed(r))),null!==a&&a!==!1&&(a=Number(a.toFixed(r))),[a,o]})}function q(t,e){ht[t]=ht[t]||[],ht[t].push(e),"update"===t.split(".")[0]&&et.forEach(function(t,e){M("update",e)})}function Y(t){var e=t&&t.split(".")[0],i=e&&t.substring(e.length);Object.keys(ht).forEach(function(t){var n=t.split(".")[0],o=t.substring(n.length);e&&e!==n||i&&i!==o||delete ht[t]})}function X(t,e){var i=j(),n=["margin","limit","range","animate","snap","step","format"];n.forEach(function(e){void 0!==t[e]&&(c[e]=t[e])});var a=Z(c);n.forEach(function(e){void 0!==t[e]&&(o[e]=a[e])}),a.spectrum.direction=ct.direction,ct=a.spectrum,o.margin=a.margin,o.limit=a.limit,rt=[],$(t.start||i,e)}var tt,et,it,nt,ot=m(),at=i,rt=[],st=[],ct=o.spectrum,lt=[],ht={};
if(at.noUiSlider)throw new Error("Slider was already initialized.");return _(at),g(o.connect,tt),nt={destroy:K,steps:Q,on:q,off:Y,get:j,set:$,reset:J,__moveHandles:function(t,e,i){D(t,e,rt,i)},options:c,updateOptions:X,target:at,pips:P},F(o.events),$(o.start),o.pips&&P(o.pips),o.tooltips&&y(),nt}function W(t,e){if(!t.nodeName)throw new Error("noUiSlider.create requires a single element.");var i=Z(e,t),n=V(t,i,e);return t.noUiSlider=n,n}w.prototype.getMargin=function(t){var e=this.xNumSteps[0];if(e&&t%e)throw new Error("noUiSlider: 'limit' and 'margin' must be divisible by step.");return 2===this.xPct.length?f(this.xVal,t):!1},w.prototype.toStepping=function(t){return t=y(this.xVal,this.xPct,t)},w.prototype.fromStepping=function(t){return A(this.xVal,this.xPct,t)},w.prototype.getStep=function(t){return t=C(this.xPct,this.xSteps,this.snap,t)},w.prototype.getNearbySteps=function(t){var e=v(t,this.xPct);return{stepBefore:{startValue:this.xVal[e-2],step:this.xNumSteps[e-2],highestStep:this.xHighestCompleteStep[e-2]},thisStep:{startValue:this.xVal[e-1],step:this.xNumSteps[e-1],highestStep:this.xHighestCompleteStep[e-1]},stepAfter:{startValue:this.xVal[e-0],step:this.xNumSteps[e-0],highestStep:this.xHighestCompleteStep[e-0]}}},w.prototype.countStepDecimals=function(){var t=this.xNumSteps.map(c);return Math.max.apply(null,t)},w.prototype.convert=function(t){return this.getStep(this.toStepping(t))};var H={to:function(t){return void 0!==t&&t.toFixed(2)},from:Number};return{create:W}});var Common;!function(t){var e=function(){function t(){}return t.getLast=function(t,e,i){for(var n,o=!0,a=i;o;){var r=a+1,s=this.findByNo(t,e,a),c=this.findByNo(t,e,r),l=null!=c;if(l){var h=s.offset().top,d=c.offset().top;d>h&&(n=s,o=!1)}else n=s,o=!1;a++}return n},t.findByNo=function(t,e,i){var n=null;return t.find("."+e).toArray().forEach(function(t){var e=$(t);parseInt(e.data("no"))===i&&(n=e)}),n},t}();t.LastItem=e}(Common||(Common={}));var Common;!function(t){var e=function(){function t(){}return t.africa=["DZ","AO","BJ","BW","BF","BI","CM","CV","CF","TD","KM","CG","DJ","EG","GQ","ER","ET","GA","GM","GH","GW","GN","CI","KE","LS","LR","LY","MG","MW","ML","MR","MU","MA","MZ","NA","NE","NG","RW","ST","SN","SC","SL","SO","ZA","SD","SZ","TG","TN","UG","ZM","TZ","ZW","SS","CD"],t.europe=["AL","AD","AT","BY","BE","BA","BG","HR","CY","CZ","DK","EE","FO","FI","FR","DE","GR","HU","IS","IE","IT","LV","LI","LT","LU","MK","MT","MD","MC","NL","NO","PL","PT","RO","RU","SM","RS","SK","SI","ES","SE","CH","UA","GB","ME"],t.asia=["AF","AM","AZ","BH","BD","BT","BN","KH","CN","GE","IN","ID","IR","IQ","IL","JP","JO","KZ","KP","KR","KW","KG","LA","LB","MY","MV","MN","MM","NP","OM","PK","PH","QA","SA","SG","LK","SY","TJ","TH","TR","TM","AE","UZ","VN","YE"],t.austraila=["AU","FJ","KI","MH","FM","NR","NZ","PW","PG","SB","TO","TV","VU","WS","TL"],t.northAmerica=["AG","BS","BB","BZ","CA","CR","CU","DM","DO","SV","GT","HT","HN","JM","MX","NI","PA","KN","LC","VC","TT","US"],t.southAmerica=["AR","BO","BR","CL","CO","EC","GY","PY","PE","SR","UY","VE"],t.eu=["BE","BG","CZ","DK","DE","EE","IE","EL","ES","FR","HR","IT","CY","LV","LT","LU","HU","MT","NL","AT","PL","PT","RO","SI","SK","FI","SE","UK"],t.us=["AK","AL","AR","AZ","CA","CO","CT","DC","DE","FL","GA","GU","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MH","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","PR","PW","RI","SC","SD","TN","TX","UT","VA","VI","VT","WA","WI","WV","WY"],t}();t.CountriesGroup=e}(Common||(Common={}));var Common;!function(t){var e=function(){function t(t,e){var i=this;void 0===e&&(e=!1),this.$root=t,this.$checker=this.$root.find(".checker"),this.setChecker(e),this.$root.click(function(e){var n=!i.isChecked();i.setChecker(n),i.onChange&&i.onChange(t.attr("id"),n)})}return t.prototype.isChecked=function(){return this.$checker.hasClass("icon-checkmark")},t.prototype.setChecker=function(t){this.$checker.removeClass("icon-checkmark"),this.$checker.removeClass("icon-checkmark2"),t?this.$checker.addClass("icon-checkmark"):this.$checker.addClass("icon-checkmark2")},t}();t.CustomCheckbox=e}(Common||(Common={}));var Views;!function(t){var e=function(){function e(){}return e.registerLocationCombo=function(e,i){void 0===i&&(i=null);var n=new Common.PlaceSearchConfig;n.providers="2",n.minCharsToSearch=1,n.clearAfterSearch=!1,n.selOjb=e;var o=new Common.PlaceSearchBox(n);return e.change(function(e,n,o){var a={gid:o.SourceId};t.ViewBase.currentView.apiPut("DealsCurrentLocation",a,function(t){i(o)})}),o},e}();t.AirLoc=e}(Views||(Views={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Planning;!function(t){var e=function(){function e(){this.$root=$(".filtering"),this.$locRoot=this.$root.find(".locations"),this.activeCls="active",this.currentStarsCnt=5,this.currentLevel=ScoreLevel.Excellent,this.$levels=this.$root.find(".levels"),this.$l5=this.$levels.find(".lev5"),this.$l3=this.$levels.find(".lev3"),this.$l1=this.$levels.find(".lev1")}return e.prototype.init=function(t,e){this.genLocations(t,e),this.initLevels()},e.prototype.getStateBase=function(){var t=this.$locRoot.find("."+this.activeCls);return{grouping:t.data("type"),starsLevel:this.currentStarsCnt,currentLevel:this.currentLevel}},e.prototype.stateChanged=function(){this.onFilterChanged&&this.onFilterChanged()},e.prototype.getLocsData=function(e){var i=_.map(e,function(e){var i={icon:"",txt:"",type:e};return e===t.LocationGrouping.ByCity&&(i.icon="city",i.txt="By city"),e===t.LocationGrouping.ByCountry&&(i.icon="country",i.txt="By country"),e===t.LocationGrouping.ByContinent&&(i.icon="continent",i.txt="By continent"),i});return i},e.prototype.genLocations=function(t,e){var i=this,n=this.getLocsData(t),o=Common.ListGenerator.init(this.$locRoot,"filter-location-template");o.activeItem=function(t){var n={cls:i.activeCls,isActive:!1};return t.type===e&&(n.isActive=!0),n},o.evnt(null,function(t,e,n,o){i.$locRoot.children().removeClass(i.activeCls),e.addClass(i.activeCls),i.stateChanged()}),o.generateList(n)},e.prototype.initLevels=function(){var t=this,e=this.$root.find(".level");e.mouseenter(function(i){e.removeClass("active");var n=$(i.delegateTarget);n.hasClass("lev5")&&t.levelsHover(5),n.hasClass("lev3")&&t.levelsHover(3),n.hasClass("lev1")&&t.levelsHover(1)}),e.mouseleave(function(i){e.removeClass("active"),t.levelsHover(t.currentStarsCnt)}),e.click(function(e){var i=$(e.delegateTarget),n=i.data("s");t.currentStarsCnt=n,5===n&&(t.currentLevel=ScoreLevel.Excellent),3===n&&(t.currentLevel=ScoreLevel.Good),1===n&&(t.currentLevel=ScoreLevel.Standard),t.stateChanged()})},e.prototype.levelsHover=function(t){this.$l5.addClass("active"),3>=t&&this.$l3.addClass("active"),1>=t&&this.$l1.addClass("active")},e}();t.Filtering=e;var i=function(t){function e(){t.apply(this,arguments),this.fromDays=1,this.toDays=20}return __extends(e,t),e.prototype.initA=function(t,e){this.init(t,e)},e.prototype.daysRangeChanged=function(t,e){this.fromDays=t,this.toDays=e,this.onFilterChanged()},e}(e);t.FilteringAnytime=i;var n=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.initW=function(t,e,i){var n=this,a=Views.ViewBase.currentView.registerTemplate("filtering-weekend-template"),r=this.$root.find(".sec-line");r.html(a()),this.init(t,e),this.daysFilter=new o(r.find("#cbUseDaysFilter"),r.find(".days-filter")),this.daysFilter.onFilterChange=function(){n.stateChanged()},this.daysFilter.init(i)},e.prototype.getState=function(){var t=this.getStateBase(),e=null;this.daysFilter.cbUse.isChecked()&&(e=this.daysFilter.getActItems());var i={days:e},n=$.extend(t,i);return n},e}(e);t.FilteringWeekend=n;var o=function(){function t(t,e){this.enabled=!1,this.focusTimeoutId=null,this.$cbCont=t,this.$filterCont=e}return t.prototype.init=function(t){this.initCb(t),this.initSelect()},t.prototype.initCb=function(t){var e=this;this.cbUse=new Common.CustomCheckbox(this.$cbCont,t),this.cbUse.onChange=function(){var t=e.cbUse.isChecked();e.setEnabled(t),e.change()},this.setEnabled(t)},t.prototype.setEnabled=function(t){this.enabled=t;var e=this.$filterCont;t?(e.addClass("enabled"),e.removeClass("disabled")):(e.removeClass("enabled"),e.addClass("disabled"))},t.prototype.initSelect=function(){var t=this,e=[{ni:4,name:"Thu"},{ni:5,name:"Fri"},{ni:6,name:"Sat",c:"perm-sel"},{ni:7,name:"Sun"},{ni:1,name:"Mon"}],i=Common.ListGenerator.init(this.$filterCont.find(".ftbl"),"weekend-day-selector-template");i.onItemAppended=function(t,e){5!==e.ni&&7!==e.ni||t.find(".day").addClass("act")},i.evnt(".day",function(e,i,n,o){t.itemClicked(o.ni)}),i.evnt(".day",function(e,i,n,o){t.focusTimeoutId&&(clearTimeout(t.focusTimeoutId),t.focusTimeoutId=null),t.showFocus(o.ni)}).setEvent("mouseenter"),i.evnt(".day",function(e,i,n,o){t.focusTimeoutId=setTimeout(function(){t.focusTimeoutId=null,t.unsetFocus(null)},200)}).setEvent("mouseleave"),i.generateList(e)},t.prototype.removeActNo=function(t){var e=this.getItemByNo(t);e.removeClass("act")},t.prototype.addActNo=function(t){var e=this.getItemByNo(t);e.addClass("act")},t.prototype.itemClicked=function(t){if(this.enabled){var e=this.getItemByNo(t),i=e.hasClass("act");4===t&&this.remAdd(i?[4]:null,i?null:[4,5]),5===t&&this.remAdd(i?[4,5]:null,i?null:[5]),7===t&&this.remAdd(i?[7,1]:null,i?null:[7]),1===t&&this.remAdd(i?[1]:null,i?null:[7,1]),this.change()}},t.prototype.change=function(){this.onFilterChange&&this.onFilterChange()},t.prototype.remAdd=function(t,e){var i=this;t&&t.forEach(function(t){i.removeActNo(t)}),e&&e.forEach(function(t){i.addActNo(t)})},t.prototype.getActItems=function(){var t=this.$filterCont.find(".act").toArray(),e=_.map(t,function(t){return parseInt($(t).data("i"))}),i=6;_.contains(e,5)&&(i=5),_.contains(e,4)&&(i=4);var n=6;return _.contains(e,7)&&(n=7),_.contains(e,1)&&(n=1),{from:i,to:n}},t.prototype.showFocus=function(t){var e=this;if(this.enabled){var i=[];4===t&&(i=[4,5]),5===t&&(i=[5]),7===t&&(i=[7]),1===t&&(i=[7,1]),this.unsetFocus(null),i.forEach(function(t){e.setFocus(t)})}},t.prototype.unsetFocus=function(t){if(t){var e=this.getItemByNo(t);e.removeClass("foc")}else this.$filterCont.find(".day").removeClass("foc")},t.prototype.setFocus=function(t){var e=this.getItemByNo(t);e.addClass("foc")},t.prototype.getItemByNo=function(t){var e=this.$filterCont.find('[data-i="'+t+'"]');return e},t}();t.DaysFilter=o}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t,e){this.res={Excellent:0,Good:0,Standard:0},this.timeType=t,this.queries=e}return e.prototype.countDeals=function(){var e=this;t.FlightsExtractor.f(this.queries,function(i,n,o){var a=t.AnytimeAggUtils.getScoreStars(i.score);e.incCategory(a)})},e.prototype.incCategory=function(t){t>=4?this.res.Excellent++:t>=2?this.res.Good++:this.res.Standard++},e.prototype.dispayDeals=function(){this.countDeals(),$("#delasEx").html(this.res.Excellent),$("#delasGo").html(this.res.Good),$("#delasSt").html(this.res.Standard)},e}();t.DelasEval=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){}return t.f=function(t,e){t.forEach(function(t){t.results.forEach(function(i){i.fs.forEach(function(n){e(n,i,t)})})})},t.r=function(t,e){t.forEach(function(t){t.results.forEach(function(i){e(i,t)})})},t.getResults=function(t){var e=[];return this.r(t,function(t){e.push(t)}),e},t}();t.FlightsExtractor=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t,e){this.pairs=e,this.$cont=t}return t.prototype.init=function(){var t=this,e=Common.ListGenerator.init(this.$cont,"air-pair-item-template");e.activeItem=function(t){return{isActive:!0,cls:"active"}},e.evnt(null,function(e,i,n,o){i.toggleClass("active"),t.onChange&&t.onChange()}),e.generateList(this.pairs)},t.prototype.getActive=function(){var t=[],e=this.$cont.find(".pair").toArray();return e.forEach(function(e){var i=$(e);i.hasClass("active")&&t.push({from:i.data("f"),to:i.data("t")})}),t},t.toString=function(t){return t.from+"-"+t.to},t}();t.AirportSelector=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t){this.actCls="active",this.$comp=$('<div class="months-filter"></div>'),t.html(this.$comp)}return t.prototype.gen=function(t){var e=this,i=this.getItems(t),n=_.first(i);this.year=n.year,this.month=n.month;var o=Common.ListGenerator.init(this.$comp,"month-item-filter-template");o.evnt(null,function(t,i,n,o){e.month=o.month,e.year=o.year,e.$comp.find(".month").removeClass(e.actCls),i.addClass(e.actCls),e.change()});var a=!0;o.activeItem=function(t){var e={cls:"active",isActive:a};return a=!1,e},o.generateList(i)},t.prototype.change=function(){this.onChange&&this.onChange()},t.prototype.getItems=function(t){for(var e=new Date,i=[],n=0;t-1>=n;n++){var o=moment(e).add(n,"months"),a=o.format("MMMM YY"),r={txt:a,month:o.month()+1,year:o.year()};i.push(r)}return i},t}();t.MonthsSelector=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t,e){this.delayedReturn=new Common.DelayedReturn,this.$cont=t,this.id=e}return t.prototype.getRange=function(){return{from:parseInt(this.$from.val()),to:parseInt(this.$to.val())}},t.prototype.rangeChanged=function(t,e){var i=this;this.onRangeChanged&&this.delayedReturn.receive(function(){i.onRangeChanged(t,e)})},t.prototype.setVals=function(t,e){this.slider.set([t,e]),this.$from.val(t),this.$to.val(e)},t.prototype.genSlider=function(t,e){var i=this,n=Views.ViewBase.currentView.registerTemplate("range-slider-template"),o={id:this.id},a=$(n(o));this.$cont.html(a);var r=a.find("#"+this.id)[0];this.$from=$("#"+this.id+"_from"),this.$to=$("#"+this.id+"_to"),this.$from.val(t),this.$to.val(e),this.slider=noUiSlider.create(r,{start:[t+1,e-1],connect:!0,step:1,range:{min:t,max:e}});var s=new Common.DelayedCallback(this.$from);s.delay=500,s.callback=function(e){var n=e;t>e&&(n=t,i.$from.val(n)),i.slider.set([n,null]),i.rangeChanged(n,i.$to.val())};var c=new Common.DelayedCallback(this.$to);c.delay=500,c.callback=function(t){var n=t;t>e&&(n=e,i.$to.val(n)),i.slider.set([null,n]),i.rangeChanged(i.$from.val(),n)},this.slider.on("slide",function(t){var e=parseInt(t[0]),n=parseInt(t[1]);i.$from.val(e),i.$to.val(n),i.rangeChanged(e,n)})},t}();t.RangeSlider=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t,e){this.delayedReturn=new Common.DelayedReturn,this.$cont=t,this.id=e}return t.prototype.genSlider=function(){var t=this,e=Views.ViewBase.currentView.registerTemplate("time-slider-template"),i=0,n=96,o={id:this.id},a=$(e(o));this.$cont.html(a);var r=a.find("#"+this.id)[0];this.$from=$("#"+this.id+"_from"),this.$to=$("#"+this.id+"_to"),this.$from.val(i),this.$to.val(n),this.display(i,n);var s=noUiSlider.create(r,{start:[i,n],connect:!0,step:1,range:{min:i,max:n}});s.on("slide",function(e){var i=parseInt(e[0]),n=parseInt(e[1]);t.display(i,n),t.rangeChanged(15*i,15*n)})},t.prototype.display=function(t,e){this.$from.html(this.toTime(t)),this.$to.html(this.toTime(e))},t.prototype.toTime=function(t){var e=15*t,i=Math.floor(e/60),n=e%60,o=this.zero(i)+":"+this.zero(n);return o},t.prototype.zero=function(t){return 1===t.toString().length?"0"+t:t},t.prototype.rangeChanged=function(t,e){var i=this;this.onRangeChanged&&this.delayedReturn.receive(function(){i.onRangeChanged(t,e)})},t}();t.TimeSlider=e}(Planning||(Planning={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Views;!function(t){var e=function(e){function i(){e.call(this),this.$cont=$("#resultsCont"),this.$filter=$("#filterCont"),this.initialize()}return __extends(i,e),i.prototype.showAirsFirst=function(){var t=new Common.InfoDialog;t.create("No airports","Location and airports must be selected first")},Object.defineProperty(i.prototype,"hasAirs",{get:function(){return this.locDlg.hasAirports()},enumerable:!0,configurable:!0}),i.prototype.initialize=function(){var e=this;this.resultsEngine=new Planning.ResultsManager(this),this.resultsEngine.onDrawQueue=function(){var t=new Planning.QueueVisualize;any(e.resultsEngine.queue)?t.draw(e.resultsEngine.timeType,e.resultsEngine.queue):t.hide()},this.resultsEngine.onResultsChanged=function(t){e.currentSetter.setQueries(t);var i=new Planning.DelasEval(e.resultsEngine.timeType,t);i.dispayDeals()},this.planningMap=new Planning.PlanningMap(this),this.planningMap.onMapLoaded=function(){e.changeSetter(PlanningType.Anytime)},this.planningMap.onSelectionChanged=function(t,i,n){var o=e.currentSetter.getCustomId();e.resultsEngine.selectionChanged(t,i,n,o)},this.planningMap.init(),this.mapSwitch(function(t){e.planningMap.changeViewType(t)}),this.locDlg=new t.LocationSettingsDialog(this),this.initTabs()},i.prototype.enableMap=function(t){var e=$("#mapDisabler");t?e.removeClass("map-disabled"):e.addClass("map-disabled")},i.prototype.mapSwitch=function(t){var e=this,i=$(".map-type-switch"),n=i.find(".btn");n.click(function(i){var o=$(i.target),a=o.hasClass("country")?FlightCacheRecordType.Country:FlightCacheRecordType.City;a!==e.planningMap.viewType&&(n.removeClass("active"),o.addClass("active"),t(a))})},i.prototype.initTabs=function(){var t=this;this.tabs=new Common.Tabs($("#naviCont"),"main"),this.tabs.initCall=!1,this.tabs.onBeforeSwitch=function(){t.enableMap(!0),t.$cont.empty(),t.$filter.empty()},this.tabs.addTab("tabAnytime","All deals",function(){t.changeSetter(PlanningType.Anytime)}),this.tabs.addTab("tabWeekend","Weekend deals",function(){t.changeSetter(PlanningType.Weekend)}),this.tabs.addTab("tabCustom","Long term search",function(){t.changeSetter(PlanningType.Custom)}),this.tabs.addTab("tabClassic","Classic search",function(){}),this.tabs.create()},i.prototype.changeSetter=function(t){var e=this;$("#tabContent").empty(),t===PlanningType.Anytime&&(this.currentSetter=new Planning.AnytimePageSetter(this)),t===PlanningType.Weekend&&(this.currentSetter=new Planning.WeekendPageSetter(this)),t===PlanningType.Custom&&(this.currentSetter=new Planning.CustomPageSetter(this)),this.currentSetter.init(function(){e.planningMap.loadCategory(t);var i=e.currentSetter.getCustomId();e.resultsEngine.initalCall(t,i)})},i}(t.ViewBase);t.FlyView=e}(Views||(Views={}));var Trip;!function(t){var e=function(){function t(){this.clearAfterSelection=!1}return t}();t.AirportComboConfig=e;var i=function(){function t(t,i){void 0===i&&(i=new e),this.limit=8,this.config=i,this.$combo=$("#"+t),this.$cont=this.$combo.find("ul"),this.$input=this.$combo.find("input"),this.registerInput(),this.registerInOut()}return t.prototype.setText=function(t){this.lastText=t,this.$input.val(t)},t.prototype.registerInOut=function(){var t=this;this.$input.focus(function(t){$(t.target).val("")}),this.$input.focusout(function(){t.setText(t.lastText)})},t.prototype.registerInput=function(){var t=this,e=new Common.DelayedCallback(this.$input);e.callback=function(e){var i=[["query",e],["limit",t.limit]];Views.ViewBase.currentView.apiGet("airport",i,function(e){return t.onResult(e)})}},t.prototype.onResult=function(t){this.displayResults(t)},t.prototype.displayResults=function(t){var e=this;return this.$cont.html(""),t?(this.$cont.show(),t.forEach(function(t){var i=e.getItemHtml(t);e.$cont.append(i)}),void this.registerClick()):void this.$cont.hide()},t.prototype.registerClick=function(){var t=this;this.$cont.find("li").click(function(e){var i=$(e.target);t.onClick(i)})},t.prototype.onClick=function(t){var e=t.data("value"),i=t.data("id");this.config.clearAfterSelection?this.$input.val(""):this.$input.val(e),this.$cont.html("");var n={id:i,name:e};this.onSelected(n)},t.prototype.getItemHtml=function(t){var e=t.iataFaa;""===e&&(e=t.icao);var i=t.name+" ("+t.city+")",n=t.city+" ("+e+")";return'<li data-value="'+n+'" data-id="'+t.id+'">'+i+" - "+e+"</li>"},t}();t.AirportCombo=i}(Trip||(Trip={}));var Views;!function(t){var e=function(){function e(e){var i=this;this.airTemplate=t.ViewBase.currentView.registerTemplate("homeAirportItem-template"),this.kmRangeSelected=200,this.v=e,t.AirLoc.registerLocationCombo($("#currentCity"),function(t){$("#rangeBlock").removeClass("hidden"),$(".home-location-name").html(t.City+", ("+t.CountryCode+")")}),this.regRangeCombo(),this.$airportsCont=$("#airportsCont"),this.$airContS=$(".top-ribbon .airports"),this.initAirports(),this.loadMgmtAirports(),$(".top-ribbon .edit").click(function(t){t.preventDefault(),$(".location-dialog").toggleClass("hidden"),i.hideRefresh()}),$("#airClose").click(function(t){t.preventDefault(),$(".location-dialog").addClass("hidden"),i.hideRefresh()}),$("#refreshResults").click(function(t){t.preventDefault(),i.v.resultsEngine.refresh(),i.hideRefresh()})}return e.prototype.hideRefresh=function(){$(".refresh-line").addClass("hidden")},e.prototype.changed=function(){var t=this.v.planningMap.map.anySelected();t&&$(".refresh-line").removeClass("hidden"),this.hasAirports()&&$(".no-airs-info").hide()},e.prototype.loadMgmtAirports=function(){var t=this;this.v.apiGet("airportRange",null,function(e){t.generateAirports(e)})},e.prototype.initAirports=function(){var t=this,e=new Trip.AirportCombo("airportCombo",{clearAfterSelection:!0});e.onSelected=function(e){var i={airportId:e.id};t.v.apiPost("airportRange",i,function(e){t.genAirport(e),t.genAirportS(e.airCode),t.changed()})}},e.prototype.hasAirports=function(){return $("#airportsCont").find(".airport").length>0},e.prototype.regRangeCombo=function(){var t=this,e=$("#airportsRange");e.change(function(i){var n=parseInt(e.find("input").val());t.kmRangeSelected=n}),$("#addAirsRange").click(function(e){e.preventDefault(),t.callAirportsByRange()})},e.prototype.callAirportsByRange=function(){var t=this,e={distance:this.kmRangeSelected};this.v.apiPut("AirportRange",e,function(e){t.generateAirports(e),t.changed()})},e.prototype.generateAirports=function(t){var e=this;this.$airportsCont.find(".airport").remove(),this.$airContS.empty(),t.forEach(function(t){e.genAirport(t),e.genAirportS(t.airCode)})},e.prototype.genAirportS=function(t){var e=$('<span id="s_'+t+'" class="airport">'+t+"</span>");this.$airContS.append(e)},e.prototype.genAirport=function(e){var i=this,n={id:e.origId,city:e.city,airCode:e.airCode,airName:e.airName},o=$(this.airTemplate(n));o.find(".delete").click(function(e){var n=$(e.target).parent(),o=n.attr("id"),a=n.data("code"),r=[["id",o]];t.ViewBase.currentView.apiDelete("AirportRange",r,function(t){$("#"+o).remove(),$("#s_"+a).remove(),i.changed()})}),this.$airportsCont.prepend(o)},e}();t.LocationSettingsDialog=e}(Views||(Views={}));var TravelB;!function(t){var e=function(){function t(){}return t.myDateToStr=function(t){return t.Day+"."+t.Month+"."+t.Year},t.myDateToTrans=function(t){return t.Day+"_"+t.Month+"_"+t.Year},t.myDateToJsDate=function(t){return new Date(t.Year,t.Month-1,t.Day)},t.myDateToMomentDate=function(t){return t?moment([t.Year,t.Month-1,t.Day]):null},t.momentDateToTrans=function(t){return t.date()+"_"+(t.month()+1)+"_"+t.year()},t.momentDateToMyDate=function(t){return t?{Year:t.year(),Month:t.month()+1,Day:t.date()}:null},t.jsDateToMyDate=function(t){return{Year:t.getFullYear(),Month:t.getMonth()+1,Day:t.getDate()}},t}();t.DateUtils=e}(TravelB||(TravelB={}));var Planning;!function(t){var e=function(){function t(){}return t.mapOptions={zoom:3,maxZoom:19,minZoom:3,maxBounds:L.latLngBounds(L.latLng(-85,-180),L.latLng(85,180)),zoomControl:!1,center:[34.5133,-94.1629]},t.tileOptions={noWrap:!0},t.unselCountryStyle={color:"#9096a0",weight:1,opacity:1,fillColor:"#005476",fillOpacity:1},t.selCountryStyle={color:"#9096a0",weight:1,opacity:1,fillColor:"#3DA243",fillOpacity:1},t.hoverStyle={fillColor:"#F56E12",fillOpacity:1},t}();t.MapConstants=e;var i=function(){function e(t){this.planningMap=t}return e.prototype.anySelected=function(){var t=_.find(this.mapCities.cities,function(t){return t.selected});return t||any(this.mapCountries.selectedCountries)},e.prototype.init=function(){var e=this;this.mapCities=new t.MapCities(this),this.mapCountries=new t.MapCountries(this),this.mapCountries.init(function(){e.onMapLoaded()})},e.prototype["switch"]=function(t){if(t===FlightCacheRecordType.Country&&(this.mapCountries.show(),this.mapCities.hide(),this.mapCities.position)){var e=this.mapCities.position.getPos();this.mapCountries.position.setPos(e)}if(t===FlightCacheRecordType.City){var i=this.mapCountries.position.getPos();this.mapCountries.hide(),this.mapCities.show(),this.mapCities.position.setPos(i)}},e.prototype.countrySelChanged=function(t,e){this.onCountryChange&&this.onCountryChange(t,e)},e}();t.Map=i}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t){this.mapObj=t}return t.prototype.setPos=function(t){this.mapObj.setZoom(t.z,{animate:!1}),this.mapObj.panTo(t.c,{animate:!1})},t.prototype.getPos=function(){var t=this.mapObj.getCenter(),e=this.mapObj.getZoom();return{c:t,z:e}},t}();t.MapPosition=e;var i=function(){function i(t){this.citiesToMarkers=[],this.cities=[],this.$map=$("#mapCities"),this.inited=!1,this.map=t}return i.prototype.show=function(){this.$map.show(),this.inited||(this.init(),this.inited=!0,this.initCities())},i.prototype.hide=function(){this.$map.hide()},i.prototype.init=function(){this.mapObj=L.map("mapCities",t.MapConstants.mapOptions),this.position=new e(this.mapObj),this.createMapboxLayer(),this.citiesLayerGroup=L.layerGroup(),this.mapObj.addLayer(this.citiesLayerGroup)},i.prototype.initCities=function(){this.loadCitiesInRange(),this.callToLoadCities()},i.prototype.createMapboxLayer=function(){var e="https://api.mapbox.com/styles/v1/gloobster/civo64vmw004i2kqkwpcocjyp/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZ2xvb2JzdGVyIiwiYSI6ImQxZWY5MjRkZjU1NDk2MGU3OWI2OGRiM2U3NTM0MGYxIn0.nCG7hOsSQzb0c-_qzfTCRQ";this.tileLayer=L.tileLayer(e,t.MapConstants.tileOptions),this.mapObj.addLayer(this.tileLayer)},i.prototype.getPopulationFromZoom=function(t){return 3>t?2e6:3===t?8e5:4===t?6e5:5===t?4e5:6===t?2e5:7===t?5e4:1},i.prototype.callToLoadCities=function(){var t=this,e=this.mapObj.getBounds(),i=this.mapObj.getZoom(),n=this.getPopulationFromZoom(i),o=this.map.planningMap.v.currentSetter.getCustomId(),a=[["latSouth",e._southWest.lat],["lngWest",e._southWest.lng],["latNorth",e._northEast.lat],["lngEast",e._northEast.lng],["minPopulation",n.toString()],["planningType",this.map.planningMap.planningType.toString()],["customId",o]];Views.ViewBase.currentView.apiGet("airportGroup",a,function(e){t.createCities(e)})},i.prototype.createCities=function(t){var e=this;this.cities=t,this.citiesToMarkers=[],this.citiesLayerGroup&&this.citiesLayerGroup.clearLayers(),t.forEach(function(t){e.createCity(t)})},i.prototype.createCity=function(t){var e=this,i=t.selected?n.selected:n["default"],o=L.marker([t.coord.Lat,t.coord.Lng],{icon:i});return o.selected=t.selected,o.gid=t.gid,o.on("mouseover",function(t){t.target.setIcon(n.focus)}),o.on("mouseout",function(t){t.target.selected?t.target.setIcon(n.selected):t.target.setIcon(n["default"])}),o.on("click",function(t){e.cityClicked(t)}),o.addTo(this.citiesLayerGroup),o},i.prototype.cityClicked=function(t){return this.map.planningMap.v.hasAirs?(t.target.setIcon(n.selected),t.target.selected=!t.target.selected,void this.map.onCityChange(t.target.gid,t.target.selected)):void this.map.planningMap.v.showAirsFirst()},i.prototype.loadCitiesInRange=function(){var t=this;this.delayedCallback=new o,this.delayedCallback.callback=function(){t.callToLoadCities()},this.mapObj.on("zoomend",function(e){t.delayedCallback.receiveEvent()}),this.mapObj.on("moveend",function(e){t.delayedCallback.receiveEvent()})},i}();t.MapCities=i;var n=function(){function t(){}return t.basePath="../../images/n/map-icons/",t["default"]=L.icon({iconUrl:t.basePath+"default.svg",iconSize:[16,16],iconAnchor:[8,8]}),t.selected=L.icon({iconUrl:t.basePath+"selected.svg",iconSize:[16,16],iconAnchor:[8,8]}),t.focus=L.icon({iconUrl:t.basePath+"focus.svg",iconSize:[20,20],iconAnchor:[10,10]}),t}();t.MapIcons=n;var o=function(){function t(){this.delay=600,this.timeoutId=null}return t.prototype.receiveEvent=function(){var t=this;this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.timeoutId=setTimeout(function(){t.timeoutId=null,t.callback()},this.delay)},t}();t.DelayedCallbackMap=o}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.$map=$("#mapCountries"),this.selectedCountries=[],this.featureArray=[],this.map=e,this.mapObj=L.map("mapCountries",t.MapConstants.mapOptions),this.position=new t.MapPosition(this.mapObj)}return e.prototype.set=function(e){this.selectedCountries=e,this.featureArray.forEach(function(i){var n=i[0],o=i[1],a=_.contains(e,n);a?o.setStyle(t.MapConstants.selCountryStyle):o.setStyle(t.MapConstants.unselCountryStyle)})},e.prototype.show=function(){this.$map.show()},e.prototype.hide=function(){this.$map.hide()},e.prototype.init=function(t){var e=this;this.getGeoJson(function(){e.createMapboxLayer(),e.createCountries(),t()})},e.prototype.createCountries=function(){var t=this;this.ccsLayerGroup=L.layerGroup(),this.mapObj.addLayer(this.ccsLayerGroup),$(this.countriesData.features).each(function(e,i){t.createMapFeature(i)})},e.prototype.createMapFeature=function(t){var e=t.properties.cc,i=new L.GeoJSON(t,{style:this.getCountryStyle(e)});this.featureArray.push([e,i]),this.regEvnts(i,e),i.addTo(this.ccsLayerGroup)},e.prototype.regEvnts=function(e,i){var n=this;e.on("mouseover",function(e){var i=n.getLayer(e);i.setStyle(t.MapConstants.hoverStyle)}),e.on("mouseout",function(t){var e=n.getLayer(t),o=n.getCountryStyle(i);e.setStyle(o)}),e.on("click",function(t){var e=n.getLayer(t);n.countryClicked(i,e)})},e.prototype.countryClicked=function(t,e){if(!this.map.planningMap.v.hasAirs)return void this.map.planningMap.v.showAirsFirst();var i=this.isCountrySelected(t);i?this.selectedCountries=_.reject(this.selectedCountries,function(e){return e===t}):this.selectedCountries.push(t);var n=this.getCountryStyle(t);e.setStyle(n),this.map.countrySelChanged(t,!i)},e.prototype.createMapboxLayer=function(){var e="https://api.mapbox.com/styles/v1/gloobster/civi2b1wn00a82kpattor5wui/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiZ2xvb2JzdGVyIiwiYSI6ImQxZWY5MjRkZjU1NDk2MGU3OWI2OGRiM2U3NTM0MGYxIn0.nCG7hOsSQzb0c-_qzfTCRQ";this.mapLayer=L.tileLayer(e,t.MapConstants.tileOptions),this.mapObj.addLayer(this.mapLayer);var i="leaflet-top-pane";this.mapboxPane=this.mapObj.createPane(i),this.mapboxPane.appendChild(this.mapLayer.getContainer()),this.mapLayer.setZIndex(5)},e.prototype.getCountryStyle=function(e){return this.isCountrySelected(e)?t.MapConstants.selCountryStyle:t.MapConstants.unselCountryStyle},e.prototype.isCountrySelected=function(t){var e=_.contains(this.selectedCountries,t);return e},e.prototype.getGeoJson=function(t){var e=this;this.countriesData?t():$.ajax({dataType:"json",url:"/geo/custom.geo.json",success:function(i){e.countriesData=i,t()}}).error(function(){alert("error voe")})},e.prototype.getLayer=function(t){var e=t.layer._leaflet_id,i=this.mapObj._layers[e];return i},e}();t.MapCountries=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.v=e,this.create(),this.dataLoader=new t.SearchDataLoader,this.menu=new t.CustomMenu(this.$form.find(".searches-menu"))}return e.prototype.initDaysRange=function(){var e=this;this.slider=new t.RangeSlider(this.$form.find(".days-range-cont"),"daysRange"),this.slider.genSlider(1,21),this.slider.onRangeChanged=function(i,n){var o=new t.PropsDataUpload(e.searchId,"daysRange");o.addVal("from",i),o.addVal("to",n),o.send()}},e.prototype.initDatesClosing=function(){var t=this;this.$form.find("#datesDoneBtn").click(function(e){e.preventDefault(),t.updateStarted(!0,function(){t.setFormState(!0)})}),this.$form.find("#resetDates").click(function(e){e.preventDefault(),t.updateStarted(!1,function(){
t.setFormState(!1)})})},e.prototype.initDateRange=function(){var e=this;({minDate:moment().add(1,"days").toDate()});this.dpDep=new Common.MyCalendar($("#dpDepCont")),this.dpDep.onChange=function(i){e.depDate=i;var n=TravelB.DateUtils.momentDateToMyDate(e.depDate),o=TravelB.DateUtils.myDateToTrans(n),a=new t.PropsDataUpload(e.searchId,"dep");a.setVal(o),a.send()},this.dpArr=new Common.MyCalendar($("#dpArrCont")),this.dpArr.onChange=function(i){e.arrDate=i;var n=TravelB.DateUtils.momentDateToMyDate(e.arrDate),o=TravelB.DateUtils.myDateToTrans(n),a=new t.PropsDataUpload(e.searchId,"arr");a.setVal(o),a.send()}},e.prototype.create=function(){var t=this.v.registerTemplate("custom-template");this.$form=$(t()),$("#tabContent").html(this.$form),this.initShowHide()},e.prototype.initShowHide=function(){var t=this,e=$(".form-cont"),i=this.$form.find(".show-hide");this.setShowHideBtn(e,i,!1),i.click(function(n){n.preventDefault();var o=e.hasClass("hidden");t.setShowHideBtn(e,i,!o)})},e.prototype.setShowHideBtn=function(t,e,i){i?(e.html("show"),t.addClass("hidden")):(e.html("hide"),t.removeClass("hidden"))},e.prototype.initFreq=function(){var t=this,e=[{days:1,text:"Daily"},{days:7,text:"Weekly"},{days:30,text:"Monthly"}],i=this.$form.find(".freq-cont .itbl"),n=Common.ListGenerator.init(i,"freq-item-template");n.evnt(".item",function(e,i,n,o){t.updateFreq(o.days,function(){t.setFreq(o.days)})}),n.generateList(e)},e.prototype.updateStarted=function(e,i){var n=new t.PropsDataUpload(this.searchId,"started");n.setVal(e),n.send(function(){i()})},e.prototype.updateFreq=function(e,i){var n=new t.PropsDataUpload(this.searchId,"freq");n.setVal(e),n.send(function(){i()})},e.prototype.setFreq=function(t){var e=this.$form.find(".freq-cont");e.find(".item").removeClass("active");var i=e.find('[data-d="'+t+'"]');i.addClass("active")},e.prototype.initStandardAir=function(){var e=this,i=this.$form.find("#cbStandard");i.change(function(){var n=i.prop("checked"),o=new t.PropsDataUpload(e.searchId,"stdAir");o.setVal(n),o.send()})},e.prototype.init=function(t){var e=this;this.dataLoader.getInitData(function(i){e.searchId=i.first.id,e.menu.init(i.headers),e.initFormControls(),e.loadSearch(i.first),t()}),this.menu.onSearchChange=function(t){e.dataLoader.getSearch(t,function(i){e.loadSearch(i),e.searchId=t,e.v.planningMap.loadCategory(PlanningType.Custom),e.v.resultsEngine.initalCall(PlanningType.Custom,e.searchId)})},this.$form.find(".adder").click(function(t){t.preventDefault(),e.dataLoader.createNewSearch(function(t){e.menu.addItem(t.id,t.name),e.loadSearch(t),e.searchId=t.id})})},e.prototype.initFormControls=function(){this.initDaysRange(),this.initAirTagger(),this.initDateRange(),this.initStandardAir(),this.initFreq(),this.initDatesClosing()},e.prototype.loadSearch=function(t){this.$form.find("#cbStandard").prop("checked",t.standardAirs),this.depDate=TravelB.DateUtils.myDateToMomentDate(t.deparature),this.arrDate=TravelB.DateUtils.myDateToMomentDate(t.arrival),this.dpDep.setDate(this.depDate),this.dpArr.setDate(this.arrDate),this.slider.setVals(t.daysFrom,t.daysTo);var e=this.getAirs(t);this.airTagger.setSelectedItems(e),this.setFreq(t.freq),this.setFormState(t.started)},e.prototype.setFormState=function(t){var e=this.$form.find(".dates-static"),i=this.$form.find(".flexible-part"),n=this.$form.find(".fixed-part");if(t){var o=this.slider.getRange(),a=this.depDate.format("l"),r=this.arrDate.format("l");$(".earliest-dep").html(a),$(".latest-arr").html(r),$(".days-from").html(o.from),$(".days-to").html(o.to),i.removeClass("disabled-block"),e.removeClass("hidden"),n.addClass("hidden"),this.v.enableMap(!0)}else i.addClass("disabled-block"),e.addClass("hidden"),n.removeClass("hidden"),this.v.enableMap(!1)},e.prototype.getAirs=function(t){var e=[];return t.customAirs.forEach(function(t){e.push({kind:"airport",value:t.origId,text:t.text})}),e},e.prototype.initAirTagger=function(){var e=this,i=new t.TaggingFieldConfig;i.containerId="airTagger",i.localValues=!1,i.listSource="TaggerAirports",i.clientMatch=!1,this.airTagger=new t.TaggingField(i),this.airTagger.onItemClickedCustom=function(i,n){var o=i.data("vl"),a=(i.data("kd"),i.text()),r=new t.PropsDataUpload(e.searchId,"custAir");r.addVal("text",a),r.addVal("origId",o),r.send(function(){e.v.resultsEngine.refresh(),n()})},this.airTagger.onDeleteCustom=function(t,i){e.dataLoader.removeAirport(e.searchId,t,function(){i()})}},e}();t.CustomFrom=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.actCls="state-active",this.dataLoader=new t.SearchDataLoader,this.$cont=e}return e.prototype.addItem=function(t,e){this.headers.push({id:t,name:e}),this.init(this.headers,t)},e.prototype.init=function(t,e){var i=this;void 0===e&&(e=null),this.headers=t,this.$cont.find(".item").remove();var n="";this.headers.length>0&&(n=this.headers[0].id),e&&(n=e);var o=Common.ListGenerator.init(this.$cont.find(".adder"),"custom-menu-btn-template");o.appendStyle="before",o.activeItem=function(t){var e={isActive:t.id===n,cls:i.actCls};return e},o.evnt(null,function(t,e,n,o){i.itemClicked(e)}),o.evnt(".delete",function(t,e,n,o){i.delClicked(o.id)}),o.evnt(".edit",function(t,e,n,o){i.editClicked(e)}),o.evnt(".edit-save",function(t,e,n,o){i.saveClicked(e)}),o.evnt(".name-edit",function(t,e,n,o){i.keyPressed(t,e)}).setEvent("keyup"),o.generateList(t)},e.prototype.keyPressed=function(t,e){13===t.keyCode&&this.saveClicked(e)},e.prototype.saveClicked=function(e){var i=e.data("id"),n=e.find(".name-edit").val(),o=_.find(this.headers,function(t){return t.id===i});o.name=n;var a=new t.PropsDataUpload(i,"name");a.setVal(n),a.send(function(){e.find(".name-txt").html(n),e.removeClass("state-editing"),e.addClass("state-active")})},e.prototype.editClicked=function(t){t.removeClass("state-active"),t.addClass("state-editing")},e.prototype.delClicked=function(t){var e=this,i=new Common.ConfirmDialog;i.create("Search removal","Do you want to remove the search?","Cancel","Delete",function(){e.dataLoader.deleteSearch(t,function(){$("#"+t).remove()})})},e.prototype.itemClicked=function(t){var e=t.data("id"),i=this.$cont.find(".item");i.removeClass(this.actCls),t.addClass(this.actCls),this.onSearchChange&&this.onSearchChange(e)},e}();t.CustomMenu=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(t,e){this.values=[],this.searchId=t,this.propName=e}return t.prototype.setVal=function(t){this.value=t},t.prototype.addVal=function(t,e){this.values.push({name:t,val:e})},t.prototype.send=function(t){void 0===t&&(t=null);var e={id:this.searchId,name:this.propName,value:this.value,values:this.values};Views.ViewBase.currentView.apiPut("CustomSearch",e,function(e){t&&t(e)})},t}();t.PropsDataUpload=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){}return t.prototype.getInitData=function(t){var e=[["actionName","init"]];Views.ViewBase.currentView.apiGet("CustomSearch",e,function(e){t(e)})},t.prototype.getSearch=function(t,e){var i=[["actionName","search"],["id",t]];Views.ViewBase.currentView.apiGet("CustomSearch",i,function(t){e(t)})},t.prototype.createNewSearch=function(t){var e={actionName:"new"};Views.ViewBase.currentView.apiPost("CustomSearch",e,function(e){t(e)})},t.prototype.deleteSearch=function(t,e){Views.ViewBase.currentView.apiDelete("CustomSearch",[["actionName","search"],["id",t]],function(t){e(t)})},t.prototype.removeAirport=function(t,e,i){var n=[["actionName","air"],["id",t],["paramId",e]];Views.ViewBase.currentView.apiDelete("CustomSearch",n,function(t){i(t)})},t}();t.SearchDataLoader=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){}return t.cFlights=function(t){var e=this,i=[];return t.forEach(function(t){var n=e.cFlight(t);i.push(n)}),i},t.cFlight=function(t){var e=this,i={from:t.from,to:t.to,price:t.price,score:t.score,parts:[],bookLink:t.bl};return t.parts.forEach(function(t){var n=e.cPart(t);i.parts.push(n)}),i},t.cPart=function(t){var e={depTime:new Date(t.dep),arrTime:new Date(t.arr),from:t.from,to:t.to,airline:t.air,minsDuration:t.mins,flightNo:t.no};return e},t}();t.FlightConvert2=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t){this.fromDate=moment().add(1,"days"),this.toDate=this.fromDate.clone().add(3,"days"),this.currentFlights=[],this.depTimeFrom=0,this.depTimeTo=1440,this.arrTimeFrom=0,this.arrTimeTo=1440,this.$flightsCont=$(".other-flights-cont"),this.cityDetail=t}return e.prototype.addDays=function(t,e){return moment(t).add(e,"days").toDate()},e.prototype.init=function(){var e=this;this.$flightsCont.empty();var i=this.cityDetail.filterLayout("classics-srch-template");this.cityDetail.codePairs.length>1&&(this.airSel=new t.AirportSelector(i.find(".airpairs-filter"),this.cityDetail.codePairs),this.airSel.onChange=function(){e.filterFlightsTime()},this.airSel.init(),$(".multi-conn-cont").show());var n=new Common.MyCalendar($("#depDate"),this.fromDate);n.onChange=function(t){e.fromDate=t};var o=(this.timeSlider(i.find(".dep .time"),"depTime",function(t,i){e.depTimeFrom=t,e.depTimeTo=i,e.filterFlightsTime()}),new Common.MyCalendar($("#arrDate"),this.toDate));o.onChange=function(t){e.toDate=t};this.timeSlider(i.find(".arr .time"),"arrTime",function(t,i){e.arrTimeFrom=t,e.arrTimeTo=i,e.filterFlightsTime()});i.find("#search").click(function(t){t.preventDefault(),e.genCustomFlights()})},e.prototype.filterFlightsTime=function(){var t=this;this.$flightsCont.empty();var e=_.filter(this.currentFlights,function(e){var i=_.first(e.parts),n=_.last(e.parts),o=t.getDateMinutes(i.depTime),a=t.timeFits(o,t.depTimeFrom,t.depTimeTo),r=t.getDateMinutes(n.depTime),s=t.timeFits(r,t.arrTimeFrom,t.arrTimeTo),c=!0;if(t.cityDetail.codePairs.length>1){var l=t.airSel.getActive();c=_.find(l,function(t){return t.from===e.from&&t.to===e.to})}return a&&s&&c});this.cityDetail.flightDetails.genFlights(this.$flightsCont,e)},e.prototype.timeFits=function(t,e,i){return t>=e&&i>=t},e.prototype.getDateMinutes=function(t){return 60*(t.getHours()-1)+t.getMinutes()},e.prototype.genCustomFlights=function(){var e=this,i=TravelB.DateUtils.myDateToTrans(TravelB.DateUtils.momentDateToMyDate(this.fromDate)),n=TravelB.DateUtils.myDateToTrans(TravelB.DateUtils.momentDateToMyDate(this.toDate)),o=[["ss","1"],["dateFrom",i],["dateTo",n],["scoreLevel",ScoreLevel.Standard.toString()]];this.cityDetail.codePairs.forEach(function(e){var i=["codePairs",t.AirportSelector.toString(e)];o.push(i)}),this.cityDetail.genFlights(o,function(t){e.currentFlights=t})},e.prototype.timeSlider=function(e,i,n){var o=new t.TimeSlider(e,i);return o.onRangeChanged=function(t,e){n(t,e)},o.genSlider(),o},e}();t.CityClassicSearch=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e,i,n){this.v=Views.ViewBase.currentView,this.flightDetails=new t.FlightDetails,this.gid=n,this.title=i}return e.prototype.destroyLayout=function(){$(".city-deal").remove()},e.prototype.createLayout=function(t){var e=this;this.destroyLayout();var i=this.v.registerTemplate("city-deals-weekend-template"),n={gid:this.gid,title:this.title};this.$layout=$(i(n)),t.after(this.$layout),this.$layout.find(".close").click(function(t){t.preventDefault(),e.destroyLayout()})},e.prototype.init=function(e){var i=this;this.ordering=new t.FlightsOrdering,this.ordering.setFlights(e),this.ordering.onChange=function(t){i.flightDetails.genFlights(i.$layout.find(".flights"),t)},this.ordering.change()},e}();t.WeekendDetail=e;var i=function(){function e(e,i,n,o,a){this.v=Views.ViewBase.currentView,this.flightDetails=new t.FlightDetails,this.scoreLevel=e,this.codePairs=i,this.cityName=o,this.gid=a,this.title=n}return e.prototype.init=function(e){var i=this;this.ordering=new t.FlightsOrdering,this.ordering.setFlights(e),this.ordering.onChange=function(t){i.flightDetails.genFlights(i.$layout.find(".flights"),t)},this.ordering.change(),this.genMonthFlights()},e.prototype.destroyLayout=function(){$(".city-deal").remove()},e.prototype.initTabs=function(t,e){var i=t.find(".tab");t.find(".tab").click(function(t){t.preventDefault();var n=$(t.delegateTarget);i.removeClass("active"),n.addClass("active");var o=n.data("t");e(o)})},e.prototype.createLayout=function(e){var i=this;this.destroyLayout();var n=this.v.registerTemplate("city-deals-template"),o={gid:this.gid,title:this.title};this.$layout=$(n(o)),e.after(this.$layout),this.initDeals(),this.initTabs(this.$layout.find(".search-tabs"),function(e){i.$layout.find(".tabs-cont").empty(),i.$layout.find(".other-flights-cont").empty(),"deals"===e&&i.initDeals(),"classic"===e&&(i.classicSearch=new t.CityClassicSearch(i),i.classicSearch.init())}),this.$layout.find(".close").click(function(t){t.preventDefault(),i.destroyLayout()})},e.prototype.filterLayout=function(t){var e=this.v.registerTemplate(t),i=$(e());return this.$layout.find(".tabs-cont").html(i),i},e.prototype.initDeals=function(){var e=this,i=this.filterLayout("deals-srch-template");this.codePairs.length>1&&(this.airSel=new t.AirportSelector(i.find(".airpairs-filter"),this.codePairs),this.airSel.onChange=function(){e.genMonthFlights()},this.airSel.init(),$(".multi-conn-cont").show()),this.slider=new t.RangeSlider(i.find(".days-range"),"daysRange"),this.slider.genSlider(1,21),this.slider.setVals(5,7),this.slider.onRangeChanged=function(){e.genMonthFlights()},this.monthsSel=new t.MonthsSelector(i.find(".months")),this.monthsSel.gen(12),this.monthsSel.onChange=function(){e.genMonthFlights()}},e.prototype.preloader=function(t){var e=this.$layout.find(".other-flights-preloader");t?e.show():e.hide()},e.prototype.genMonthFlights=function(){var e=this.slider.getRange(),i=[["ss","0"],["daysFrom",e.from.toString()],["daysTo",e.to.toString()],["monthNo",this.monthsSel.month.toString()],["yearNo",this.monthsSel.year.toString()],["scoreLevel",this.scoreLevel.toString()]],n=this.codePairs.length>1?this.airSel.getActive():this.codePairs;n.forEach(function(e){var n=["codePairs",t.AirportSelector.toString(e)];i.push(n)}),this.genFlights(i)},e.prototype.genFlights=function(e,i){var n=this;void 0===i&&(i=null);var o=this.$layout.find(".other-flights-cont");o.empty(),this.preloader(!0),this.v.apiGet("SkypickerCity",e,function(e){var a=t.FlightConvert2.cFlights(e);i&&i(a),a=_(a).chain().sortBy("price").reverse().sortBy("score").reverse().value(),n.flightDetails.genFlights(o,a),n.preloader(!1)})},e}();t.CityDetail=i}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){var t=this;this.act="active",this.orderBy="price",this.orderStyle="asc",this.$cont=$(".deals-ordering");var e=this.$cont.find(".item");this.setActiveById(this.orderBy),e.click(function(i){var n=$(i.target);e.removeClass(t.act),n.addClass(t.act),t.orderStyle=n.data("o"),t.orderBy=n.data("b"),t.change()})}return t.prototype.setActiveById=function(t){this.$cont.find('[data-b="'+t+'"]').addClass(this.act)},t.prototype.setFlights=function(t){this.flights=t},t.prototype.change=function(){if(this.onChange){var t=[];"price"===this.orderBy&&(t=_(this.flights).chain().sortBy("price").reverse().sortBy("score").reverse().value()),"score"===this.orderBy&&(t=_(this.flights).chain().sortBy("score").reverse().sortBy("price").value()),this.onChange(t)}},t}();t.FlightsOrdering=e;var i=function(){function e(){}return e.prototype.genFlights=function(e,i){var n=this,o=Common.ListGenerator.init(e,"connection-flight-template");o.clearCont=!0,o.isAsync=!0,o.emptyTemplate="flights-empty-template",o.customMapping=function(e){var i=t.AnytimeAggUtils.getScoreStars(e.score);return{price:e.price,scoreText:n.getScoreText(i),scoreStars:i,bookLink:e.bookLink}},o.onItemAppended=function(t,e){n.genFlight(t.find(".left"),e)},o.generateList(i)},e.prototype.getScoreText=function(t){return 5===t||4===t?"E":3===t||2===t?"G":"S"},e.prototype.splitInboundOutboundFlight=function(t){var e=[],i=[],n=!1;return t.parts.forEach(function(o){n?i.push(o):e.push(o),o.to===t.to&&(n=!0)}),{thereParts:e,backParts:i}},e.prototype.genFlight=function(t,e){var i=this,n=this.splitInboundOutboundFlight(e),o=n.thereParts,a=n.backParts,r=[];if(1===o.length)r.push(o[0]);else{var s=this.viewForMultiFlight(o);r.push(s)}if(1===a.length)r.push(a[0]);else{var c=this.viewForMultiFlight(a);r.push(c)}var l=Common.ListGenerator.init(t,"connection-single-flight-template");l.customMapping=function(t){return t.isMulti?t:i.mapSingleFlight(t)},l.evnt(".stops-btn",function(t,e,n,o){var a=n.find(".icon-dropdown-arrow");if(o.subList)o.subList.destroy(),o.subList=null,a.removeClass("opened");else{var r=i.genMultiFlightFlights(e,o);o.subList=r,a.addClass("opened")}}),l.generateList(r)},e.prototype.genMultiFlightFlights=function(t,e){var i=this,n=t.find(".flights-sub"),o=Common.ListGenerator.init(n,"connection-single-flight-template");return o.customMapping=function(t){var e=i.mapSingleFlight(t);return e.customClass="sub-part",e},o.generateList(e.parts),o},e.prototype.viewForMultiFlight=function(e){var i=_.first(e),n=_.last(e),o="Multi airlines",a="/images/n/airlogos/default-airline.svg",r=_.every(e,function(t){return t.airline===i.airline});r&&(o=t.AirlineCodes.getName(i.airline),a=this.getLogoLink(i.airline));var s=this.getDurationMulti(i.depTime,n.arrTime),c={isMulti:!0,parts:e,customClass:"",airName:o,logoLink:a,codeFrom:i.from,codeTo:n.to,flightNo:"",date:this.getDate(i.depTime),timeFrom:this.getTime(i.depTime),timeTo:this.getTime(n.arrTime),durHours:s.hours,durMins:s.mins,stops:e.length-1};return c},e.prototype.mapSingleFlight=function(e){var i=this.getDuration(e.minsDuration),n={customClass:"",airName:t.AirlineCodes.getName(e.airline),logoLink:this.getLogoLink(e.airline),codeFrom:e.from,codeTo:e.to,flightNo:e.airline+e.flightNo,date:this.getDate(e.depTime),timeFrom:this.getTime(e.depTime),timeTo:this.getTime(e.arrTime),durHours:i.hours,durMins:i.mins,stops:0};return n},e.prototype.getDurationMulti=function(t,e){var i=e-t,n=i/1e3/60;return this.getDuration(n)},e.prototype.getDuration=function(t){var e=Math.floor(t/60),i=t%60;return{hours:e,mins:i}},e.prototype.getDate=function(t){var e=moment.utc(t).format("ddd D MMM");return e},e.prototype.getTime=function(t){var e=moment.utc(t);e.locale("de");var i=e.format("LT");return i},e.prototype.getLogoLink=function(t){var e=["OK","LX","4U","5J","9U","9W","A3","A5","A9","AA","AB","AC","AF","AK","AS","AV","AY","AZ","B2","B6","BA","BE","BT","BY","CA","CI","CX","CZ","D8","DE","DJ","DL","DP","DY","EI","EK","EV","EW","F9","FI","FL","FR","FV","G3","GA","HG","HQ","HU","HV","IB","IG","JJ","JL","JP","JQ","JT","JU","KC","KE","KL","KM","LA","LG","LH","LO","LP","LS","LU","MH","MQ","MT","MU","NH","NZ","OA","OO","OS","OU","OZ","PC","PS","QF","QR","QU","RO","S7","SK","SN","SQ","SR","ST","SU","SV","SW","TG","TK","TO","TP","TV","U2","U6","UA","UT","UX","VA","VN","VS","VX","VY","W6","WN","WS","X3","XQ","YM","ZH"];return _.contains(e,t)||(t="default-airline"),"/images/n/airlogos/"+t+".svg"},e}();t.FlightDetails=i}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){this.clientMatch=!0}return t}();t.TaggingFieldConfig=e;var i=function(){function t(t){this.taggerTemplate=Views.ViewBase.currentView.registerTemplate("tagger-template"),this.selectedItems=[],this.config=t,this.config.placeholder||(this.config.placeholder="Search"),this.$cont=$("#"+this.config.containerId),this.$tagger=this.createTagger(),this.$cont.prepend(this.$tagger)}return t.prototype.setSelectedItems=function(t){this.selectedItems=t,this.initTags(t)},t.prototype.initTags=function(t){var e=this;this.$cont.find(".tag").remove(),t.forEach(function(t){var i=null;if(i=e.config.localValues?_.find(e.config.itemsRange,function(e){return e.kind===t.kind&&e.value===t.value}):t){var n=e.createTag(i.text,i.value,i.kind);e.$cont.prepend(n)}})},t.prototype.createTag=function(t,e,i){var n=this,o=$('<span class="tag" data-vl="'+e+'" data-kd="'+i+'">'+t+'<a class="icon-cross" href="#"></a></span>');return o.find("a").click(function(t){t.preventDefault();var e=$(t.target);n.removeTag(e,o)}),o},t.prototype.removeTag=function(t,e){var i=this,n=t.parent().data("vl");this.selectedItems=_.reject(this.selectedItems,function(t){return t.value===n}),this.onDeleteCustom(n,function(){e.remove(),i.onChange&&i.onChange(i.selectedItems)})},t.prototype.createTagger=function(){var t=this,e={placeholder:this.config.placeholder},i=this.taggerTemplate(e),n=$(i),o=n.find("input"),a=n.find("ul");return o.keyup(function(e){t.fillTagger(o,a)}),o.focus(function(e){setTimeout(function(){t.fillTagger(o,a),a.show()},250)}),o.focusout(function(t){setTimeout(function(){o.val(""),a.hide()},250)}),n},t.prototype.fillTagger=function(t,e){var i=this;console.log("filling"),e.html("");var n=t.val().toLowerCase();this.getItemsRange(n,function(t){t.forEach(function(t){var o=!0;i.config.clientMatch&&(o=""===n||t.text.toLowerCase().startsWith(n));var a=_.find(i.selectedItems,function(e){return e.value===t.value&&e.kind===t.kind});if(o&&!a){var r=i.createTaggerItem(t.text,t.value,t.kind);e.append(r)}})})},t.prototype.getItemsRange=function(t,e){if(this.config.localValues)e(this.config.itemsRange);else{var i=[["query",t]];Views.ViewBase.currentView.apiGet(this.config.listSource,i,function(t){e(t)})}},t.prototype.createTaggerItem=function(t,e,i){var n=this,o=$('<li data-vl="'+e+'" data-kd="'+i+'">'+t+"</li>");return o.click(function(t){t.preventDefault(),n.onItemClicked(o)}),o},t.prototype.onItemClicked=function(t){var e=this,i=t.data("vl"),n=t.data("kd"),o=t.text();this.selectedItems.push({value:i,kind:n}),this.onItemClickedCustom(t,function(){var t=e.createTag(o,i,n);e.$tagger.before(t)}),this.onChange&&this.onChange(this.selectedItems)},t}();t.TaggingField=i}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t){this.viewType=FlightCacheRecordType.Country,this.v=t}return e.prototype.init=function(){this.initMap(),this.initCountriesFnc(),this.initCitiesFnc()},e.prototype.changeViewType=function(t){this.viewType=t,this.map["switch"](this.viewType)},e.prototype.initMap=function(){var e=this;this.map=new t.Map(this),this.map.onMapLoaded=function(){e.onMapLoaded()},this.map.init()},e.prototype.initCountriesFnc=function(){var t=this;this.map.onCountryChange=function(e,i){t.onSelectionChanged(e,i,FlightCacheRecordType.Country);var n=t.v.currentSetter.getCustomId(),o={type:t.planningType,cc:e,selected:i,customId:n};t.v.apiPut("SelCountry",o,function(){})}},e.prototype.initCitiesFnc=function(){var t=this;this.map.onCityChange=function(e,i){t.onSelectionChanged(e,i,FlightCacheRecordType.City);var n=t.v.currentSetter.getCustomId(),o={type:t.planningType,gid:e,selected:i,customId:n};t.v.apiPut("SelCity",o,function(){})}},e.prototype.loadCategory=function(t){this.planningType=t,this.initData()},e.prototype.initData=function(){var t=this;this.getSelectedCCs(this.planningType,function(e){t.map.mapCountries.set(e),t.map["switch"](t.viewType)})},e.prototype.getSelectedCCs=function(t,e){var i=this.v.currentSetter.getCustomId(),n=[["type",t.toString()],["customId",i]];Views.ViewBase.currentView.apiGet("SelCountry",n,function(t){e(t)})},e}();t.PlanningMap=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){this.prms=[],this.firstQuery=!1,this.ccs=[],this.gids=[],this.qids=[]}return t["new"]=function(){return new t},t.prototype.addCC=function(t){return this.ccs.push(t),this},t.prototype.addGID=function(t){return this.gids.push(t),this},t.prototype.addQID=function(t){return this.qids.push(t),this},t.prototype.setFirstQuery=function(t){return this.firstQuery=t,this},t.prototype.setTimeType=function(t){return this.timeType=t,this},t.prototype.setCustomId=function(t){return this.customId=t,this},t.prototype.build=function(){var t=this;return this.addPrm("timeType",this.timeType),this.addPrm("firstQuery",this.firstQuery),this.addPrm("customId",this.customId),this.firstQuery?this.prms:(this.ccs.forEach(function(e){t.addPrm("ccs",e)}),this.gids.forEach(function(e){t.addPrm("gids",e)}),this.qids.forEach(function(e){t.addPrm("qids",e)}),this.prms)},t.prototype.addPrm=function(t,e){if(notNull(e)){var i=[t,e.toString()];this.prms.push(i)}},t}();t.QueriesBuilder=e;var i=function(){function t(t){this.finishedQueries=[],this.queue=[],this.doRequery=!0,this.lastCustomId="",this.v=t}return t.prototype.refresh=function(){this.initalCall(this.timeType,this.lastCustomId)},t.prototype.initalCall=function(t,i){void 0===i&&(i=""),this.lastCustomId=i,this.timeType=t,this.stopQuerying(),this.queue=[],this.finishedQueries=[],this.resultsChanged();var n=e["new"]().setFirstQuery(!0).setTimeType(t).setCustomId(i).build();this.getQueries(n)},t.prototype.recieveQueries=function(t){var e=this,i=!1;t.forEach(function(t){t.state===QueryState.Failed&&e.removeFromQueue(t.qid),t.state===QueryState.Finished&&(e.addToFinished(t),i=!0),t.state!==QueryState.Saved&&t.state!==QueryState.Started||e.addToQueue(t)}),this.drawQueue(),i&&this.resultsChanged(),this.queue.length>0&&this.startQuerying()},t.prototype.addToQueue=function(t){var e=_.find(this.queue,function(e){return e.qid===t.qid});e||this.queue.push(t)},t.prototype.addToFinished=function(t){this.finishedQueries.push(t),this.removeFromQueue(t.qid)},t.prototype.removeFromQueue=function(t){this.queue=_.reject(this.queue,function(e){return e.qid===t})},t.prototype.selectionChanged=function(t,i,n,o){if(void 0===o&&(o=""),this.lastCustomId=o,i){this.drawQueue();var a=e["new"]().setTimeType(this.timeType).setCustomId(o);n===FlightCacheRecordType.City&&a.addGID(parseInt(t)),n===FlightCacheRecordType.Country&&a.addCC(t);var r=a.build();this.getQueries(r)}else this.finishedQueries=_.reject(this.finishedQueries,function(e){return e.to===t}),this.resultsChanged()},t.prototype.getQueries=function(t){var e=this;this.stopQuerying(),Views.ViewBase.currentView.apiGet("Deals",t,function(t){e.recieveQueries(t)})},t.prototype.resultsChanged=function(){this.onResultsChanged&&this.onResultsChanged(this.finishedQueries)},t.prototype.stopQuerying=function(){this.intervalId&&clearInterval(this.intervalId)},t.prototype.startQuerying=function(){var t=this;this.doRequery&&(this.intervalId=setInterval(function(){t.drawQueue(),0===t.queue.length&&t.stopQuerying();var i=e["new"]().setTimeType(t.timeType);t.queue.forEach(function(t){i.addQID(t.qid)});var n=i.build();t.getQueries(n)},3e3))},t.prototype.drawQueue=function(){this.onDrawQueue&&this.onDrawQueue()},t}();t.ResultsManager=i;var n=function(){function t(){this.$mainCont=$("#queue"),this.$cont=this.$mainCont.find(".cont"),this.itemTmp=Views.ViewBase.currentView.registerTemplate("queue-item-tmp")}return t.prototype.draw=function(t,e){var i=this;this.$cont.empty(),this.$mainCont.removeClass("hidden");var n=7,a=e,r=a.length>n;r&&(a=a.slice(0,n)),a.forEach(function(e){var n="";if(t===PlanningType.Weekend){var a=o.weekend(e.prms);n="("+a.week+". week, "+a.year+")"}var r=e.from+" - "+e.toName+" "+n,s={text:r},c=i.itemTmp(s);i.$cont.append(c)}),r&&this.$cont.append("<span>...</span>")},t.prototype.hide=function(){this.$cont.empty(),this.$mainCont.addClass("hidden")},t}();t.QueueVisualize=n;var o=function(){function t(){}return t.weekend=function(t){var e=t.split("_");return{week:e[0],year:e[1]}},t.custom=function(t){var e=t.split("_");return{userId:e[0],searchId:e[1]}},t}();t.ParamsParsers=o}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){}return t.getName=function(t){var e=_.find(this.codes,function(e){return e.code===t});return e?e.name:t},t.codes=[{code:"ZY",name:"Sky Airlines"},{code:"ZX",name:"Air BC"},{code:"ZX",name:"Air Georgian"},{code:"ZW",name:"Air Wisconsin"},{code:"ZV",name:"Air Midwest"},{code:"ZU",name:"Helios Airways"},{code:"ZT",name:"Titan Airways"},{code:"ZS",name:"Azzurra Air614"},{code:"ZS",name:"Sama Airlines"},{code:"ZP",name:"Silk Way Airlines"},{code:"ZL",name:"Regional Express"},{code:"ZK",name:"Great Lakes Airlines"},{code:"ZI",name:"Aigle Azur"},{code:"ZH",name:"Shenzhen Airlines"},{code:"ZG",name:"Viva Macau"},{code:"ZE",name:"Arcus-Air Logistic"},{code:"ZE",name:"Eastar Jet"},{code:"ZE",name:"Lneas Areas Azteca"},{code:"ZB",name:"Air Bourbon"},{code:"ZB",name:"Monarch Airlines"},{code:"ZA",name:"AccessAir"},{code:"ZA",name:"Interavia Airlines"},{code:"Z8",name:"Lnea Area Amaszonas"},{code:"Z7",name:"ADC Airlines"},{code:"Z5",name:"GMG Airlines"},{code:"Z4",name:"Zoom Airlines"},{code:"Z3",name:"Avient Aviation"},{code:"YX",name:"Midwest Airlines"},{code:"YW",name:"Air Nostrum"},{code:"YV",name:"Mesa Airlines"},{code:"YU",name:"Dominair"},{code:"YT",name:"Air Togo"},{code:"YS",name:"Rgional Compagnie Arienne Europenne"},{code:"YQ",name:"TAR Aerolineas"},{code:"YM",name:"Montenegro Airlines"},{code:"YL",name:"Yamal Airlines"},{code:"YK",name:"Cyprus Turkish Airlines"},{code:"YH",name:"West Caribbean Airways"},{code:"YE",name:"Aryan Cargo Express"},{code:"YD",name:"Cologne Air Transport GmbH"},{code:"Y9",name:"Kish Air"},{code:"Y8",name:"Yangtze River Express"},{code:"Y6",name:"Batavia Air"},{code:"Y5",name:"Golden Myanmar Airlines"},{code:"Y5",name:"Pace Airlines"},{code:"Y4",name:"Volaris"},{code:"Y2",name:"Alliance Air"},{code:"Y2",name:"Flyglobespan"},{code:"Y0",name:"Yellow Air Taxi/Friendship Airways"},{code:"XT",name:"Air Exel"},{code:"XT",name:"SkyStar Airways"},{code:"XS",name:"SITA"},{code:"XQ",name:"SunExpress"},{code:"XP",name:"Western"},{code:"XP",name:"Xtra Airways"},{code:"XO",name:"China Xinhua Airlines"},{code:"XO",name:"LTE International Airways"},{code:"XM",name:"J-Air"},{code:"XL",name:"Aerolane"},{code:"XK",name:"Corse Mditerrane"},{code:"XJ",name:"Mesaba Airlines"},{code:"XJ",name:"Thai Airasia X"},{code:"XF",name:"Vladivostok Air"},{code:"XC",name:"Corendon Airlines"},{code:"X9",name:"Avion Express"},{code:"X7",name:"Chitaavia"},{code:"X3",name:"Hapag-Lloyd Express(TUIfly)"},{code:"WZ",name:"West African Airlines"},{code:"WY",name:"Oman Air"},{code:"WX",name:"CityJet"},{code:"WX",name:"CityJet"},{code:"WW",name:"Bmibaby"},{code:"WW",name:"WOW air"},{code:"WV",name:"Swe Fly"},{code:"WT",name:"Wasaya Airways"},{code:"WS",name:"WestJet"},{code:"WS",name:"WestJet Encore"},{code:"WR",name:"Royal Tongan Airlines"},{code:"WO",name:"World Airways"},{code:"WN",name:"Southwest Airlines"},{code:"WK",name:"American Falcon"},{code:"WK",name:"Edelweiss Air"},{code:"WH",name:"China Northwest Airlines"},{code:"WH",name:"WebJet Linhas Areas"},{code:"WG",name:"Sunwing Airlines"},{code:"WF",name:"Widere"},{code:"WE",name:"Centurion Air Cargo"},{code:"WE",name:"Thai Smile Airways"},{code:"WDK",name:"WOODSTOCK"},{code:"WD*",name:"Amsterdam Airlines"},{code:"WD",name:"DAS Air Cargo"},{code:"WC",name:"Islena De Inversiones"},{code:"WB",name:"Rwandair Express"},{code:"WA",name:"KLM Cityhopper"},{code:"WA",name:"Western Airlines"},{code:"W9",name:"Abelag Aviation"},{code:"W9",name:"Air Bagan"},{code:"W9",name:"Eastwind Airlines"},{code:"W8",name:"Cargojet Airways"},{code:"W7",name:"Sayakhat Airlines"},{code:"W7",name:"Western Pacific Airlines"},{code:"W6",name:"Wizz Air"},{code:"W5",name:"Mahan Air"},{code:"W4",name:"Aero Services Executive"},{code:"W3",name:"Flyhy Cargo Airlines"},{code:"W3",name:"Switfair Cargo"},{code:"W2",name:"Canadian Western Airlines"},{code:"W1",name:"WDL Aviation"},{code:"VZ",name:"MyTravel Airways"},{code:"VY",name:"Formosa Airlines"},{code:"VY",name:"Vueling Airlines"},{code:"VX",name:"ACES Colombia"},{code:"VX",name:"Virgin America"},{code:"VW",name:"Aeromar"},{code:"VV",name:"Aerosvit Airlines"},{code:"VU",name:"Air Ivoire"},{code:"VT",name:"Air Tahiti"},{code:"VS",name:"Virgin Atlantic Airways"},{code:"VR",name:"TACV"},{code:"VQ",name:"Novo Air"},{code:"VP",name:"VASP"},{code:"VO",name:"Tyrolean Airways"},{code:"VN",name:"Vietnam Airlines"},{code:"VM",name:"Viaggio Air"},{code:"VL",name:"Air VIA"},{code:"VK",name:"Virgin Nigeria Airways"},{code:"VJ",name:"Africa Airways"},{code:"VJ",name:"Jatayu Airlines"},{code:"VJ",name:"Thai Vietjet Air"},{code:"VJ",name:"Vietjet Air"},{code:"VI",name:"Volga-Dnepr Airlines"},{
code:"VH",name:"Aeropostal Alas de Venezuela"},{code:"VG",name:"VLM Airlines"},{code:"VF",name:"Valuair"},{code:"VE",name:"Avensa"},{code:"VE",name:"EUjet"},{code:"VE",name:"C.A.I. Second"},{code:"VD",name:"Air Libert"},{code:"VD",name:"Kunpeng Airlines"},{code:"VD",name:"SwedJet Airways"},{code:"VC",name:"Ocean Airlines"},{code:"VC",name:"Voyageur Airways"},{code:"VB",name:"Aeroenlaces Nacionales"},{code:"VB",name:"VIVA Aerobus"},{code:"VA",name:"Virgin Australia Airlines"},{code:"VA",name:"Viasa"},{code:"V9",name:"BAL Bashkirian Airlines"},{code:"V9",name:"Star1 Airlines"},{code:"V8",name:"ATRAN Cargo Airlines"},{code:"V8",name:"Iliamna Air Taxi"},{code:"V7",name:"Air Senegal International"},{code:"V7",name:"Volotea"},{code:"V5",name:"Avolar Aerolneas"},{code:"V5",name:"DanubeWings"},{code:"V5",name:"Royal Aruban Airlines"},{code:"V4",name:"Reem Air"},{code:"V4",name:"Vieques Air Link"},{code:"V3",name:"Carpatair"},{code:"V2",name:"Karat"},{code:"V2",name:"Vision Airlines"},{code:"V0",name:"Conviasa"},{code:"UZ",name:"El-Buraq Air Transport"},{code:"UY",name:"Cameroon Airlines"},{code:"UX",name:"Air Europa"},{code:"UU",name:"Air Austral"},{code:"UT",name:"UTair Aviation"},{code:"US",name:"US Airways"},{code:"US",name:"Unavia Suisse"},{code:"US",name:"US Airways"},{code:"UQ",name:"O'Connor Airlines"},{code:"UP",name:"Bahamasair"},{code:"UO",name:"Hong Kong Express Airways"},{code:"UN",name:"Transaero Airlines"},{code:"UM",name:"Air Zimbabwe"},{code:"UL",name:"SriLankan Airlines"},{code:"UI",name:"Eurocypria Airlines"},{code:"UH",name:"US Helicopter"},{code:"UH",name:"US Helicopter Corporation"},{code:"UG",name:"SevenAir"},{code:"UG",name:"Tuninter"},{code:"UF",name:"UM Airlines"},{code:"UE",name:"Nasair"},{code:"UE",name:"Transeuropean Airlines"},{code:"UD",name:"Hex'Air"},{code:"UB",name:"Myanma Airways"},{code:"UA",name:"United Airlines"},{code:"U8",name:"Armavia"},{code:"U7",name:"Air Uganda"},{code:"U7",name:"Northern Dene Airways"},{code:"U7",name:"USA Jet Airlines"},{code:"U6",name:"Ural Airlines"},{code:"U5",name:"USA3000 Airlines"},{code:"U4",name:"PMTair"},{code:"U3",name:"Avies"},{code:"U2",name:"easyJet"},{code:"U2",name:"United Feeder Service"},{code:"TZ",name:"air-taxi Europe"},{code:"TZ",name:"ATA Airlines"},{code:"TZ",name:"Scoot"},{code:"TY",name:"Air Caldonie"},{code:"TY",name:"Iberworld"},{code:"TX",name:"Air Carabes"},{code:"TX",name:"Transportes Areos Nacionales"},{code:"TW",name:"T'way Air"},{code:"TV",name:"Virgin Express"},{code:"TU",name:"Tunisair"},{code:"TT",name:"Air Lithuania"},{code:"TT",name:"Tigerair Australia"},{code:"TS",name:"Air Transat"},{code:"TR",name:"Transbrasil"},{code:"TR",name:"Tigerair Singapore"},{code:"TQ",name:"Tandem Aero"},{code:"TP",name:"TAP Portugal"},{code:"TO",name:"President Airlines"},{code:"TO",name:"Transavia France"},{code:"TN",name:"Air Tahiti Nui"},{code:"TM",name:"Linhas Areas de Moambique"},{code:"TL",name:"Airnorth"},{code:"TL",name:"Trans Mediterranean Airlines"},{code:"TK",name:"Turkish Airlines"},{code:"TJ",name:"Tradewind Aviation"},{code:"TI",name:"Tol-Air Services"},{code:"TH",name:"BA Connect"},{code:"TH",name:"Transmile Air Services"},{code:"TG",name:"Thai Airways International"},{code:"TF",name:"Malm Aviation"},{code:"TE",name:"FlyLal"},{code:"TE",name:"Skytaxi"},{code:"TD",name:"Atlantis European Airways"},{code:"TD",name:"Tulip Air"},{code:"TC",name:"Air Tanzania"},{code:"T9",name:"TransMeridian Airlines"},{code:"T9",name:"Thai Star Airlines"},{code:"T7",name:"Twin Jet"},{code:"T6",name:"Tavrey Airlines"},{code:"T4",name:"TRIP Linhas Areas"},{code:"T3",name:"Eastern Airways"},{code:"T2",name:"Thai Air Cargo"},{code:"SZ",name:"Air Southwest"},{code:"SY",name:"Sun Country Airlines"},{code:"SX",name:"Sky Work Airlines"},{code:"SX",name:"Skybus Airlines"},{code:"SW",name:"Air Namibia"},{code:"SV",name:"Saudia"},{code:"SU",name:"Aeroflot Russian Airlines"},{code:"ST",name:"Germania"},{code:"SS",name:"Corsairfly"},{code:"SR",name:"Swissair"},{code:"SQ",name:"Singapore Airlines"},{code:"SQ",name:"Singapore Airlines Cargo"},{code:"SP",name:"SATA Air Acores"},{code:"SO",name:"Superior Aviation"},{code:"SO",name:"Sosoliso Airlines"},{code:"SO",name:"Sunshine Airlines"},{code:"SN",name:"Brussels International Airlines"},{code:"SN",name:"Brussels Airlines"},{code:"SM",name:"Aberdeen Airways"},{code:"SM",name:"Swedline Express"},{code:"SL",name:"Rio Sul Servios Areos Regionais"},{code:"SL",name:"Thai Lion Mentari"},{code:"SK",name:"Scandinavian Airlines"},{code:"SK",name:"SAS Braathens"},{code:"SJ",name:"Freedom Air"},{code:"SI",name:"Skynet Airlines"},{code:"SH",name:"Fly Me Sweden"},{code:"SG",name:"JetsGo"},{code:"SG",name:"Spicejet"},{code:"SF",name:"Tassili Airlines"},{code:"SE",name:"XL Airways France"},{code:"SD",name:"Sudan Airways"},{code:"SC",name:"Shandong Airlines"},{code:"SB",name:"Air Caledonie International"},{code:"SA",name:"South African Airways"},{code:"S9",name:"East African Safari Air"},{code:"S8",name:"Chari Aviation Services"},{code:"S8",name:"Shovkoviy Shlyah"},{code:"S8",name:"Skywise Airline"},{code:"S7",name:"S7 Airlines"},{code:"S6",name:"Star Air"},{code:"S6",name:"Star Air"},{code:"S5",name:"Shuttle America"},{code:"S5",name:"Trast Aero"},{code:"S4",name:"SATA International"},{code:"S3",name:"Santa Barbara Airlines"},{code:"S2",name:"Air Sahara"},{code:"S0",name:"Slok Air Gambia"},{code:"RZ",name:"Euro Exec Express"},{code:"RX",name:"Aviaexpress"},{code:"RW",name:"Republic Airlines"},{code:"RV*",name:"Africaone"},{code:"RV",name:"Air Canada Rouge"},{code:"RV",name:"Caspian Airlines"},{code:"RU",name:"AirBridge Cargo"},{code:"RU",name:"SkyKing Turks and Caicos Airways"},{code:"RS",name:"Intercontinental de Aviacin"},{code:"RS",name:"Royal Air Force of Oman"},{code:"RS",name:"Sky Regional Airlines"},{code:"RR",name:"Royal Air Force"},{code:"RQ",name:"Kam Air"},{code:"RP",name:"Chautauqua Airlines"},{code:"RO",name:"Tarom"},{code:"RL",name:"Rio Linhas Areas"},{code:"RL",name:"Royal Phnom Penh Airways"},{code:"RK",name:"Skyview Airways"},{code:"RJ",name:"Royal Jordanian"},{code:"RI",name:"Mandala Airlines"},{code:"RH",name:"Republic Express Airlines"},{code:"RG",name:"VRG Linhas Areas"},{code:"RF",name:"Florida West International Airways"},{code:"RE",name:"Aer Arann"},{code:"RE",name:"Stobart Air"},{code:"RD",name:"Ryan International Airlines"},{code:"RC",name:"Atlantic Airways"},{code:"RB",name:"Air Srpska"},{code:"RB",name:"Syrian Arab Airlines"},{code:"RA",name:"Nepal Airlines"},{code:"R9",name:"Camai Air"},{code:"R8",name:"Kyrgyzstan Airlines"},{code:"R7",name:"Aserca Airlines"},{code:"R6",name:"RACSA"},{code:"R5",name:"Jordan Aviation"},{code:"R5",name:"Malta Air Charter"},{code:"R3",name:"Armenian Airlines"},{code:"R3",name:"Aircompany Yakutia"},{code:"R3",name:"Yakutia Airlines"},{code:"R2",name:"Orenburg Airlines"},{code:"R1",name:"Sirin"},{code:"R0",name:"Royal Airlines"},{code:"QZ",name:"Indonesia AirAsia"},{code:"QY",name:"European Air Transport"},{code:"QX",name:"Horizon Air"},{code:"QW",name:"Blue Wings"},{code:"QV",name:"Lao Airlines"},{code:"QU",name:"UTair-Ukraine"},{code:"QU",name:"Uganda Airlines"},{code:"QT",name:"TAMPA"},{code:"QS",name:"African Safari Airways"},{code:"QS",name:"Travel Service"},{code:"QR",name:"Qatar Airways"},{code:"QQ",name:"Alliance Airlines"},{code:"QQ",name:"Reno Air"},{code:"QO",name:"Aeromexpress"},{code:"QO",name:"Origin Pacific Airways"},{code:"QN",name:"Air Armenia"},{code:"QM",name:"Air Malawi"},{code:"QL",name:"Aero Lanka"},{code:"QL",name:"Lankan Cargo"},{code:"QL",name:"Lnea Area de Servicio Ejecutivo Regional"},{code:"QK",name:"Air Canada Jazz"},{code:"QJ",name:"Jet Airways"},{code:"QI",name:"Cimber Sterling"},{code:"QH",name:"Air Kyrgyzstan"},{code:"QH",name:"Aero Leasing"},{code:"QH",name:"Air Florida"},{code:"QH",name:"Kyrgyzstan"},{code:"QF",name:"Eastern Australia Airlines"},{code:"QF",name:"Qantas"},{code:"QF",name:"Qantaslink"},{code:"QF",name:"Qantaslink"},{code:"QF",name:"Sunstate Airlines"},{code:"QE",name:"Crossair Europe"},{code:"QD",name:"Air Class Lneas Areas"},{code:"QC",name:"Air Corridor"},{code:"QB",name:"Air Alma"},{code:"QB",name:"Georgian National Airlines"},{code:"Q9",name:"Afrinat International Airlines"},{code:"Q8",name:"Pacific East Asia Cargo Airlines"},{code:"Q6",name:"Aero Condor Peru"},{code:"Q5",name:"40-Mile Air"},{code:"Q4",name:"Mastertop Linhas Areas"},{code:"Q4",name:"Swazi Express Airways"},{code:"Q4",name:"Starlink Aviation"},{code:"Q3",name:"Zambian Airways"},{code:"PZ",name:"TAM Mercosur"},{code:"PY",name:"Surinam Airways"},{code:"PX",name:"Air Niugini"},{code:"PW",name:"Precision Air"},{code:"PV",name:"PAN Air"},{code:"PV",name:"St Barth Commuter"},{code:"PU",name:"PLUNA"},{code:"PT",name:"Capital Cargo International Airlines"},{code:"PT",name:"West Air Sweden"},{code:"PS",name:"Ukraine International Airlines"},{code:"PR",name:"Philippine Airlines"},{code:"PQ",name:"AirAsia Philippines"},{code:"PP",name:"Jet Aviation"},{code:"PO",name:"Polar Air Cargo"},{code:"PN",name:"Pan American Airways"},{code:"PM",name:"Tropic Air"},{code:"PL",name:"Aeroper"},{code:"PL",name:"Airstars"},{code:"PK",name:"Pakistan International Airlines"},{code:"PJ",name:"Air Saint Pierre"},{code:"PI",name:"Piedmont Airlines (1948-1989)"},{code:"PI",name:"Sun Air (Fiji)"},{code:"PH",name:"Polynesian Airlines"},{code:"PG",name:"Bangkok Airways"},{code:"PF",name:"Palestinian Airlines"},{code:"PE",name:"Air Europe Italy"},{code:"PE",name:"People's Viennaline"},{code:"PD",name:"Porter Airlines"},{code:"PC",name:"Air Fiji"},{code:"PC",name:"Continental Airways"},{code:"PC",name:"Pegasus Airlines"},{code:"PA",name:"Florida Coastal Airlines"},{code:"PA",name:"Pan American Airways"},{code:"PA",name:"Pan American World Airways"},{code:"P9",name:"Nas Air"},{code:"P9",name:"Perm Airlines"},{code:"P9",name:"Peruvian Airlines"},{code:"P8",name:"Air Mekong"},{code:"P8",name:"Pantanal Linhas Areas"},{code:"P7",name:"Russian Sky Airlines"},{code:"P6",name:"Privilege Style Lneas Areas"},{code:"P5",name:"AeroRepblica"},{code:"P3",name:"Passaredo Transportes Areos"},{code:"P0",name:"Proflight Zambia"},{code:"OZ",name:"Asiana Airlines"},{code:"OZ",name:"Ozark Air Lines"},{code:"OY",name:"Andes Lneas Areas"},{code:"OY",name:"Omni Air International"},{code:"OX",name:"Orient Thai Airlines"},{code:"OW",name:"Executive Airlines"},{code:"OV",name:"Estonian Air"},{code:"OU",name:"Croatia Airlines"},{code:"OT",name:"Aeropelican Air Services"},{code:"OS",name:"Austrian Airlines"},{code:"OR",name:"Arkefly"},{code:"OP",name:"Chalk's International Airlines"},{code:"OO",name:"SkyWest Airlines"},{code:"ON",name:"Our Airline"},{code:"OM",name:"MIAT Mongolian Airlines"},{code:"OL",name:"OLT Express Germany"},{code:"OK",name:"Czech Airlines"},{code:"OJ",name:"Fly Jamaica Airways"},{code:"OJ",name:"Overland Airways"},{code:"OH",name:"Comair"},{code:"OF",name:"Air Finland"},{code:"OF",name:"Enter Air"},{code:"OF",name:"Transports et Travaux Ariens de Madagascar"},{code:"OE",name:"Asia Overnight Express"},{code:"OD",name:"Malindo Airways"},{code:"OB",name:"Astrakhan Airlines"},{code:"OB",name:"Austrian Airtransport"},{code:"OB",name:"Oasis International Airlines"},{code:"OA",name:"Olympic Air"},{code:"OA",name:"Olympic Airlines"},{code:"O9",name:"Nova Airline"},{code:"O8",name:"Oasis Hong Kong Airlines"},{code:"O7",name:"Ozjet Airlines"},{code:"O6",name:"Avianca Brazil"},{code:"O4",name:"Antrak Air"},{code:"O2",name:"Oceanic Airlines"},{code:"NZ",name:"Air New Zealand"},{code:"NZ",name:"Eagle Airways"},{code:"NY",name:"Air Iceland"},{code:"NX",name:"Air Macau"},{code:"NW",name:"Northwest Airlines"},{code:"NV",name:"Air Central"},{code:"NU",name:"Japan Transocean Air"},{code:"NT",name:"Binter Canarias"},{code:"NR",name:"Pamir Airways"},{code:"NQ",name:"Air Japan"},{code:"NO",name:"Aus-Air"},{code:"NO",name:"Neos"},{code:"NN",name:"VIM Airlines"},{code:"NM",name:"Air Madrid"},{code:"NM",name:"Mount Cook Airlines"},{code:"NL",name:"Shaheen Air International"},{code:"NK",name:"Spirit Airlines"},{code:"NI",name:"LANICA"},{code:"NI",name:"Portugalia"},{code:"NH",name:"All Nippon Airways"},{code:"NG",name:"Lauda Air"},{code:"NF",name:"Air Vanuatu"},{code:"NE",name:"SkyEurope"},{code:"NC",name:"National Jet Systems"},{code:"NC",name:"Northern Air Cargo"},{code:"NB",name:"Sterling Airlines"},{code:"NA",name:"National Airlines"},{code:"NA",name:"North American Airlines"},{code:"N9",name:"North Coast Aviation"},{code:"N8",name:"Fika Salaama Airlines"},{code:"N8",name:"National Air Cargo dba National Airlines"},{code:"N7",name:"National Airlines"},{code:"N6",name:"Lagun Air"},{code:"N6",name:"Nuevo Continente"},{code:"N5",name:"Kyrgyz Airlines"},{code:"N5",name:"Norfolk Air"},{code:"N5",name:"Skagway Air Service"},{code:"N4",name:"Mountain Air Company"},{code:"N4",name:"National Airlines"},{code:"N4",name:"Nordwind Airlines"},{code:"N3",name:"Omskavia Airline"},{code:"N2",name:"Dagestan Airlines"},{code:"N2",name:"Kabo Air"},{code:"MZ",name:"Merpati Nusantara Airlines"},{code:"MY",name:"Maxjet Airways"},{code:"MY",name:"Midwest Airlines (Egypt)"},{code:"MX",name:"Mexicana de Aviacin"},{code:"MW",name:"Maya Island Air"},{code:"MW",name:"Mokulele Airlines"},{code:"MV",name:"Armenian International Airways"},{code:"MU",name:"China Eastern Airlines"},{code:"MT",name:"JMC Airlines"},{code:"MT",name:"Thomas Cook Airlines"},{code:"MS",name:"Egyptair"},{code:"MR",name:"Air Mauritanie"},{code:"MQ",name:"American Eagle Airlines"},{code:"MP",name:"Martinair"},{code:"MO",name:"Abu Dhabi Amiri Flight"},{code:"MO",name:"Calm Air"},{code:"MN",name:"Comair"},{code:"MM",name:"EuroAtlantic Airways"},{code:"MM",name:"SAM Colombia"},{code:"ML",name:"Air Mediterranee"},{code:"ML",name:"African Transport Trading and Investment Company"},{code:"ML",name:"Midway Airlines (19761991)"},{code:"MK",name:"Air Mauritius"},{code:"MJ",name:"Lneas Areas Privadas Argentinas"},{code:"MJ",name:"Mihin Lanka"},{code:"MI",name:"SilkAir"},{code:"MH",name:"MASwings"},{code:"MH",name:"Malaysia Airlines"},{code:"MG",name:"Champion Air"},{code:"MF",name:"Xiamen Airlines"},{code:"ME",name:"Middle East Airlines"},{code:"MD",name:"Air Madagascar"},{code:"MC",name:"Air Mobility Command"},{code:"MB",name:"Execair Aviation"},{code:"MB",name:"MNG Airlines"},{code:"MA",name:"Malv Hungarian Airlines"},{code:"M9",name:"Motor Sich"},{code:"M8",name:"Mekong Airlines"},{code:"M7",name:"MasAir"},{code:"M7",name:"Marsland Aviation"},{code:"M7",name:"Tropical Airways"},{code:"M6",name:"Amerijet International"},{code:"M5",name:"Kenmore Air"},{code:"M3",name:"ABSA Cargo"},{code:"M3",name:"Air Service"},{code:"M3",name:"North Flying"},{code:"M2",name:"Mahfooz Aviation"},{code:"LZ",name:"Balkan Bulgarian Airlines"},{code:"LY",name:"El Al Israel Airlines"},{code:"LX",name:"Swiss International Air Lines"},{code:"LX",name:"Swiss European Air Lines"},{code:"LW",name:"Pacific Wings"},{code:"LW",name:"Sun Air International"},{code:"LV",name:"Albanian Airlines"},{code:"LU",name:"LAN Express"},{code:"LT",name:"LTU International"},{code:"LS",name:"Jet2.com"},{code:"LR",name:"LACSA"},{code:"LQ",name:"Lebanese Air Transport"},{code:"LP",name:"LAN Peru"},{code:"LO",name:"LOT Polish Airlines"},{code:"LN",name:"Libyan Arab Airlines"},{code:"LM",name:"Livingston"},{code:"LL",name:"Allegro"},{code:"LK",name:"Air Luxor"},{code:"LJ",name:"Sierra National Airlines"},{code:"LI",name:"Leeward Islands Air Transport"},{code:"LH",name:"Lufthansa"},{code:"LH",name:"Lufthansa Cargo"},{code:"LG",name:"Luxair"},{code:"LF",name:"FlyNordic"},{code:"LD",name:"Air Hong Kong"},{code:"LC",name:"Loganair"},{code:"LC",name:"Varig Logstica"},{code:"LB",name:"Lloyd Areo Boliviano"},{code:"LA",name:"LAN Airlines"},{code:"L9",name:"Air Mali"},{code:"L9",name:"Bristow U.S. LLC"},{code:"L9",name:"Teamline Air"},{code:"L8",name:"Air Luxor GB"},{code:"L7",name:"Laoag International Airlines"},{code:"L7",name:"Lnea Area SAPSA"},{code:"L6",name:"Tbilaviamsheni"},{code:"L5",name:"Lnea Area Cuencana"},{code:"L5",name:"Lufttransport"},{code:"L4",name:"Lynx Aviation"},{code:"L3",name:"DHL de Guatemala"},{code:"L3",name:"LTU Austria"},{code:"L2",name:"Lynden Air Cargo"},{code:"L1",name:"Lufthansa Systems"},{code:"KZ",name:"Nippon Cargo Airlines"},{code:"KY",name:"Air So Tom and Prncipe"},{code:"KX",name:"Cayman Airways"},{code:"KW",name:"Kharkiv Airlines"},{code:"KW",name:"Wataniya Airways"},{code:"KV",name:"Kavminvodyavia"},{code:"KU",name:"Kuwait Airways"},{code:"KS",name:"Peninsula Airways"},{code:"KR",name:"Comores Airlines"},{code:"KQ",name:"Kenya Airways"},{code:"KP",name:"Kiwi International Air Lines"},{code:"KO",name:"Alaska Central Express"},{code:"KN",name:"China United Airlines"},{code:"KM",name:"Air Malta"},{code:"KL",name:"KLM"},{code:"KK",name:"Atlasjet"},{code:"KJ",name:"Asian Air"},{code:"KJ",name:"British Mediterranean Airways"},{code:"KI",name:"Air Atlantique"},{code:"KI",name:"Adam Air"},{code:"KH",name:"Aloha Air Cargo"},{code:"KG",name:"LAI - Lnea Area IAACA"},{code:"KF",name:"Blue1"},{code:"KE",name:"Korean Air"},{code:"KD",name:"Air Enterprise"},{code:"KD",name:"Kalstar Aviation"},{code:"KD",name:"KD Avia"},{code:"KC",name:"Air Astana"},{code:"KB",name:"Druk Air"},{code:"KA",name:"Dragonair"},{code:"K9",name:"Kalitta Charters"},{code:"K9",name:"Krylo Airlines"},{code:"K8",name:"Airlink Zambia"},{code:"K6",name:"Angkor Air"},{code:"K6",name:"Cambodia Angkor Air"},{code:"K6",name:"Khalifa Airways"},{code:"K5",name:"SeaPort Airlines"},{code:"K4",name:"Kalitta Air"},{code:"K2",name:"Eurolot"},{code:"JZ",name:"Avia Express"},{code:"JZ",name:"Skyways Express"},{code:"JY",name:"Air Turks and Caicos"},{code:"JY",name:"Air Turks and Caicos"},{code:"JX",name:"Jett8 Airlines Cargo"},{code:"JW",name:"Arrow Air"},{code:"JW",name:"Vanilla Air"},{code:"JV",name:"Bearskin Lake Air Service"},{code:"JU",name:"Air Serbia"},{code:"JU",name:"Jat Airways"},{code:"JT",name:"Lion Mentari Airlines"},{code:"JS",name:"Air Koryo"},{code:"JR",name:"Aero California"},{code:"JQ",name:"Jetstar Airways"},{code:"JP",name:"Adria Airways"},{code:"JO",name:"JALways"},{code:"JO",name:"Jettime"},{code:"JN",name:"Excel Airways"},{code:"JM",name:"Air Jamaica"},{code:"JM",name:"Jetstar Hong Kong Airways"},{code:"JL",name:"Japan Airlines"},{code:"JL",name:"Japan Airlines Domestic"},{code:"JK",name:"Spanair"},{code:"JJ",name:"Aviogenex"},{code:"JJ",name:"LATAM Brasil"},{code:"JI",name:"Jade Cargo International"},{code:"JI",name:"Midway Airlines (19932003)"},{code:"JH",name:"Nordeste Linhas Areas Regionais"},{code:"JF",name:"Jet Asia Airways"},{code:"JF",name:"L.A.B. Flying Service"},{code:"JE",name:"Mango"},{code:"JD",name:"Beijing Capital Airlines"},{code:"JC",name:"JAL Express"},{code:"JB",name:"Helijet"},{code:"JA",name:"B&H Airlines"},{code:"J9",name:"Guinee Airlines"},{code:"J9",name:"Jazeera Airways"},{code:"J8",name:"Berjaya Air"},{code:"J7",name:"Centre-Avia"},{code:"J7",name:"Denim Air"},{code:"J7",name:"ValuJet Airlines"},{code:"J6",name:"AVCOM"},{code:"J4",name:"Buffalo Airways"},{code:"J4",name:"Jordan International Air Cargo"},{code:"J3",name:"Northwestern Air"},{code:"J2",name:"Azerbaijan Airlines"},{code:"IZ",name:"Arkia Israel Airlines"},{code:"IY",name:"Yemenia"},{code:"IX",name:"Air India Express"},{code:"IW",name:"AOM French Airlines"},{code:"IW",name:"Wings Air"},{code:"IV",name:"Wind Jet"},{code:"IT",name:"Kingfisher Airlines"},{code:"IT",name:"Tigerair Taiwan"},{code:"IR",name:"Iran Air"},{code:"IQ",name:"Augsburg Airways"},{code:"IP",name:"Atyrau Air Ways"},{code:"IO",name:"Indonesian Airlines"},{code:"IN",name:"MAT Macedonian Airlines"},{code:"IN",name:"NAM Air"},{code:"IM",name:"Menajet"},{code:"IK",name:"Ikar"},{code:"IK",name:"Lankair"},{code:"IJ",name:"Great Wall Airlines"},{code:"IJ",name:"Spring Airlines Japan"},{code:"II",name:"IBC Airways"},{code:"IH",name:"Falcon Aviation"},{code:"IH",name:"Irtysh Air"},{code:"IG",name:"Meridiana"},{code:"IF",name:"Islas Airways"},{code:"IE",name:"Solomon Airlines"},{code:"ID",name:"Batik Air"},{code:"ID",name:"Interlink Airlines"},{code:"IC",name:"Indian Airlines"},{code:"IB",name:"Iberia Airlines"},{code:"IA",name:"Iraqi Airways"},{code:"I9*",name:"Air Italy"},{code:"I9",name:"Indigo"},{code:"I7",name:"Paramount Airways"},{code:"I6",name:"Sky Eyes"},{code:"I5",name:"AirAsia India"},{code:"I4",name:"Interstate Airlines"},{code:"I2",name:"Iberia Express"},{code:"HZ",name:"Sakhalinskie Aviatrassy(SAT)"},{code:"HZ",name:"Sat Airlines"},{code:"HY",name:"Uzbekistan Airways"},{code:"HX",name:"Hong Kong Airlines"},{code:"HW",name:"Hello"},{code:"HW",name:"North-Wright Airways"},{code:"HV",name:"Transavia Holland"},{code:"HU",name:"Hainan Airlines"},{code:"HT",name:"Aeromist-Kharkiv"},{code:"HR",name:"Hahn Air"},{code:"HQ",name:"Harmony Airways"},{code:"HQ",name:"Thomas Cook Airlines"},{code:"HP",name:"America West Airlines"},{code:"HP",name:"Hawaiian Pacific Airlines"},{code:"HP",name:"Pearl Airways"},{code:"HP",name:"Phoenix Airways"},{code:"HO",name:"Antinea Airlines"},{code:"HO",name:"Juneyao Airlines"},{code:"HN",name:"Heavylift Cargo Airlines"},{code:"HM",name:"Air Seychelles"},{code:"HK",name:"Four Star Aviation/Four Star Cargo"},{code:"HJ",name:"Asian Express Airlines"},{code:"HJ",name:"Hellas Jet"},{code:"HH",name:"Hope Air"},{code:"HG",name:"Niki"},{code:"HF",name:"Hapagfly"},{code:"HE",name:"Luftfahrtgesellschaft Walter"},{code:"HD",name:"Air Holland"},{code:"HD",name:"AIRDO"},{code:"HC",name:"Aero-Tropics Air Services"},{code:"HC",name:"Holidays Czech Airlines"},{code:"HC",name:"Iceland Express"},{code:"HB",name:"Harbor Airlines"},{code:"HA",name:"Hawaiian Airlines"},{code:"H9",name:"Air d'Ayiti"},{code:"H9",name:"Izair"},{code:"H8",name:"Dalavia"},{code:"H7",name:"Eagle Air"},{code:"H6",name:"Hageland Aviation Services"},{code:"H5",name:"Hola Airlines"},{code:"H5",name:"Mavial Magadan Airlines"},{code:"H4",name:"Hli Scurit Helicopter Airlines"},{code:"H4",name:"Inter Island Airways"},{code:"H2",name:"Sky Airline"},{code:"GZ",name:"Air Rarotonga"},{code:"GY",name:"Guyana Airways 2000"},{code:"GY",name:"Tri-MG Intra Asia Airlines"},{code:"GX",name:"Guangxi Beibu Gulf Airlines"},{code:"GX",name:"JetX Airlines"},{code:"GX",name:"Pacificair"},{code:"GW",name:"Kuban Airlines"},{code:"GW",name:"SkyGreece Airlines"},{code:"GV",name:"Aero Flight"},{code:"GT",name:"GB Airways"},{code:"GS",name:"Air Foyle"},{code:"GS",name:"Grant Aviation"},{code:"GR",name:"Aurigny Air Services"},{code:"GR",name:"Gemini Air Cargo"},{code:"GQ",name:"Big Sky Airlines"},{code:"GP",name:"Gestair"},{code:"GP",name:"Palau Trans Pacific Airlines"},{code:"GO",name:"Kuzu Airlines Cargo"},{code:"GN",name:"Air Gabon"},{code:"GM",name:"Air Slovakia"},{code:"GL",name:"Air Greenland"},{code:"GL",name:"Air Greenland"},{code:"GL",name:"Miami Air International"},{code:"GK",name:"Go One Airways"},{code:"GK",name:"JetStar Japan"},{code:"GJ",name:"Compania Mexicargo"},{code:"GJ",name:"CDI Cargo Airlines"},{code:"GJ",name:"Eurofly"},{code:"GI",name:"Itek Air"},{code:"GH",name:"Ghana Airways"},{code:"GG",name:"Air Guyane"},{code:"GG",name:"Air Comores International"},{code:"GG",name:"Cargo 360"},{code:"GF",name:"Gulf Air Bahrain"},{code:"GE",name:"TransAsia Airways"},{code:"GD",name:"Air Alpha Greenland"},{code:"GC",name:"Gambia International Airlines"},{code:"GB",name:"Airborne Express"},{code:"GB",name:"ABX Air"},{code:"GA",name:"Garuda Indonesia"},{code:"G9",name:"Air Arabia"},{code:"G8",name:"Air Service Gabon"},{code:"G8",name:"EnkorJSC"},{code:"G8",name:"GoAir"},{code:"G8",name:"Gujarat Airways"},{code:"G7",name:"Gandalf Airlines"},{code:"G7",name:"GoJet Airlines"},{code:"G6",name:"Guine Bissaur Airlines"},{code:"G6",name:"Air Volga"},{code:"G5",name:"China Express Airlines"},{code:"G4",name:"Allegiant Air"},{code:"G3",name:"City Connexion Airlines"},{code:"G3",name:"Gol Transportes Areos"},{code:"G2",name:"Avirex"},{code:"G1",name:"Gorkha Airlines"},{code:"G0",name:"Ghana International Airlines"},{code:"FZ",name:"Flydubai"},{code:"FY",name:"Firefly"},{code:"FY",name:"Northwest Regional Airlines"},{code:"FX",name:"Federal Express"},{code:"FW",name:"Ibex Airlines"},{code:"FV",name:"Pulkovo Aviation Enterprise"},{code:"FV",name:"Rossiya"},{code:"FT",name:"Siem Reap Airways"},{code:"FS",name:"Itali Airlines"},{code:"FS",name:"Servicios de Transportes Areos Fueguinos"},{code:"FR",name:"Ryanair"},{code:"FP",name:"Freedom Air"},{code:"FP",name:"Servicios Areos de los Andes"},{code:"FO",name:"Airlines of Tasmania"},{code:"FN",name:"Regional Air Lines"},{code:"FM",name:"Shanghai Airlines"},{code:"FL",name:"AirTran Airways"},{code:"FK",name:"Africa West"},{code:"FK",name:"Keewatin Air"},{code:"FJ",name:"Fiji Airways"},{code:"FI",name:"Icelandair"},{code:"FH",name:"Freebird Airlines"},{code:"FH",name:"Futura International Airways"},{code:"FG",name:"Ariana Afghan Airlines"},{code:"FF",name:"Airshop"},{code:"FE",name:"Primaris Airlines"},{code:"FD",name:"Royal Flying Doctor Service"},{code:"FD",name:"Thai AirAsia"},{code:"FC",name:"Finncomm Airlines"},{code:"FB",name:"Bulgaria Air"},{code:"FA",name:"Safair"},{code:"F9",name:"Frontier Airlines"},{code:"F7",name:"Flybaboo"},{code:"F6",name:"Faroejet"},{code:"F5",name:"Cosmic Air"},{code:"F4",name:"Albarka Air"},{code:"F3",name:"Faso Airways"},{code:"F2",name:"Fly Air"},{code:"EZ",name:"Evergreen International Airlines"},{code:"EZ",name:"Sun Air of Scandinavia"},{code:"EY",name:"Eagle Air"},{code:"EY",name:"Etihad Airways"},{code:"EX",name:"Atlantic Airlines"},{code:"EX",name:"Air Santo Domingo"},{code:"EW",name:"Eurowings"},{code:"EV",name:"Atlantic Southeast Airlines"},{code:"EV",name:"ExpressJet"},{code:"EU",name:"Empresa Ecuatoriana De Aviacin"},{code:"ET",name:"Ethiopian Airlines"},{code:"ES",name:"DHL International"},{code:"ER",name:"Astar Air Cargo"},{code:"EQ",name:"TAME"},{code:"EP",name:"Iran Aseman Airlines"},{code:"EO",name:"Express One International"},{code:"EO",name:"Hewa Bora Airways"},{code:"EN",name:"Air Dolomiti"},{code:"EM",name:"Aero Benin"},{code:"EM",name:"Empire Airlines"},{code:"EL",name:"Air Nippon"},{code:"EL",name:"Ellinair"},{code:"EK",name:"Emirates Airline"},{code:"EJ",name:"New England Airlines"},{code:"EI",name:"Aer Lingus"},{code:"EH",name:"Air Nippon Network Co. Ltd."},{code:"EH",name:"SAETA"},{code:"EG",name:"Japan Asia Airways"},{code:"EF",name:"Far Eastern Air Transport"},{code:"EE",name:"Aero Airlines"},{code:"ED",name:"Airblue"},{code:"EC",name:"Avialeasing Aviation Company"},{code:"EA",name:"Eastern Air Lines"},{code:"EA",name:"European Air Express"},{code:"E9",name:"Boston-Maine Airways"},{code:"E8",name:"Alpi Eagles"},{code:"E7",name:"Estafeta Carga Area"},{code:"E7",name:"European Aviation Air Charter"},{code:"E6",name:"Bringer Air Cargo Taxi Areo"},{code:"E5",name:"Samara Airlines"},{code:"E4",name:"Aero Asia International"},{code:"E3",name:"Domodedovo Airlines"},{code:"E2",name:"Kampuchea Airlines"},{code:"E2",name:"Rio Grande Air"},{code:"E1",name:"Everbread"},{code:"E0",name:"Eos Airlines"},{code:"DY",name:"Norwegian Air Shuttle"},{code:"DX",name:"DAT Danish Air Transport"},{code:"DW",name:"Aero-Charter Ukraine"},{code:"DV",name:"Lufttaxi Fluggesellschaft"},{code:"DV",name:"Nantucket Airlines"},{code:"DU",name:"Norwegian Long Haul"},{code:"DT",name:"TAAG Angola Airlines"},{code:"DS",name:"easyJet Switzerland"},{code:"DQ",name:"Coastal Air"},{code:"DP",name:"First Choice Airways"},{code:"DO",name:"Dominicana de Aviacin"},{code:"DM",name:"Maersk"},{code:"DL",name:"Delta Air Lines"},{code:"DK",name:"Eastland Air"},{code:"DJ",name:"Pacific Blue"},{code:"DJ",name:"Polynesian Blue"},{code:"DJ",name:"Virgin Australia"},{code:"DJ",name:"Virgin Blue Holdings"},{code:"DI",name:"Dba"},{code:"DH",name:"Discovery Airways"},{code:"DH",name:"Independence Air"},{code:"DG",name:"Tigerair Philippines"},{code:"DE",name:"Condor Flugdienst"},{code:"DD",name:"Nok Air"},{code:"DC",name:"Golden Air"},{code:"DB",name:"Brit Air"},{code:"DA",name:"Air Georgia"},{code:"D9",name:"Donavia"},{code:"D8",name:"Norwegian Air International"},{code:"D7",name:"AirAsia X"},{code:"D7",name:"FlyAsianXpress"},{code:"D6",name:"Interair South Africa"},{code:"D5",name:"Dauair"},{code:"D4",name:"Alidaunia"},{code:"D3",name:"Daallo Airlines"},{code:"D2",name:"Severstal Air Company"},{code:"CZ",name:"China Southern Airlines"},{code:"CY",name:"Cyprus Airways"},{code:"CX",name:"Cathay Pacific"},{code:"CW",name:"Air Marshall Islands"},{code:"CV",name:"Air Chathams"},{code:"CV",name:"Cargolux"},{code:"CU",name:"Cubana de Aviacin"},{code:"CT",name:"Civil Air Transport"},{code:"CS",name:"Continental Micronesia"},{code:"CR",name:"OAG"},{code:"CQ",name:"Central Charter"},{code:"CQ",name:"Sunshine Express Airlines"},{code:"CP",name:"Canadian Airlines"},{code:"CP",name:"Canadian Pacific Airlines"},{code:"CP",name:"Compass Airlines"},{code:"CO",name:"Continental Airlines"},{code:"CO",name:"Continental Express"},{code:"CN",name:"Islands Nationair"},{code:"CN",name:"Westward Airways"},{code:"CM",name:"Copa Airlines"},{code:"CL",name:"Lufthansa CityLine"},{code:"CK",name:"China Cargo Airlines"},{code:"CJ",name:"China Northern Airlines"},{code:"CJ",name:"CityFlyer Express"},{code:"CI",name:"China Airlines"},{code:"CH",name:"Bemidji Airlines"},{code:"CG",name:"Airlines PNG"},{code:"CF",name:"City Airline"},{code:"CE",name:"Nationwide Airlines"},{code:"CD",name:"Alliance Air"},{code:"CD",name:"Corendon Dutch Airlines"},{code:"CC",name:"Air Atlanta Icelandic"},{code:"CC",name:"Macair Airlines"},{code:"CB*",name:"Kalitta Charters II"},{code:"CA",name:"Air China"},{code:"C9",name:"Cirrus Airlines"},{code:"C8",name:"Cargolux Italia"},{code:"C8",name:"Chicago Express Airlines"},{code:"C7",name:"Cinnamon Air"},{code:"C7",name:"Rico Linhas Areas"},{code:"C6",name:"CanJet"},{code:"C5",name:"CommutAir"},{code:"C4",name:"Zimex Aviation"},{code:"C3",name:"Independent Carrier (ICAR)"},{code:"BZ",name:"Blue Dart Aviation"},{code:"BZ",name:"Keystone Air Service"},{code:"BY",name:"Thomson Airways"},{code:"BX",name:"Air Busan"},{code:"BX",name:"Coast Air"},{code:"BW",name:"Caribbean Airlines"},{code:"BV",name:"Blue Panorama Airlines"},{code:"BU",name:"Buryat Airlines Aircompany"},{code:"BT",name:"Air Baltic"},{code:"BS",name:"British International Helicopters"},{code:"BR",name:"EVA Air"},{code:"BQ",name:"Aeromar Lineas Aereas Dominicanas"},{code:"BQ",name:"Baltia Air Lines"},{code:"BP",name:"Air Botswana"},{code:"BO",name:"Bouraq Indonesia Airlines"},{code:"BN",name:"Braniff International Airways"},{code:"BN",name:"Forward Air International Airlines"},{code:"BN",name:"Horizon Airlines"},{code:"BM",name:"Air Sicilia"},{code:"BM",name:"BMI Regional"},{code:"BL",name:"Pacific Airlines"},{code:"BK",name:"Potomac Air"},{code:"BJ",name:"Nouvel Air Tunisie"},{code:"BI",name:"Royal Brunei Airlines"},{code:"BH",name:"Hawkair"},{code:"BG",name:"Biman Bangladesh Airlines"},{code:"BF",name:"Aero-Service"},{code:"BF",name:"Bluebird Cargo"},{code:"BE",name:"Flybe"},{code:"BD",name:"BMI"},{code:"BC",name:"Skymark Airlines"},{code:"BB",name:"Seaborne Airlines"},{code:"BA",name:"British Airways"},{code:"B9",name:"Air Bangladesh"},{code:"B8",name:"Eritrean Airlines"},{code:"B6",name:"JetBlue Airways"},{code:"B5",name:"Flightline"},{code:"B4",name:"BACH Flugbetriebsges"},{code:"B4",name:"Bankair"},{code:"B3",name:"Bellview Airlines"},{code:"B2",name:"BelaviaBelarusian Airlines"},{code:"AZ",name:"Alitalia"},{code:"AY",name:"Finnair"},{code:"AX",name:"AmericanConnection[5]"},{code:"AX",name:"Trans States Airlines"},{code:"AW",name:"Africa World Airlines"},{code:"AW",name:"CHC Airways"},{code:"AW",name:"Dirgantara Air Service"},{code:"AV",name:"Avianca - Aerovas del Continente Americano S.A."},{code:"AU",name:"Austral Lneas Areas"},{code:"AT",name:"Royal Air Maroc"},{code:"AS",name:"Alaska Airlines"},{code:"AR",name:"Aerolneas Argentinas"},{code:"AQ",name:"Aloha Airlines"},{code:"AQ",name:"MAP-Management and Planung"},{code:"AP",name:"Air One"
},{code:"AO",name:"Australian Airlines"},{code:"AN",name:"Ansett Australia"},{code:"AM",name:"Aeromxico"},{code:"AL",name:"Skywalk Airlines"},{code:"AL",name:"TransAVIAexport Airlines"},{code:"AK",name:"AirAsia"},{code:"AK",name:"Air Bridge Carriers"},{code:"AJ",name:"Aero Contractors"},{code:"AI",name:"Air IndiaLimited"},{code:"AH",name:"Air Algrie"},{code:"AF",name:"Air France"},{code:"AE",name:"Air Ceylon"},{code:"AE",name:"Mandarin Airlines"},{code:"AD",name:"Air Paradise International"},{code:"AD",name:"Azul Linhas Areas Brasileiras"},{code:"AC",name:"Air Canada"},{code:"AB",name:"Air Berlin"},{code:"AA",name:"American Airlines"},{code:"A9",name:"Georgian Airways"},{code:"A8",name:"Aerolink Uganda"},{code:"A8",name:"Benin Golf Air"},{code:"A7",name:"Air Plus Comet"},{code:"A6",name:"Air Alps Aviation"},{code:"A5",name:"Airlinair"},{code:"A5",name:"Hop!"},{code:"A4",name:"Southern Winds Airlines"},{code:"A3",name:"Aegean Airlines"},{code:"A2",name:"Astra Airlines"},{code:"A2",name:"Cielos Airlines"},{code:"9Y",name:"Fly Georgia"},{code:"9W",name:"Jet Airways"},{code:"9V",name:"Vipair Airlines"},{code:"9U",name:"Air Moldova"},{code:"9T",name:"Transwest Air"},{code:"9R",name:"Phuket Air"},{code:"9Q",name:"PB Air"},{code:"9O",name:"National Airways Cameroon"},{code:"9M",name:"Central Mountain Air"},{code:"9L",name:"Colgan Air"},{code:"9K",name:"Cape Air"},{code:"9I",name:"Helitrans"},{code:"9I",name:"Thai Sky Airlines"},{code:"9E",name:"Pinnacle Airlines"},{code:"9C",name:"Spring Airlines"},{code:"9A",name:"Eagle Express Air Charter"},{code:"8Z",name:"Wizz Air Bulgaria"},{code:"8Y",name:"Air Burundi"},{code:"8Y",name:"China Postal Airlines"},{code:"8W?",name:"BAX Global"},{code:"8W",name:"Private Wings Flugcharter"},{code:"8V",name:"Astral Aviation"},{code:"8V",name:"Wright Air Service"},{code:"8U",name:"Afriqiyah Airways"},{code:"8T",name:"Air Tindi"},{code:"8S",name:"Scorpio Aviation"},{code:"8Q",name:"Baker Aviation"},{code:"8Q",name:"Princess Air"},{code:"8P",name:"Pacific Coastal Airlines"},{code:"8O",name:"West Coast Air"},{code:"8N",name:"Barents AirLink"},{code:"8M",name:"Maxair"},{code:"8M",name:"Myanmar Airways International"},{code:"8L",name:"Cargo Plus Aviation"},{code:"8L",name:"Redhill Aviation"},{code:"8J",name:"Komiinteravia"},{code:"8I",name:"Myway Airlines"},{code:"8H",name:"Heli France"},{code:"8F",name:"Fischer Air"},{code:"8E",name:"Bering Air"},{code:"8D*",name:"Astair"},{code:"8D",name:"FitsAir"},{code:"8D",name:"Servant Air"},{code:"8C",name:"Air Transport International"},{code:"8C",name:"Air Horizon"},{code:"8C",name:"Shanxi Airlines"},{code:"8B",name:"Caribbean Star Airlines"},{code:"8A",name:"Atlas Blue"},{code:"7W",name:"Wayraper"},{code:"7T",name:"Air Glaciers"},{code:"7T",name:"Tobruk Air"},{code:"7S",name:"Ryan Air Service"},{code:"7R",name:"BRA-Transportes Areos"},{code:"7O[30]",name:"Travel Service"},{code:"7O",name:"Galaxy Air"},{code:"7N",name:"Centavia"},{code:"7N",name:"PAWA Dominicana"},{code:"7M",name:"Mistral Air"},{code:"7L",name:"Sun D'Or"},{code:"7K",name:"Kogalymavia Air Company"},{code:"7G",name:"Star Flyer"},{code:"7F",name:"First Air"},{code:"7E",name:"Sylt Air GmbH"},{code:"7C",name:"Coyne Aviation"},{code:"7C",name:"Jeju Air"},{code:"7B",name:"Krasnojarsky Airlines"},{code:"7A",name:"Express Air Cargo"},{code:"7A",name:"Aztec Worldwide Airlines"},{code:"7A",name:"Express Air Cargo"},{code:"6Z",name:"Ukrainian Cargo Airways"},{code:"6Y",name:"Smartlynx Airlines"},{code:"6W",name:"Saratov Airlines Joint Stock Company"},{code:"6V",name:"Air Vegas"},{code:"6V",name:"Axis Airways"},{code:"6V",name:"Mars RK"},{code:"6U",name:"Air Cargo Germany"},{code:"6U",name:"Air Ukraine"},{code:"6R",name:"Alrosa Air Company"},{code:"6Q",name:"Slovak Airlines"},{code:"6P",name:"Club Air"},{code:"6N",name:"Nordic Regional"},{code:"6K",name:"Asian Spirit"},{code:"6J",name:"Jubba Airways"},{code:"6J",name:"Skynet Asia Airways"},{code:"6I",name:"International Business Air"},{code:"6H",name:"Israir"},{code:"6G",name:"Air Wales"},{code:"6E",name:"IndiGo Airlines"},{code:"6B",name:"TUIfly Nordic"},{code:"6A",name:"Aviacsa"},{code:"5Z",name:"Airfreight Express"},{code:"5Z",name:"Bismillah Airlines"},{code:"5Z",name:"VivaColombia"},{code:"5Y",name:"Atlas Air"},{code:"5X",name:"United Parcel Service"},{code:"5W",name:"Astraeus"},{code:"5V",name:"Lviv Airlines"},{code:"5T",name:"Canadian North"},{code:"5O",name:"Europe Airpost"},{code:"5N",name:"Nordavia"},{code:"5M",name:"Montserrat Airways"},{code:"5M",name:"Sibaviatrans"},{code:"5L",name:"AeroSur"},{code:"5K",name:"Hi Fly"},{code:"5J",name:"Cebu Pacific"},{code:"5G",name:"Skyservice Airlines"},{code:"5F",name:"Arctic Circle Air Service"},{code:"5F",name:"Fly One"},{code:"5D",name:"Aerolitoral"},{code:"5D",name:"DonbassAero"},{code:"5C",name:"CAL Cargo Air Lines"},{code:"5A",name:"Alpine Air Express"},{code:"4Y",name:"Airbus Industrie"},{code:"4Y",name:"Airbus Transport International"},{code:"4Y",name:"Airbus France"},{code:"4Y",name:"Yute Air Alaska"},{code:"4U",name:"Germanwings"},{code:"4T",name:"Belair Airlines"},{code:"4S",name:"Finalair Congo"},{code:"4R",name:"Hamburg International"},{code:"4O",name:"Interjet"},{code:"4N",name:"Air North Charter- Canada"},{code:"4M",name:"Aero 2000"},{code:"4K",name:"Askari Aviation"},{code:"4H",name:"United Airways"},{code:"4G",name:"Gazpromavia"},{code:"4F",name:"Air City"},{code:"4D",name:"Air Sinai"},{code:"4C",name:"Aires"},{code:"4A",name:"Air Kiribati"},{code:"3X",name:"Japan Air Commuter"},{code:"3W",name:"Wan Air"},{code:"3V",name:"TNT Airways"},{code:"3U",name:"Sichuan Airlines"},{code:"3T",name:"Turan Air"},{code:"3S",name:"Aerologic"},{code:"3R",name:"Moskovia Airlines"},{code:"3Q",name:"China Yunnan Airlines"},{code:"3P",name:"Tiara Air"},{code:"3O",name:"Air Arabia Maroc"},{code:"3N",name:"Air Urga"},{code:"3L",name:"Intersky"},{code:"3K",name:"Jetstar Asia Airways"},{code:"3J",name:"Air Alliance"},{code:"3J",name:"Zip"},{code:"3G",name:"Atlant-Soyuz Airlines"},{code:"3C",name:"Calima Aviacin"},{code:"3C",name:"RegionsAir"},{code:"3B",name:"Central Connect Airlines"},{code:"2Z",name:"Chang An Airlines"},{code:"2W",name:"Welcome Air"},{code:"2U",name:"Air Guinee Express"},{code:"2T",name:"Haiti Ambassador Airlines"},{code:"2S",name:"Island Express"},{code:"2S",name:"Star Equatorial Airlines"},{code:"2S",name:"Satgur Air Transport"},{code:"2R",name:"Via Rail Canada"},{code:"2Q",name:"Air Cargo Carriers"},{code:"2P",name:"Air Philippines"},{code:"2O",name:"Air Salone"},{code:"2N",name:"NextJet"},{code:"2N",name:"Yuzhmashavia"},{code:"2M",name:"Moldavian Airlines"},{code:"2L",name:"Helvetic Airways"},{code:"2K",name:"Aerogal"},{code:"2J",name:"Air Burkina"},{code:"2H",name:"Thalys"},{code:"2G",name:"San Juan Airlines"},{code:"2G",name:"Cargoitalia"},{code:"2F",name:"Frontier Flying Service"},{code:"2D",name:"Aero VIP"},{code:"2C",name:"SNCF"},{code:"2B",name:"Aerocondor"},{code:"2A",name:"Deutsche Bahn"},{code:"1Z",name:"Sabre Pacific"},{code:"1Y",name:"Electronic Data Systems"},{code:"1U",name:"ITA Software"},{code:"1U",name:"Polyot Sirena"},{code:"1T",name:"1Time Airline"},{code:"1T",name:"Bulgarian Air Charter"},{code:"1S",name:"Sabre"},{code:"1R",name:"Hainan Phoenix Information Systems"},{code:"1Q",name:"Sirena"},{code:"1P",name:"Worldspan"},{code:"1N",name:"Navitaire"},{code:"1M",name:"JSC Transport Automated Information Systems"},{code:"1L",name:"Open Skies Consultative Commission"},{code:"1K",name:"Southern Cross Distribution"},{code:"1K",name:"Sutra"},{code:"1I",name:"Deutsche Rettungsflugwacht"},{code:"1I",name:"NetJets"},{code:"1I",name:"Novair"},{code:"1I",name:"Pegasus Hava Tasimaciligi"},{code:"1I",name:"Sierra Nevada Airlines"},{code:"1I",name:"Sky Trek International Airlines"},{code:"1H",name:"Siren-Travel"},{code:"1G",name:"Galileo International"},{code:"1F",name:"INFINI Travel Information"},{code:"1E",name:"Travelsky Technology"},{code:"1D",name:"Radixx Solutions International"},{code:"1C",name:"Electronic Data Systems"},{code:"1B",name:"Abacus International"},{code:"1A",name:"Amadeus Global Travel Distribution"},{code:"0V",name:"Vietnam Air Services Company(VASCO)"},{code:"0J",name:"Jetclub"},{code:"0D",name:"Darwin Airline"},{code:"0C",name:"IBL Aviation"},{code:"0B",name:"Blue Air"},{code:"0A",name:"Amber Air"}],t}();t.AirlineCodes=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t,e){this.$cont=t,this.filter=e}return e.prototype.showResults=function(e,a){this.queries=e;var r=this.filter.getStateBase(),s=t.FlightsExtractor.getResults(this.queries);if(a===t.LocationGrouping.ByCity){var c=new t.AnytimeByCityAgg(this.queries),l=this.filter.getStateBase();c.exe(l.starsLevel);var h=new i(s,r.currentLevel);h.render(c.cities)}if(a===t.LocationGrouping.ByCountry){var d=new t.AnytimeByCountryAgg(this.queries),u=this.filter.getStateBase();d.exe(u.starsLevel);var m=new n(s,r.currentLevel);m.render(d.countries,$("#resultsCont"))}if(a===t.LocationGrouping.ByContinent){var p=new t.AnytimeByContinentAgg(this.queries),f=this.filter.getStateBase();p.exe(f.starsLevel);var g=new o(s,r.currentLevel);g.render(p.getAllConts())}},e}();t.AnytimeDisplayer=e;var i=function(){function e(t,e){this.$cont=$("#resultsCont"),this.results=t,this.scoreLevel=e}return e.prototype.render=function(t){var e=this;t=_.sortBy(t,"fromPrice");var i=Common.ListGenerator.init(this.$cont,"resultGroupItem-template");i.clearCont=!0,i.customMapping=function(t){return{gid:t.gid,title:t.name,price:t.fromPrice}},i.onItemAppended=function(t,i){e.genOffers(t,i.bestFlights)},i.generateList(t)},e.prototype.genOffers=function(e,i){var n=this,o=Common.ListGenerator.init(e.find("table"),"resultGroup-priceItem-template");o.listLimit=2,o.listLimitMoreTmp="offers-expander-template",o.listLimitLessTmp="offers-collapser-template",o.evnt("td",function(i,o,a,r){var s=o.data("f"),c=o.data("t"),l=e.data("gid"),h=e.data("name"),d=Common.LastItem.getLast(n.$cont,"flight-result",e.data("no")),u=_.find(n.results,function(t){return t.from===s&&t.to===c}),m=t.FlightConvert2.cFlights(u.fs),p="Deals for "+h,f=[{from:s,to:c}],g=new t.CityDetail(n.scoreLevel,f,p,h,l);g.createLayout(d),g.init(m)}),o.generateList(i)},e}();t.AnytimeByCityDis=i;var n=function(){function e(t,e){this.results=t,this.scoreLevel=e}return e.prototype.render=function(t,e){var i=this;this.$cont=e,t=_.sortBy(t,"fromPrice");var n=Common.ListGenerator.init(this.$cont,"resultGroupItemCountry-template");n.clearCont=!0,n.customMapping=function(t){return{cc:t.cc,title:t.name,price:t.fromPrice}},n.onItemAppended=function(t,e){i.genOffers(t,e.cities)},n.generateList(t)},e.prototype.genOffers=function(e,i){var n=this;i=_.sortBy(i,"fromPrice");var o=Common.ListGenerator.init(e.find("table"),"grouped-country-city-template");o.customMapping=function(t){return{gid:t.gid,name:t.name,price:t.fromPrice}},o.listLimit=2,o.listLimitMoreTmp="offers-expander-template",o.listLimitLessTmp="offers-collapser-template",o.evnt(null,function(i,o,a,r){var s=o.data("gid"),c=Common.LastItem.getLast(n.$cont,"flight-result",e.data("no")),l=_.filter(n.results,function(t){return t.gid===s}),h=_.first(l),d=h.name,u=[],m=[];l.forEach(function(e){m.push({from:e.from,to:e.to}),e.fs.forEach(function(e){var i=t.FlightConvert2.cFlight(e);u.push(i)})});var p="Deals for "+d,f=new t.CityDetail(n.scoreLevel,m,p,d,s);f.createLayout(c),f.init(u)}),o.generateList(i)},e}();t.AnytimeByCountryDis=n;var o=function(){function t(t,e){this.$cont=$("#resultsCont"),this.continents=[],this.results=t,this.scoreLevel=e}return t.prototype.render=function(t){var e=this;this.mapContObjs(t);var i=Common.ListGenerator.init(this.$cont,"continent-group-template");i.clearCont=!0,i.onItemAppended=function(t,i){e.genCountries(t,i.countries)},i.evnt(".visi",function(t,e,i,n){var o=Boolean(i.data("v")),a=o?"expand":"collapse";i.html(a),e.find(".cont").toggle(!o),i.data("v",!o)}),i.generateList(this.continents)},t.prototype.genCountries=function(t,e){var i=new n(this.results,this.scoreLevel);i.render(e,t.find(".cont"))},t.prototype.mapContObjs=function(t){t.europe.length>0&&this.addCont("Europe",t.europe),t.nAmerica.length>0&&this.addCont("North America",t.nAmerica),t.sAmerica.length>0&&this.addCont("South America",t.sAmerica),t.asia.length>0&&this.addCont("Asia",t.asia),t.australia.length>0&&this.addCont("Australia",t.australia),t.africa.length>0&&this.addCont("Africa",t.africa)},t.prototype.addCont=function(t,e){var i={name:t,countries:e};this.continents.push(i)},t}();t.AnytimeByContinentDis=o}(Planning||(Planning={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Planning;!function(t){!function(t){t[t.ByCity=0]="ByCity",t[t.ByCountry=1]="ByCountry",t[t.ByContinent=2]="ByContinent"}(t.LocationGrouping||(t.LocationGrouping={}));var e=t.LocationGrouping,i=function(){function i(t,e){this.$cont=t,this.filter=e}return i.prototype.showResults=function(i,n){this.queries=i;var r=this.filter.getState();if(n===e.ByCity){var s=new t.WeekendByCityAgg,c=s.exe(this.queries,r.days,r.starsLevel),l=new o(this.$cont,r.currentLevel);l.render(c)}if(n===e.ByCountry){var h=new t.WeekendByCountryAgg,d=h.exe(this.queries,r.days,r.starsLevel),u=new a(this.$cont,r.currentLevel);u.render(d)}},i}();t.WeekendDisplayer=i;var n=function(){function t(t,e){this.$cont=t,this.scoreLevel=e}return t.prototype.render=function(t){var e=this;this.$cont.empty();var i=_(t).chain().sortBy("week").sortBy("year").value(),n=Common.ListGenerator.init(this.$cont,"weekend-week-template");n.clearCont=!0,n.customMapping=function(t){var e=r.getWeekendRange(t.week);return{week:t.week,year:t.year,dateFrom:moment.utc(e.friday).format("ll"),dateTo:moment.utc(e.sunday).format("ll")}},n.onItemAppended=function(t,i){e.onItemAppended(t,i)},n.generateList(i)},t}();t.ByWeekDisplay=n;var o=function(e){function i(t,i){var n=this;e.call(this,t,i),this.onItemAppended=function(t,e){n.generateWeek(t,e)}}return __extends(i,e),i.prototype.generateWeek=function(t,e){var i=this,n=_.sortBy(e.cities,"fromPrice"),o=t.find(".cont"),a=Common.ListGenerator.init(o,"resultGroupItem-template");a.customMapping=function(t){return{gid:t.gid,title:t.name,price:t.fromPrice}},a.onItemAppended=function(t,e){i.generateCity(o,t,e)},a.generateList(n)},i.prototype.generateCity=function(e,i,n){var o=i.find(".items table"),a=Common.ListGenerator.init(o,"resultGroup-priceItem-template");a.listLimit=2,a.listLimitMoreTmp="offers-expander-template",a.listLimitLessTmp="offers-collapser-template",a.customMapping=function(t){return{from:t.fromAirport,to:t.toAirport,price:t.fromPrice,flights:t.flights}},a.evnt("td",function(o,a,r,s){var c=t.FlightConvert2.cFlights(s.flights),l=Common.LastItem.getLast(e,"flight-result",i.data("no")),h="Deals for "+n.name,d=[{from:c[0].from,to:c[0].to}],u=new t.WeekendDetail(d,h,n.gid);u.createLayout(l),u.init(c)}),a.generateList(n.flightsGroups)},i}(n);t.WeekendByCityDis=o;var a=function(e){function i(t,i){var n=this;e.call(this,t,i),this.onItemAppended=function(t,e){n.generateCountries(t,e)}}return __extends(i,e),i.prototype.generateCountries=function(t,e){var i=this,n=_.sortBy(e.countries,"fromPrice"),o=t.find(".cont"),a=Common.ListGenerator.init(o,"resultGroupItemCountry-template");a.customMapping=function(t){return{cc:t.countryCode,title:t.name,price:t.fromPrice}},a.onItemAppended=function(t,e){i.generateCountryCities(t,e,o)},a.generateList(n)},i.prototype.generateCountryCities=function(e,i,n){var o=this,a=Common.ListGenerator.init(e.find(".items table"),"grouped-country-city-template");a.listLimit=2,a.listLimitMoreTmp="offers-expander-template",a.listLimitLessTmp="offers-collapser-template",a.customMapping=function(t){var e=o.extractFlights(t.flightsGroups);return{gid:t.gid,name:t.name,price:t.fromPrice,flights:e}},a.evnt("td",function(i,a,r,s){var c=o.extractFlights(s.flightsGroups),l=t.FlightConvert2.cFlights(c),h=Common.LastItem.getLast(n,"flight-result",e.data("no")),d="Deals for "+name,u=[{from:l[0].from,to:l[0].to}],m=0,p=new t.WeekendDetail(u,d,m);p.createLayout(h),p.init(l)}),a.generateList(i.cities)},i.prototype.extractFlights=function(t){var e=_.map(t,function(t){return t.flights}),i=[];return e.forEach(function(t){i=i.concat(t)}),i},i}(n);t.ByCountryDisplay=a;var r=function(){function t(){}return t.getWeekendRange=function(t){var e=(new Date).getFullYear(),i=new Date(e,0),n=0,o=i.getDay();for(4>=o&&(n=1);t>n;)i=this.addDays(i,1),1===i.getDay()&&n++;var a=this.addDays(i,4),r=this.addDays(a,2);return{friday:a,sunday:r}},t.addDays=function(t,e){var i=new Date(t);return i.setDate(i.getDate()+e),i},t}();t.DateOps=r}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function t(){}return t.checkFilter=function(t,e){var i=this.matchesScore(t,e);return i},t.matchesScore=function(t,e){if(1===e)return!0;var i=this.getScoreStars(t.score);return 5===e&&_.contains([5,4],i)?!0:!(3!==e||!_.contains([5,4,3,2],i))},t.getScoreStars=function(t){var e=100*t;return e>=90?5:e>=80?4:e>=70?3:e>=60?2:1},t}();t.AnytimeAggUtils=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t){this.cities=[],this.queries=t}return e.prototype.exe=function(e){var i=this;t.FlightsExtractor.r(this.queries,function(n,o){var a=[];if(n.fs.forEach(function(i){var n=t.AnytimeAggUtils.checkFilter(i,e);n&&a.push(i)}),any(a)){var r=i.getOrCreateCity(n.gid,n.name,n.cc),s={from:n.from,to:n.to,price:_.min(_.map(a,function(t){return t.price}))};r.bestFlights.push(s),r.fromPrice?r.fromPrice>s.price&&(r.fromPrice=s.price):r.fromPrice=s.price}})},e.prototype.getOrCreateCity=function(t,e,i){var n=_.find(this.cities,function(e){return e.gid===t});return n||(n={gid:t,name:e,cc:i,fromPrice:null,bestFlights:[]},this.cities.push(n)),n},e}();t.AnytimeByCityAgg=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t){this.countries=[],this.queries=t}return e.prototype.exe=function(e){var i=this;t.FlightsExtractor.r(this.queries,function(n,o){var a=[];if(n.fs.forEach(function(i){var n=t.AnytimeAggUtils.checkFilter(i,e);n&&a.push(i)}),any(a)){var r=i.getCountry(n.cc,n.cc),s=i.getCity(r,n.gid,n.name),c=_.min(_.map(a,function(t){return t.price}));r.fromPrice?r.fromPrice>c&&(r.fromPrice=c):r.fromPrice=c,s.fromPrice?s.fromPrice>c&&(s.fromPrice=c):s.fromPrice=c}})},e.prototype.getCountry=function(t,e){var i=_.find(this.countries,function(e){return e.cc===t});return i||(i={cc:t,name:e,fromPrice:null,cities:[]},this.countries.push(i)),i},e.prototype.getCity=function(t,e,i){var n=_.find(t.cities,function(t){return t.gid===e});return n||(n={gid:e,name:i,fromPrice:null},t.cities.push(n)),n},e}();t.AnytimeByCountryAgg=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(t){this.europe=[],this.nAmerica=[],this.sAmerica=[],this.asia=[],this.africa=[],this.australia=[],this.cg=Common.CountriesGroup,this.queries=t}return e.prototype.getAllConts=function(){return{europe:this.europe,nAmerica:this.nAmerica,sAmerica:this.sAmerica,asia:this.asia,africa:this.africa,australia:this.australia}},e.prototype.exe=function(e){var i=this,n=new t.AnytimeByCountryAgg(this.queries);n.exe(e),n.countries.forEach(function(t){i.contains(t.cc,i.cg.europe)&&i.europe.push(t),i.contains(t.cc,i.cg.northAmerica)&&i.nAmerica.push(t),i.contains(t.cc,i.cg.southAmerica)&&i.sAmerica.push(t),i.contains(t.cc,i.cg.asia)&&i.asia.push(t),i.contains(t.cc,i.cg.africa)&&i.africa.push(t),i.contains(t.cc,i.cg.austraila)&&i.australia.push(t)})},e.prototype.contains=function(t,e){var i=_.contains(e,t);return i},e}();t.AnytimeByContinentAgg=e}(Planning||(Planning={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Planning;!function(t){var e=function(){function e(){}return e.prototype.fittingFlights=function(e,i,n){var o=this,a=[];return e.forEach(function(e){var r=o.fitsByDays(e,i),s=t.AnytimeAggUtils.checkFilter(e,n),c=r&&s;c&&a.push(e)}),a},e.prototype.fitsByDays=function(t,e){if(!e)return!0;var i=this.splitInboundOutboundFlight(t.parts,t.to),n=_.first(i.thereParts),o=_.last(i.backParts);if(!n||!o)return!1;var a=new Date(n.dep),r=new Date(o.arr),s=this.convDayNo(a.getDay()),c=this.convDayNo(r.getDay()),l=e.from===s,h=e.to===c,d=l&&h;return d},e.prototype.getLowestPrice=function(t){var e=_.map(t,function(t){return t.price});return _.min(e)},e.prototype.convDayNo=function(t){return 0===t?7:t},e.prototype.splitInboundOutboundFlight=function(t,e){var i=[],n=[],o=!1;return t.forEach(function(t){o?n.push(t):i.push(t),t.to===e&&(o=!0)}),{thereParts:i,backParts:n}},e}();t.WeekendAggBase=e;var i=function(e){function i(){e.apply(this,arguments),this.weekGroups=[]}return __extends(i,e),i.prototype.exe=function(e,i,n){var o=this;return t.FlightsExtractor.r(e,function(t,e){var a=o.fittingFlights(t.fs,i,n);if(any(a)){var r=o.getOrCreateWeekGroup(t.week,t.year),s=o.getOrCreateWeekGroupCity(r,t.gid,t.name),c=o.getLowestPrice(a),l={fromPrice:c,fromAirport:t.from,toAirport:t.to,flights:a};s.fromPrice?s.fromPrice>c&&(s.fromPrice=c):s.fromPrice=c,s.flightsGroups.push(l)}}),this.weekGroups},i.prototype.getOrCreateWeekGroup=function(t,e){var i=_.find(this.weekGroups,function(i){return i.week===t&&i.year===e});return i||(i={week:t,year:e,cities:[]},this.weekGroups.push(i)),i},i.prototype.getOrCreateWeekGroupCity=function(t,e,i){var n=_.find(t.cities,function(t){return t.gid===e});return n||(n={gid:e,name:i,fromPrice:null,flightsGroups:[]},t.cities.push(n)),n},i}(e);t.WeekendByCityAgg=i}(Planning||(Planning={}));var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Planning;!function(t){var e=function(e){function i(){e.apply(this,arguments),this.weekGroups=[]}return __extends(i,e),i.prototype.exe=function(e,i,n){var o=this;return t.FlightsExtractor.r(e,function(t,e){var a=o.fittingFlights(t.fs,i,n);if(any(a)){var r=o.getOrCreateWeekGroup(t.week,t.year),s=o.getOrCreateCountry(r,t.cc,t.cc),c=o.getOrCreateCity(t.gid,t.name,s),l=o.getLowestPrice(a),h={fromPrice:l,fromAirport:t.from,toAirport:t.to,flights:a};s.fromPrice?s.fromPrice>l&&(s.fromPrice=l):s.fromPrice=l,c.fromPrice?c.fromPrice>l&&(c.fromPrice=l):c.fromPrice=l,c.flightsGroups.push(h)}}),this.weekGroups},i.prototype.getOrCreateWeekGroup=function(t,e){var i=_.find(this.weekGroups,function(i){return i.week===t&&i.year===e});return i||(i={week:t,year:e,countries:[]},this.weekGroups.push(i)),i},i.prototype.getOrCreateCountry=function(t,e,i){var n=_.find(t.countries,function(t){return t.countryCode===e});return n||(n={countryCode:e,name:i,fromPrice:null,cities:[]},t.countries.push(n)),n},i.prototype.getOrCreateCity=function(t,e,i){var n=_.find(i.cities,function(e){return e.gid===t});return n||(n={gid:t,name:e,fromPrice:null,flightsGroups:[]},i.cities.push(n)),n},i}(t.WeekendAggBase);t.WeekendByCountryAgg=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.grouping=t.LocationGrouping.ByCity,this.$cont=$("#resultsCont"),this.$filter=$("#filterCont"),this.v=e}return e.prototype.setQueries=function(t){this.queries=t,this.onFilterChanged()},e.prototype.init=function(e){var i=this.v.registerTemplate("filtering-template");this.$filter.html(i()),this.initFilters(),this.displayer=new t.WeekendDisplayer(this.$cont,this.filtering),e()},e.prototype.onFilterChanged=function(){this.displayer.showResults(this.queries,this.grouping)},e.prototype.initFilters=function(){var e=this;this.filtering=new t.FilteringWeekend,this.filtering.onFilterChanged=function(){var t=e.filtering.getStateBase();e.grouping=t.grouping,e.onFilterChanged()},this.filtering.initW([t.LocationGrouping.ByCity,t.LocationGrouping.ByCountry],t.LocationGrouping.ByCity,!1)},e.prototype.getCustomId=function(){return null},e}();t.WeekendPageSetter=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.grouping=t.LocationGrouping.ByCity,this.$cont=$("#resultsCont"),this.$filter=$("#filterCont"),this.v=e}return e.prototype.setQueries=function(t){this.queries=t,this.onFilterChanged()},e.prototype.init=function(e){var i=this.v.registerTemplate("filtering-template");this.$filter.html(i()),this.initFilters(),this.displayer=new t.AnytimeDisplayer(this.$cont,this.filter),e()},e.prototype.onFilterChanged=function(){this.displayer.showResults(this.queries,this.grouping)},e.prototype.initFilters=function(){var e=this;this.filter=new t.FilteringAnytime,this.filter.onFilterChanged=function(){var t=e.filter.getStateBase();e.grouping=t.grouping,e.onFilterChanged()},this.filter.initA([t.LocationGrouping.ByCity,t.LocationGrouping.ByCountry,t.LocationGrouping.ByContinent],t.LocationGrouping.ByCity)},e.prototype.getCustomId=function(){return null},e}();t.AnytimePageSetter=e}(Planning||(Planning={}));var Planning;!function(t){var e=function(){function e(e){this.grouping=t.LocationGrouping.ByCity,this.$cont=$("#resultsCont"),this.$filter=$("#filterCont"),this.v=e}return e.prototype.setQueries=function(t){this.queries=t,this.onFilterChanged()},e.prototype.init=function(e){var i=this.v.registerTemplate("filtering-template");this.$filter.html(i()),this.initFilters(),this.displayer=new t.AnytimeDisplayer(this.$cont,this.filter),this.customForm=new t.CustomFrom(this.v),this.customForm.init(function(){e()})},e.prototype.getCustomId=function(){return this.customForm.searchId},e.prototype.onFilterChanged=function(){this.displayer.showResults(this.queries,this.grouping)},e.prototype.initFilters=function(){var e=this;this.filter=new t.FilteringAnytime,this.filter.onFilterChanged=function(){var t=e.filter.getStateBase();e.grouping=t.grouping,e.onFilterChanged()},this.filter.initA([t.LocationGrouping.ByCity,t.LocationGrouping.ByCountry,t.LocationGrouping.ByContinent],t.LocationGrouping.ByCity)},e}();t.CustomPageSetter=e}(Planning||(Planning={}));