@using System.Web.UI
@using Gloobster.Common
@using Gloobster.Entities.Trip
@using Gloobster.Portal.ViewModels
@using Microsoft.Data.Entity.Metadata.Internal
@using Newtonsoft.Json
@model ViewModelDashboard

@{
    ViewData["Title"] = "Dashboard";
    //Layout = "";
    ViewBag.BodyClass = "dashboard";
}

<link href="/lib/fullcalendar/dist/fullcalendar.css" rel="stylesheet">    


@if (GloobsterConfig.UseMiniScripts)
{
    <script src="/jsb/dashboard.js" type="text/javascript" data-notbuild="true"></script>
}
else
{
    <script src="/lib/fullcalendar/dist/fullcalendar.js" type="text/javascript"></script>
    <script src="/js/Dashboard/CalendarUtils.js" type="text/javascript"></script>
    <script src="/js/Views/DashboardView.js" type="text/javascript"></script>    
}




<div class="wrapper">

    <div id="menuCont" class="navi-cont"></div>

    <div class="topics">

    <div class="topic-block tb-friends hidden">
        <div class="title">Friend's feed</div>
        <div class="content">

            <div class="friends-item">

                <div class="f-tbl">
                    <div class="l">
                        <img src="images/n/temp/user1.jpg"/>
                    </div>
                    <div class="r">
                        <div class="name-cont">
                            <a href="#">John Newman</a>
                        </div>
                        <div class="txt">
                            Just created his public trip "Holidays in Norway"
                        </div>

                    </div>
                </div>

            </div>

            <div class="friends-item">

                <div class="f-tbl">
                    <div class="l">
                        <img src="images/n/temp/user2.jpg"/>
                    </div>
                    <div class="r">
                        <div class="name-cont">
                            <a href="#">Jenifer Crow</a>
                        </div>
                        <div class="txt">
                            Just met with John Keneddy over the Travel Buddy.
                        </div>

                    </div>
                </div>

            </div>

            <div class="friends-item">

                <div class="f-tbl">
                    <div class="l">
                        <img src="images/n/temp/user3.jpg"/>
                    </div>
                    <div class="r">
                        <div class="name-cont">
                            <a href="#">Radovan Krawitzki</a>
                        </div>
                        <div class="txt">
                            Just made a recommendation to a Karl Benz. "He is such a nice guy, here really showed me how does it work in the city"
                        </div>

                    </div>
                </div>

            </div>


        </div>
    </div>

    <div class="topic-block tb-portal hidden">            
        <div class="title">Portal feed</div>
        <div class="content">

                <div class="portal-item">                    
                    <h3><a href="#">How to travel South East Asia</a></h3>
                    <img src="images/n/temp/beach1.jpg" />
                    <p>Prague is one of the most beautiful historical cities in the world. Its large center, 866 hectares in size makes Prague unique history preservation. A medieval centre with narrow streets, cathedrals, towers and churches, one of the oldest and well preserved castle in Europe, the Vltava river with its swans and its magical bridges. This is Prague but not only this! Prague is a popular night-life destination, with thousands of bars, pubs and clubs.</p>
                </div>
                
                <div class="portal-item">
                    <h3><a href="#">Traveling budget over the Europe</a></h3>
                    <img src="images/n/temp/graph1.jpg" />
                    <p>A large part of the city, including the River Seine, is a UNESCO World Heritage Site.</p>
                </div>
                
                <div class="portal-item">
                    <h3><a href="#">TOP 10: beautiful cities</a></h3>
                    <img src="images/n/temp/city1.jpg" />
                    <p>Lisbon (in Portuguese: Lisboa) is the capital of Portugal. Like İstanbul, Rome and San Francisco, Lisbon is built on seven hills.</p>
                </div>

            </div>

        </div>


    <div class="topic-block tb-web hidden">       
        <div class="title">Web navigation</div>     
        <div class="content">

                <div class="web-item">
                    <div class="web-title">Your travel map</div>
                    <div class="web-cont">

                        <div class="your-map-all">
                            <a href="/travelmap">@Html.Partial("MapSvg")</a>
                        </div>



                    </div>
                </div>

            <div class="web-item">
                <div class="web-title">Your trips</div>
                <div class="web-cont">

                    <div class="your-trips-all">
                        
                        @*todo: invited trips*@

                        <div class="items">
                            
                            @foreach (TripEntity trip in Model.Trips.Take(5))
                            {
                                string imgLink = trip.HasSmallPicture ? $"/Trip/TripPictureSmall_xs/{trip.id}" : "/images/placeholder-70.png";

                                <div class="item">
                                    <a href="/trip/@trip.id"><img src="@imgLink" /> <span class="txt">@trip.Name</span></a>
                                </div>
                            }

                        </div>

                        <div class="srv-zone">
                            <a href="/travelplanner/grid" class="lbtn2 srv-btn">Go to Your trips</a>
                        </div>

                    </div>

                </div>
            </div>
            
            <div class="web-item">
                <div class="web-title">Friend's calendar</div>
                <div class="web-cont">

                    <div id="calendar" class="f-calendar"></div>
                    
                    <div class="srv-zone">
                        <a href="/home/calendar" class="lbtn2 srv-btn">Full calendar</a>
                    </div>

                </div>
            </div>

            

            </div>
        </div>


    </div>


</div>



<script>

    function onBodyLoad() {
        currentView = new Views.DashboardView();

        currentView.ccs = @Html.Raw(JsonConvert.SerializeObject(Model.CCs));

        currentView.init();
    }

</script>
