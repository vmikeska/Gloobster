@{
		ViewBag.BodyClass = "tripview";
		ViewBag.MenuGroup = "Trip";
}

@using System.Threading.Tasks
@using Gloobster.Portal.Controllers.Portal
@using Gloobster.Portal.ViewModels
@model Gloobster.Portal.ViewModels.ViewModelTripDetail

<script type="text/javascript" src="@Url.Content("~/js/Views/TripViewView.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Views/TripMenu.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/common/ShareButtons.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/Comments.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/Files.js")"></script>

<script type="text/javascript" src="@Url.Content("~/js/Trip/AcceptCombo.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/Planner.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/DialogManager.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/PlaceDialog.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/AirportCombo.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/TravelDialog.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/Utils.js")"></script>
<script type="text/javascript" src="@Url.Content("~/js/Trip/PlacesManager.js")"></script>

<style>
    .photoButton input {
        width: 0.1px;
        height: 0.1px;
        opacity: 0;
        overflow: hidden;
        position: absolute;
        z-index: -1;
    }

    .photoButton label {
        cursor: pointer;
    }

    .noFiles {
        word-spacing: 0;
    }
</style>

<section id="bckPhoto" class="adventure-background line margin padding">
	<div class="wrapper">
		<div class="table margin width100">
			<div class="cell middle">
				<h1 class="margin0">@Model.Name</h1>
			</div>
			<div class="cell middle tright">
				<strong>By</strong> @Model.OwnerDisplayName
				<span class="thumbnail disc60 middle mleft10">
					<img src="/PortalUser/ProfilePicture/@Model.OwnerId">
				</span>
			</div>
		</div>
		<p class="h4">@Model.Description</p>
		<h3>Day by Day Plan</h3>
		<div id="plannerCont1" class="daybyday table margin">
		</div>

	    <div class="adventure-buttons">

	        @*<a class="button accept" href="#"><span class="icon-visited middle mright5"></span> Accept invite</a>*@

	        

	        @if (Model.IsUserAdmin)
            {
                <a class="button share photoButton" href="#">
                    <input id="photoInput" type="file" />

                    <label for="photoInput">
                        Add title photo
                    </label>
                </a>

                <a data-tmp="menuPrivacy-template" class="button share tripMenuButton" href="#">Set privacy</a>
                <a data-tmp="menuShare-template" class="button share tripMenuButton" href="#">Share trip</a>
                <a data-tmp="participants-template" class="button share tripMenuButton" href="#">Participants</a>	            
	            <a class="button share" href="/Trip/Detail/@Model.TripId">Edit trip</a>
	        }

	        @if (!Model.IsOwner)
	        {
	            <div id="invitationState" class="dropdown" style="display: none;">
	                <span class="selected"></span>
	                <ul>
	                    <li data-value="0" style="display: none;"><span class="icon-visited middle mright5"></span> Invited</li>
	                    <li data-value="1"><span class="icon-visited middle mright5"></span> Accepted</li>
	                    <li data-value="2"><span class="icon-visited middle mright5"></span> Maybe</li>
	                    <li data-value="3"><span class="icon-visited middle mright5"></span> Refused</li>
	                </ul>
	                <input type="hidden">
	            </div>
	        }
	    </div>

	    <div class="menuItemContent" style="display: none;">
	        
	    </div>

	</div>
</section>

<style>
    
    .menuItemContent {
        position: absolute;
        top: -155px;
        right: 0;
        width: 980px;
        height: 150px;
        background: rgba(255, 255, 255, 0.9);
        border-bottom-left-radius: 4px;
        border-bottom-right-radius: 4px;
    }

     #bckPhoto {    
         @if (Model.Photo != null)
        {
            @Html.Raw($"background: transparent url('../../Trip/TripPicture/{Model.TripId}') center top no-repeat")
        }
        else
        {
            @Html.Raw("background: transparent url('../../images/samples/sample13.jpg') center top no-repeat")        
        }
     }
</style>

@Html.Partial("Comments")

@if (Model.IsOwner || Model.ThisUserInvited)
{
    @Html.Partial("Files")
}

@Html.Partial("Participants")

@if (Model.NotesPublic)
{
	<section class="wrapper margin3 color1">
		<strong>Notes:</strong>
		@Model.Notes
	</section>
}

@Html.Partial("Templates")
@Html.Partial("PlannerTemplates")

<script>
	

    function onBodyLoad() {			
        currentView = new Views.TripViewView();
        var urlParams = window.location.pathname.split("/");
        var id = urlParams[urlParams.length - 1];
						
        currentView.initialize(id);
    }

</script>
